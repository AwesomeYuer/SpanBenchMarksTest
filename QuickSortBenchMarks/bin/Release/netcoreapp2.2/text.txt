<div class="cnblogs_code">
<pre><span style="color: #000000;">function initGrid() {
        localGrid </span>= jQuery(<span style="color: #800000;">"</span><span style="color: #800000;">#tbList</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        localGrid.jqGrid({
            data: localData,
            datatype: </span><span style="color: #800000;">"</span><span style="color: #800000;">local</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            gridview: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            height: </span><span style="color: #800080;">300</span><span style="color: #000000;">,
            width: </span><span style="color: #800000;">'</span><span style="color: #800000;">90%</span><span style="color: #800000;">',</span><span style="color: #000000;">
            rowList: [</span><span style="color: #800080;">5</span>,<span style="color: #800080;">10</span><span style="color: #000000;">],
            colNames: innerColumns,
            autowidth: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            hoverrows: </span><span style="color: #0000ff;">false</span><span style="color: #000000;">,
            multiselect: </span><span style="color: #0000ff;">false</span><span style="color: #000000;">,
            colModel: [
             { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">Id</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">Id</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">100</span>, hidden: <span style="color: #0000ff;">true</span><span style="color: #000000;"> },
             { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">Status</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">Status</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">100</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">GroupName</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">GroupName</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">200</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">LetterNumber</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">LetterNumber</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">ApplyUnitName</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">ApplyUnitName</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">StayDays</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">StayDays</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">LeaderName</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">LeaderName</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> }
            
            ],
            emptyrecords: </span><span style="color: #800000;">"</span><span style="color: #800000;">没有任何数据</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            pager: </span><span style="color: #800000;">"</span><span style="color: #800000;">#pager</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            viewrecords: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            rownumbers: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            loadonce: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            grouping: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            rowNum:</span><span style="color: #800080;">5</span><span style="color: #000000;">,
            groupingView : {  
                groupField: [</span><span style="color: #800000;">'</span><span style="color: #800000;">Status</span><span style="color: #800000;">'</span><span style="color: #000000;">]
            },
            ondblClickRow: function (id) {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">editInfo(id);</span>
<span style="color: #000000;">            },
            caption: </span><span style="color: #800000;">"</span><span style="color: #800000;">团组信息</span><span style="color: #800000;">"</span><span style="color: #000000;">
            
        }).navGrid(</span><span style="color: #800000;">'</span><span style="color: #800000;">#pager</span><span style="color: #800000;">'</span>, { edit: <span style="color: #0000ff;">false</span>, add: <span style="color: #0000ff;">false</span>, del: <span style="color: #0000ff;">false</span>, searchtext: <span style="color: #800000;">"</span><span style="color: #800000;">搜索</span><span style="color: #800000;">"</span> }, {}, {}, {}, { search: <span style="color: #0000ff;">true</span>, sopt: [<span style="color: #800000;">'</span><span style="color: #800000;">cn</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">eq</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">ge</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">gt</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">le</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">lt</span><span style="color: #800000;">'</span><span style="color: #000000;">] });

    }</span></pre>
</div>
<p>&nbsp; 加载时只显示5条数据，&nbsp;就是通过 rowNum:5 这一属性实现的，当然此时你最好也将 rowList 的最少值设为 5&nbsp;&nbsp; 我这里是rowList :[5,10]</p>
### elasticsearch集群管理
#### 1 配置主节点和数据节点
设置节点只保存数据,不希望节点成为主节点,在elasticsearch.yml配置文件中添加如下属性
```
node.master: false
node.data: true
```
设置节点不保存数据,只做主节点,添加如下属性
```
node.master: true
node.data: false
```
请注意,如果不设置,node.master和node.data默认都为true

#### 2主节点选取的配置
防止脑裂情况,elasticsearch提供了discovery.zen.minimum_naster_nodes属性,该属性定义的是为了形成一个集群,有主节点资格并互相链接的节点的最小数目.

#### 3设置集群名
如果我们不在elasticsearch.yml文件设置cluster.name属性,elsaticsearc将使用默认值:ealsticsearch
因此建议你设置cluster.name属性为你想要的名字,如果你想在一个网络中运行多个集群,也必须设置cluster.name
否则,将导致不同集群的所有节点都连接在一起
  3.1配置多播
  多播是zen发现的默认方法,我们可以控制一下四个属性
  * discovery.zen.ping.multicast.group ：用于多播请求的群组地址，默认为
      224.2.2.4
  * discovery.zen.ping.multicast.port ：用于多播通信的端口号，默认为54328。
  * discovery.zen.ping.multicast.ttl ：多播请求被认为有效的时间，默认为3秒。
  *  discovery.zen.ping.multicast.address ：Elasticsearch应该绑定的地址。默认为
      null ，意味着Elasticsearch将尝试绑定到操作系统可见的所有网络接口。

要 禁 用 多 播 ， 应 在 elasticsearch.yml 文 件 中 添 加 discovery.zen.ping.multicast.
enabled 属性，并且把值设为 false 。

  3.2. 配置单播
  因为单播的工作方式，我们需要指定至少一个接收单播消息的主机。为此，在elasticsearch.yml
  文件中添加 discovery.zen.ping.unicast.hosts 属性。基本上，我们应该在 discovery.zen.
  ping.unicast.hosts 属性中指定所有形成集群的主机。指定所有主机不是必须的，只需要提
  供足够多的主机以保证最少有一个能工作。如果希望指定192.168.2.1、192.168.2.2和192.168.2.3
  主机，可以用下面的方法来设置上述属性：
  discovery.zen.ping.unicast.hosts: 192.168.2.1:9300, 192.168.2.2:9300,
  192.168.2.3:9300
  你也可以定义一个Elasticsearch可以使用的端口范围，例如，从9300到9399端口，指定以下
  命令行：
  discovery.zen.ping.unicast.hosts: 192.168.2.1:[9300-9399],
  192.168.2.2:[9300-9399], 192.168.2.3:[9300-9399]

  请注意，主机之间用逗号隔开，并指定了预计用于单播消息的端口。
  使用单播时，总是设置 discovery.zen.ping.multicast.enabled 为
  false 。

#### 4 节点的ping设置
  除了刚刚讨论的设置，还可以控制或改变默认的ping设置。ping是一个节点间发送的信号，
  用来检测它们是否还在运行以及可以响应。主节点会ping集群中的其他节点，其他节点也会ping
  主节点。可以设置下面的属性。
  * discovery.zen.fd.ping_interval ：该属性默认为1s（1秒钟），指定了节点互相ping
  的时间间隔。
  * discovery.zen.fd.ping_timeout ：该属性默认为30s（30秒钟），指定了节点发送ping
  信息后等待响应的时间，超过此时间则认为对方节点无响应。
  * discovery.zen.fd.ping_retries ：该属性默认为3，指定了重试次数，超过此次数
  则认为对方节点已停止工作。

  如果你遇到网络问题，或者知道你的节点需要更多的时间来等待ping响应，可以把上面那些
  参数调整为对你的部署有利的值。
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">partial</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Form1 : Form
{
    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Form1()
    {
        InitializeComponent();
        menuStrip1.Renderer </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> MenuItemRenderer();
    }

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span> item1ToolStripMenuItem_Click(<span style="color: #0000ff;">object</span><span style="color: #000000;"> sender, EventArgs e)
    {
        MessageBox.Show(</span><span style="color: #800000;">"</span><span style="color: #800000;">click item1</span><span style="color: #800000;">"</span><span style="color: #000000;">);
    }
}

</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> MenuBarColor : ProfessionalColorTable
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> menu background</span>
    Color ManuBarCommonColor =<span style="color: #000000;"> Color.Brown;
    Color SelectedHighlightColor </span>=<span style="color: #000000;"> Color.BurlyWood;
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> all items border</span>
    Color MenuBorderColor =<span style="color: #000000;"> Color.Chartreuse;
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> menu bo</span>
    Color MenuItemBorderColor =<span style="color: #000000;"> Color.Coral;
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span> 
    <span style="color: #808080;">///</span><span style="color: #008000;"> Initialize a new instance of the Visual Studio MenuBarColor class. 
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span> 
    <span style="color: #0000ff;">public</span><span style="color: #000000;"> MenuBarColor()
    {
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color MenuItemPressedGradientBegin
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ManuBarCommonColor;
        }
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color MenuItemPressedGradientEnd
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ManuBarCommonColor;
        }
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color MenuItemPressedGradientMiddle
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ManuBarCommonColor;
        }
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color ButtonSelectedHighlight
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ManuBarCommonColor;
        }
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color MenuItemSelectedGradientBegin
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ManuBarCommonColor;
        }
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color MenuItemSelectedGradientEnd
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> ManuBarCommonColor;
        }
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color MenuBorder
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> MenuBorderColor;
        }
    }
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">override</span><span style="color: #000000;"> Color MenuItemBorder
    {
        </span><span style="color: #0000ff;">get</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> MenuItemBorderColor;
        }
    }
}

</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> MenuItemRenderer : ToolStripProfessionalRenderer
{
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> text</span>
    Font textFont = <span style="color: #0000ff;">new</span> System.Drawing.Font(<span style="color: #800000;">"</span><span style="color: #800000;">Arial</span><span style="color: #800000;">"</span>, 9F, System.Drawing.FontStyle.Regular, System.Drawing.GraphicsUnit.Point, ((<span style="color: #0000ff;">byte</span>)(<span style="color: #800080;">0</span><span style="color: #000000;">)));
    </span><span style="color: #0000ff;">private</span> Color menuItemSelectedColor =<span style="color: #000000;"> Color.Gray;
    </span><span style="color: #0000ff;">private</span> Color menuItemBorderColor =<span style="color: #000000;"> Color.Black;
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span> 
    <span style="color: #808080;">///</span><span style="color: #008000;"> Initialize a new instance of the Visual Studio MenuBarRenderer class. 
    </span><span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span> 
    <span style="color: #0000ff;">public</span> MenuItemRenderer() : <span style="color: #0000ff;">base</span>(<span style="color: #0000ff;">new</span><span style="color: #000000;"> MenuBarColor())
    {
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> item background</span>
        <span style="color: #0000ff;">this</span>.menuItemSelectedColor =<span style="color: #000000;"> Color.Red;
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> item border</span>
        <span style="color: #0000ff;">this</span>.menuItemBorderColor =<span style="color: #000000;"> Color.Blue;
    }
    </span><span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> OnRenderItemText(ToolStripItemTextRenderEventArgs e)
    {
        e.TextFont </span>=<span style="color: #000000;"> textFont;
        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (e.Item.IsOnDropDown)
        {
            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (e.Item.Selected)
            {
                e.TextColor </span>=<span style="color: #000000;"> Color.White;
            }
            </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
            {
                e.TextColor </span>=<span style="color: #000000;"> Color.Black;
            }
        }
        </span><span style="color: #0000ff;">base</span><span style="color: #000000;">.OnRenderItemText(e);
    }
    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Backgrounds</span>
    <span style="color: #0000ff;">protected</span> <span style="color: #0000ff;">override</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> OnRenderMenuItemBackground(ToolStripItemRenderEventArgs e)
    {
        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (e.Item.IsOnDropDown)
        {
            </span><span style="color: #0000ff;">if</span> (e.Item.Selected == <span style="color: #0000ff;">true</span> &amp;&amp;<span style="color: #000000;"> e.Item.Enabled)
            {
                DrawMenuDropDownItemHighlight(e);
            }
        }
        </span><span style="color: #0000ff;">else</span><span style="color: #000000;">
        {
            </span><span style="color: #0000ff;">base</span><span style="color: #000000;">.OnRenderMenuItemBackground(e);
        }
    }

    </span><span style="color: #008000;">//</span><span style="color: #008000;"> DrawMenuDropDownItemHighlight</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> DrawMenuDropDownItemHighlight(ToolStripItemRenderEventArgs e)
    {
        Rectangle rect </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> Rectangle();
        rect </span>= <span style="color: #0000ff;">new</span> Rectangle(<span style="color: #800080;">2</span>, <span style="color: #800080;">0</span>, (<span style="color: #0000ff;">int</span>)e.Graphics.VisibleClipBounds.Width - <span style="color: #800080;">4</span>, (<span style="color: #0000ff;">int</span>)e.Graphics.VisibleClipBounds.Height - <span style="color: #800080;">1</span><span style="color: #000000;">);
        </span><span style="color: #0000ff;">using</span> (SolidBrush brush = <span style="color: #0000ff;">new</span><span style="color: #000000;"> SolidBrush(menuItemSelectedColor))
        {
            e.Graphics.FillRectangle(brush, rect);
        }
        </span><span style="color: #0000ff;">using</span> (Pen pen = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Pen(menuItemBorderColor))
        {
            e.Graphics.DrawRectangle(pen, rect);
        }
    }
}</span></pre>
</div>
<p>&nbsp;</p>
<p>转自链接：<a href="https://www.cnblogs.com/xiadewang/p/7820377.htm" target="_blank">https://www.cnblogs.com/xiadewang/p/7820377.htm</a>l</p>
<p>1、首先下载Android studio安装包。</p>
<p>可以从<a href="http://www.android-studio.org/%E4%B8%8B%E8%BD%BD%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%EF%BC%8C%E8%BF%99%E9%87%8C%E9%87%87%E7%94%A83.0%E7%89%88%E6%9C%AC%E8%BF%9B%E8%A1%8C%E6%BC%94%E7%A4%BA%EF%BC%8C%E5%AF%B9%E5%BA%94%E5%AE%89%E8%A3%85%E5%8C%85%E4%B8%BAandroid-studio-ide-171.4408382-windows.exe">http://www.android-studio.org/下载最新版本，这里采用3.0版本进行演示，对应安装包为android-studio-ide-171.4408382-windows.exe</a>，</p>
<p>安装包大小681 MB，安装包不带SDK</p>
<p>&nbsp;</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111231536841-252934706.png" alt="" width="624" height="525" /></p>
<p>2、下载好该安装包之后，点击进行安装，依次出现以下界面</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111231625950-2062278670.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111231657903-64000800.png" alt="" /></p>
<p>&nbsp;</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111231711919-54401756.png" alt="" />&nbsp;&nbsp;</p>
<p>在这里自己选择程序安装路径</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111231759856-1267892948.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111231811466-1742785898.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111231820528-1221556260.png" alt="" /></p>
<p>&nbsp;</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232042481-1330170635.png" alt="" /></p>
<p>这里Android studio程序安装完毕，但是还需要继续对其进行配置；勾选Start Android Studio，然后点击finish启动AS，出现下图</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232111919-672018704.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>选择第二项，然后点击ok，出现下面的启动界面</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232131684-65108139.png" alt="" /></p>
<p>在启动的时候会弹出下图</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232147950-1605880221.png" alt="" /></p>
<p>点击cancel，然后进入到了AS的安装向导界面</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232206841-1950207162.png" alt="" /></p>
<p>点击next进入UI界面主题选择界面，可以选择自己喜欢的风格，这里选择Darcula风格</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232225013-1508764848.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232243825-458379470.png" alt="" /></p>
<p>这里需要指定SDK的本地路径，如果之前电脑中已经存在SDK，可以指定该路径，后续就可以不用下载SDK；我这里演示本地没有安装过SDK的场景，这里暂时可以指定一个后续将保存SDK的路径；</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232301684-1120408845.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232324669-1402743307.png" alt="" /></p>
<p>点击Finish后，开始自动下载SDK（注意，此时需要保证电脑联网）</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232343122-133023002.png" alt="" width="615" height="461" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232401872-687804195.png" alt="" width="618" height="462" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>下载完成SDK后，点击Finish进入AS的欢迎界面</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232447575-43461062.png" alt="" /></p>
<p>3、配置AS第一次运行环境，并且能成功编译运行一个APP，以helloworld为例。</p>
<p>点击上图中的Start a new Android Studio project新建一个工程，进入下面的界面</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232509653-367356961.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232521481-194431519.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232529153-450261890.png" alt="" /></p>
<p>&nbsp;</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232539122-1426892596.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232546981-1498506635.png" alt="" /></p>
<p>到此，一个工程建立完成，第一次建立的工程会发现卡在下面的启动界面</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232602622-2106064754.png" alt="" /></p>
<p>第一次建立工程卡在该界面的时候，是因为在从网上下载gradle构建工具，由于从国外站点下载，网速很慢，这里点击取消关闭该界面，采用手动配置gradle；</p>
<p>首先找到.gradle文件夹的路径，一般是在用户账号文件夹下，比如我这里是C:\Users\issuser\.gradle</p>
<p>会发现该文件夹下生成了下图中的文件</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232640731-536724217.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>这里的gradle-4.1,指的是版本，它会根据你的AS版本自动生成，此时我们可以去网上下载一个gradle-4.1-all.zip压缩包，然后放到该路径下并且进行解压，注意一定要放到这个随机生成的一长串字符的文件夹下面，如下图</p>
<p>可参看以下链接下载zip文件：<a href="https://www.cnblogs.com/zjgwh/p/8147298.html" target="_blank">https://www.cnblogs.com/zjgwh/p/8147298.html</a></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232703638-1101875301.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232713294-1387011987.png" alt="" /></p>
<pre>此时点击图中下方的链接进行<span lang="EN-US">SDK下载，这里可能一次下载之后，执行<span lang="EN-US">Try again之后这里还是会显示报错，那么就再点击下载一次，然后再点击<span lang="EN-US">Try again，直到报错解除。（除了该解决办法，还可以手动更改<span lang="EN-US">build.gradle文件中的<span lang="EN-US">compileSdkVersion，<span lang="EN-US">buildToolsVersion</span></span></span></span></span></span></pre>
<pre><span lang="EN-US">targetSdkVersion为对应的<span lang="EN-US">27也可以进行解决，这个后续再讲）</span></span></pre>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232746841-673079056.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232752747-1097539050.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232805153-1234890467.png" alt="" /></p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232828091-429636493.png" alt="" /></p>
<p>上述gradle构建完成之后，就可以点击下图中的build apk编译打包apk文件了，生成的apk文件路径如下图所示</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232849622-1383854035.png" alt="" /></p>
<p>生成apk文件之后，导出该apk文件到模拟器或者真机上面进行安装，运行效果图如下</p>
<p><img src="https://images2017.cnblogs.com/blog/890216/201711/890216-20171111232909059-1462861577.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;至此，Android Studio的安装以及开发环境就配置好了。</p>
<p>您可能听说过，带有 yield 的函数在 Python 中被称之为 generator（生成器），何谓 generator ？</p>
<p>我们先抛开 generator，以一个常见的编程题目来展示 yield 的概念。</p>
<h2 id="major1" class="ibm-h2">如何生成斐波那契數列</h2>
<p>斐波那契（Fibonacci）數列是一个非常简单的递归数列，除第一个和第二个数外，任意一个数都可由前两个数相加得到。用计算机程序输出斐波那契數列的前 N 个数是一个非常简单的问题，许多初学者都可以轻易写出如下函数：</p>
<h5 id="listing1" class="ibm-h5">清单 1. 简单输出斐波那契數列前 N 个数</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">def fab(max): 
   n, a, b = 0, 0, 1 
   while n &lt; max: 
       print b 
       a, b = b, a + b 
       n = n + 1
</pre>
</div>
<p>执行 fab(5)，我们可以得到如下输出：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; fab(5) 
1 
1 
2 
3 
5
</pre>
</div>
<p>结果没有问题，但有经验的开发者会指出，直接在 fab 函数中用 print 打印数字会导致该函数可复用性较差，因为 fab 函数返回 None，其他函数无法获得该函数生成的数列。</p>
<p>要提高 fab 函数的可复用性，最好不要直接打印出数列，而是返回一个 List。以下是 fab 函数改写后的第二个版本：</p>
<h5 id="listing2" class="ibm-h5">清单 2. 输出斐波那契數列前 N 个数第二版</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">def fab(max): 
   n, a, b = 0, 0, 1 
   L = [] 
   while n &lt; max: 
       L.append(b) 
       a, b = b, a + b 
       n = n + 1 
   return L
</pre>
</div>
<p>可以使用如下方式打印出 fab 函数返回的 List：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; for n in fab(5): 
...     print n 
... 
1 
1 
2 
3 
5
</pre>
</div>
<p>改写后的 fab 函数通过返回 List 能满足复用性的要求，但是更有经验的开发者会指出，该函数在运行中占用的内存会随着参数 max 的增大而增大，如果要控制内存占用，最好不要用 List</p>
<p>来保存中间结果，而是通过 iterable 对象来迭代。例如，在 Python2.x 中，代码：</p>
<h5 id="listing3" class="ibm-h5">清单 3. 通过 iterable 对象来迭代</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">for i in range(1000): pass
</pre>
</div>
<p>会导致生成一个 1000 个元素的 List，而代码：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">for i in xrange(1000): pass
</pre>
</div>
<p>则不会生成一个 1000 个元素的 List，而是在每次迭代中返回下一个数值，内存空间占用很小。因为 xrange 不返回 List，而是返回一个 iterable 对象。</p>
<p>利用 iterable 我们可以把 fab 函数改写为一个支持 iterable 的 class，以下是第三个版本的 Fab：</p>
<h5 id="listing4" class="ibm-h5">清单 4. 第三个版本</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">class Fab(object): 
 
   def __init__(self, max): 
       self.max = max 
       self.n, self.a, self.b = 0, 0, 1 
 
   def __iter__(self): 
       return self 
 
   def next(self): 
       if self.n &lt; self.max: 
           r = self.b 
           self.a, self.b = self.b, self.a + self.b 
           self.n = self.n + 1 
           return r 
       raise StopIteration()
</pre>
</div>
<p>Fab 类通过 next() 不断返回数列的下一个数，内存占用始终为常数：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; for n in Fab(5): 
...     print n 
... 
1 
1 
2 
3 
5
</pre>
</div>
<p>然而，使用 class 改写的这个版本，代码远远没有第一版的 fab 函数来得简洁。如果我们想要保持第一版 fab 函数的简洁性，同时又要获得 iterable 的效果，yield 就派上用场了：</p>
<h5 id="listing5" class="ibm-h5">清单 5. 使用 yield 的第四版</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">def fab(max): 
    n, a, b = 0, 0, 1 
    while n &lt; max: 
        yield b 
        # print b 
        a, b = b, a + b 
        n = n + 1 
 
'''
</pre>
</div>
<p>第四个版本的 fab 和第一版相比，仅仅把 print b 改为了 yield b，就在保持简洁性的同时获得了 iterable 的效果。</p>
<p>调用第四版的 fab 和第二版的 fab 完全一致：</p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; for n in fab(5): 
...     print n 
... 
1 
1 
2 
3 
5
</pre>
</div>
<p>简单地讲，yield 的作用就是把一个函数变成一个 generator，带有 yield 的函数不再是一个普通函数，Python 解释器会将其视为一个 generator，调用 fab(5) 不会执行 fab 函数，而是返回一个 iterable 对象！在 for 循环执行时，每次循环都会执行 fab 函数内部的代码，执行到 yield b 时，fab 函数就返回一个迭代值，下次迭代时，代码从 yield b 的下一条语句继续执行，而函数的本地变量看起来和上次中断执行前是完全一样的，于是函数继续执行，直到再次遇到 yield。</p>
<p>也可以手动调用 fab(5) 的 next() 方法（因为 fab(5) 是一个 generator 对象，该对象具有 next() 方法），这样我们就可以更清楚地看到 fab 的执行流程：</p>
<h5 id="listing6" class="ibm-h5">清单 6. 执行流程</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; f = fab(5) 
&gt;&gt;&gt; f.next() 
1 
&gt;&gt;&gt; f.next() 
1 
&gt;&gt;&gt; f.next() 
2 
&gt;&gt;&gt; f.next() 
3 
&gt;&gt;&gt; f.next() 
5 
&gt;&gt;&gt; f.next() 
Traceback (most recent call last): 
 File "&lt;stdin&gt;", line 1, in &lt;module&gt; 
StopIteration
</pre>
</div>
<p>当函数执行结束时，generator 自动抛出 StopIteration 异常，表示迭代完成。在 for 循环里，无需处理 StopIteration 异常，循环会正常结束。</p>
<p>我们可以得出以下结论：</p>
<p>一个带有 yield 的函数就是一个 generator，它和普通函数不同，生成一个 generator 看起来像函数调用，但不会执行任何函数代码，直到对其调用 next()（在 for 循环中会自动调用 next()）才开始执行。虽然执行流程仍按函数的流程执行，但每执行到一个 yield 语句就会中断，并返回一个迭代值，下次执行时从 yield 的下一个语句继续执行。看起来就好像一个函数在正常执行的过程中被 yield 中断了数次，每次中断都会通过 yield 返回当前的迭代值。</p>
<p>yield 的好处是显而易见的，把一个函数改写为一个 generator 就获得了迭代能力，比起用类的实例保存状态来计算下一个 next() 的值，不仅代码简洁，而且执行流程异常清晰。</p>
<p>如何判断一个函数是否是一个特殊的 generator 函数？可以利用 isgeneratorfunction 判断：</p>
<h5 id="listing7" class="ibm-h5">清单 7. 使用 isgeneratorfunction 判断</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; from inspect import isgeneratorfunction 
&gt;&gt;&gt; isgeneratorfunction(fab) 
True
</pre>
</div>
<p>要注意区分 fab 和 fab(5)，fab 是一个 generator function，而 fab(5) 是调用 fab 返回的一个 generator，好比类的定义和类的实例的区别：</p>
<h5 id="listing8" class="ibm-h5">清单 8. 类的定义和类的实例</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; import types 
&gt;&gt;&gt; isinstance(fab, types.GeneratorType) 
False 
&gt;&gt;&gt; isinstance(fab(5), types.GeneratorType) 
True
</pre>
</div>
<p><strong>fab 是无法迭代的，而 fab(5) 是可迭代的：</strong></p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; from collections import Iterable 
&gt;&gt;&gt; isinstance(fab, Iterable) 
False 
&gt;&gt;&gt; isinstance(fab(5), Iterable) 
True
</pre>
</div>
<p><strong>每次调用 fab 函数都会生成一个新的 generator 实例，各实例互不影响：</strong></p>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">&gt;&gt;&gt; f1 = fab(3) 
&gt;&gt;&gt; f2 = fab(5) 
&gt;&gt;&gt; print 'f1:', f1.next() 
f1: 1 
&gt;&gt;&gt; print 'f2:', f2.next() 
f2: 1 
&gt;&gt;&gt; print 'f1:', f1.next() 
f1: 1 
&gt;&gt;&gt; print 'f2:', f2.next() 
f2: 1 
&gt;&gt;&gt; print 'f1:', f1.next() 
f1: 2 
&gt;&gt;&gt; print 'f2:', f2.next() 
f2: 2 
&gt;&gt;&gt; print 'f2:', f2.next() 
f2: 3 
&gt;&gt;&gt; print 'f2:', f2.next() 
f2: 5
</pre>
</div>
<h2 id="major2" class="ibm-h2">return 的作用</h2>
<p>在一个 generator function 中，如果没有 return，则默认执行至函数完毕，如果在执行过程中 return，则直接抛出 StopIteration 终止迭代。</p>
<h2 id="major3" class="ibm-h2">另一个例子</h2>
<p>另一个 yield 的例子来源于文件读取。如果直接对文件对象调用 read() 方法，会导致不可预测的内存占用。好的方法是利用固定长度的缓冲区来不断读取文件内容。通过 yield，我们不再需要编写读文件的迭代类，就可以轻松实现文件读取：</p>
<h5 id="listing9" class="ibm-h5">清单 9. 另一个 yield 的例子</h5>
<div class="cnblogs_Highlighter">
<pre class="brush:python;gutter:true;">def read_file(fpath): 
   BLOCK_SIZE = 1024 
   with open(fpath, 'rb') as f: 
       while True: 
           block = f.read(BLOCK_SIZE) 
           if block: 
               yield block 
           else: 
               return
</pre>
</div>
<p>以上仅仅简单介绍了 yield 的基本概念和用法，yield 在 Python 3 中还有更强大的用法，我们会在后续文章中讨论。</p>
<p>注：本文的代码均在 Python 2.7 中调试通过</p>
<p>以上内容来自&ldquo;IMB DeveloperWorkers&rdquo; 作者：廖雪峰</p>
<p>&nbsp;</p>
<p>　　</p>
<p><strong>跳跃表</strong>优点<br />相对于红黑树以及AVL树，实现相对简单<br />查找性能相对单一的链表来说性能比较高效，节点越多，性能越能凸显，平均是O（logN）<br />因为链表的插入性能主要消耗在查找上，所以查找性能高效的情况下，插入性能也比较高效<br />Redis的跳表，同节点的层次之间通过数组来实现，不是通过链表指针的方式来指向</p>
<p><strong>整数集合</strong><br />核心：减少内存使用</p>
<p>关于跳跃表<br />（1）跳跃表是一种有序数据结构，查询效率和平衡树媲美，实现上比平衡树简单，可以用跳跃表代替平衡树；查找复杂度平均是O(logN)z,最坏是O(N);<br />（2）跳跃表在redis里只有2个地方使用：一个是实现有序集合键（sorted set）、一个是集群节点中用作内部数据结构；也就是说，跳跃表是sorted set类型的底层实现之一；<br />（3）每个节点都有层高，层高越高，查找效率越高；存储节点的时候，随机生成1-32之间的随机数，假设生成的层高随机数为N，则，该节点数值在第一层~第N层都会被插入，<br />且每层的数据都是有序的，这样在查找该节点时从最高层依次查找，最高层查不到，接着查次高层；<br />（4）同节点的层次直接通过数组实现，不是通过链表<br />关于整数集合<br />整数集合（intset）就是将所有整数类型封装到intset这个结构体里，根据实际存储的数据长度来动态选择使用哪种数据类型；<br />1）整数类型有int16_t   int32_t   int64_t等；分别表示的整数范围<br />2）整数集合（intset）将所有整数类型封装的目的是：减少内存使用。可以根据存入的整数数值大小，动态选择用int16_t类型的还是int32_t类型的等<br />当设置一个集合后，会判断集合里元素的整数值大小，最大的元素是什么类型的整数，就会将intset设置为该类型；例如一个集合里最大的元素是50000，<br />那么这个集合的数据类型就是int32_t类型的，其他元素值也将被设置为int32_t类型；一个集合里最大的元素是30000，那么这个结婚的数据类型就是in16_t类型的；<br />例如：新增一个元素，该元素长度超过原来的类型范围，就需要类型升级，例如从int16_t升级到int32_t;</p>
<p><strong>关于对象</strong><br />（1）Redis里说的SDS字符串、链表、字典。压缩列表、整数集合等都是数据结构，redis并没有直接使用数据结构来实现键值对数据库，而是创建了<br />一个对象系统，这个系统包含字符串对象、列表对象、哈希对象、集合对象、有序集合对象这5种类型的对象；通过不同类型的对象来判断一个对象是否可以执行给定的命令。<br />（2）redis的对象系统还实现基于引用计数技术的内存回收机制：有个引用计数参数，通过识别这个参数判断对象是否被使用，没有被引用则是否该<br />对象的内存；此外，还实现了对象共享机制，一定条件下，可以多个数据库共享一个对象来节约内存；<br />（3）redis的5种数据类型，都是通过redisObject结构体来实现的，通过对该结构体的引用，根据实际使用生成5种数据类型的对象<br />（3.1）Type属性表示类型，type:4的意思是定义属性type，占4个比特，unsigned等同于unsigned int;<br />（3.2）Encoding属性也占4个比特位；lru属性占24个比特位；<br />也就是type属性、encoding属性、lru属性合在一起，占用32个比特，也就是4个字节；<br />（3.3）Refcount属性，是int类型，占4个字节；ptr属性也占用4个字节；<br />综上，redisObject结构体一共占用12个字节，也就是redisObject结构体，巧妙运用位字段，节省内存，同时相对直接操纵位来编程也更容易。<br />（3.4）Type属性对应的值有5种，也就是5种对象类型：REDIS_STRING/REDSI_LIST/REDIS_HASH/REDIS_SET/REDIS_ZSET<br />3.5）Encoding属性表示编码类型：5种对象类型，对应不同的编码类型，会有不同的底层实现；即，编码不同，底层支撑的数据结构不同；</p>
<p>Redis在减少内存开销方面做的设计：（1）整数集合；（2）定义redisObject一个结构体，来实现5种数据类型的引用，也即是5种对象；<br />redisObject结构体里，定义type属性区分5种数据类型，多种底层存储结构支撑；而且，redisObject结构体里的type属性、encoding<br />属性、lru属性是用位字段定义的，巧妙运用位字段，节省内存；</p>
<p><strong><span style="background-color: #339966;">总结</span></strong>概括五种对象的关键点<br />1 字符串对象<br />字符串对象有3种类型实现：int类型、raw类型、embstr类型；<br />Int,如果一个字符串对象保存的是整数值，并且这个整数值可以用long类型表示；<br />raw,如果保存的是字符串，且长度大于39字节；<br />embstr，如果保存的是字符串，且长度小于等于39字节；（embstr与raw一样，使用sds简单动态字符串结构；和redisObject结构一起分<br />片和回收，因此只需要分配或回收一次；embstr的内存回收更快，因为redisObject和sdshdr内存是连续的；）<br />RawL类型的字符串长度大于39字节，不利于连续内存的分配，因此Raw类型的内存分片不是连续的；<br />可以用object encoding命令来查看数据的底层存储结构；<br />2 列表对象<br />列表对象有2种类型实现：ziplist类型、linkedlist类型<br />--- ziplist类型的使用要满足如下2个条件：所有节点长度都小于64字节+元素个数小于512；<br />列表对象使用ziplist类型的2个条件，是默认在redis.conf配置文件里的<br />--- linkedlist类型：不能满足ziplist类型的条件的，都会采用linkedlist<br />Ziplist      VS  linkedlist<br />--- Linkedlist是链表，扩展性好；且不需要连续的内存空间，内存利用率高；但是查找性能相对差；<br />--- ziplist类似数组，有高效的访问，查找性能更高；但是因为ziplist需要连续内存空间，对内存的利用率较低<br />3 哈希对象<br />哈希对象有2种类型实现：ziplist类型、字典类型<br />--- ziplist类型：同事满足2个条件：所有节点长度都小于64字节 + 列表元素个数小于512  <br />（注意：键值对挨在一起，先添加的键值对会被放在表头方向，后添加的放在表尾方向）<br />哈希对象使用ziplist类型的这2个限制条件是默认在redis.conf配置文件里的：<br />--- 字典类型：不能满足使用ziplist类型的2个条件，则采用字典类型<br />4集合对象<br />集合对象有2种类型实现：intset类型、字典类型<br />--- intset类型：整数集合，满足2个条件才行：所有元素都是整数值 + 列表元素个数小于512<br />--- 字典类型：不满足上述2个条件，则采用字典；<br />（2）集合对象使用intset类型的限制条件是默认在redis.conf配置文件里的<br />5 有序集合<br />（1）有序集合对象有2种类型实现：ziplist类型、字典+跳跃表<br />--- ziplist类型：需要满足2个条件：所有节点长度都小于64字节 + 列表元素的个数小于128；（注意：元素和分支紧挨一起；先添加的键值对会被放在表头方向，后添加的放在表尾方向）<br />在redis.conf配置文件里的默认参数如下：<br />--- 字典和跳跃表：不能满足用ziplist类型的，就用字典+跳跃表实现<br />（2）用字典+跳跃表组合实现，而不是只用字典的原因如下：<br />跳跃表保存分值和元素，字典也保存分值和元素；之所以用字典+跳跃表的组合，总体是为了在不同场景下的高性能；<br />zrank zrange等命令是通过跳跃表api实现；zscore命令通过字典实现；<br />字典和跳跃表都通过指针共享内存的方式避免重复存储；</p>
-----------------------------------------------------------
@author: ZZQ
@software: PyCharm
@file: leetcode50_myPow.py
@time: 2018/11/22 13:58
要求：实现 pow(x, n) ，即计算 x 的 n 次幂函数。

示例 1:
    输入: 2.00000, 10
    输出: 1024.00000
示例 2:
    输入: 2.10000, 3
    输出: 9.26100
示例 3:
    输入: 2.00000, -2
    输出: 0.25000
    解释: 2-2 = 1/22 = 1/4 = 0.25
不是特别懂这道题目到底是要干嘛？？？ 递归


```python
class Solution():
    def __init__(self):
        pass

    def myPow(self, x, n):
        """
        :type x: float
        :type n: int
        :rtype: float
        """
        if n == 0:
            return 1
        if n < 0:
            new_n = -n
            new_x = 1/float(x)
        else:
            new_n = n
            new_x = x

        ans = self.dfs(new_x, new_n, 0)
        return ans

    def dfs(self, new_x, new_n, ans):
        if new_n == 0:
            return 1
        ans += self.dfs(new_x, new_n / 2, ans)
        if new_n % 2 == 0:
            return ans * ans
        else:
            return ans * ans * new_x

```
<p>mi明明已经把这个字段重构了,为啥还这样提示呢?整个工程全部 查找也找不到这个字段了啊</p>
<div>
<div>
<p>通过yum等软件仓库都可以直接安装RabbitMQ，但版本一般都较为保守。<br />
RabbitMQ官网提供了新版的rpm包（<a href="https://link.jianshu.com?t=http%3A%2F%2Fwww.rabbitmq.com%2Fdownload.html" rel="nofollow" target="_blank">http://www.rabbitmq.com/download.html</a>），但是安装的时候会提示需要erlang版本&gt;=19.3，然而默认yum仓库中的版本较低。<br />
其实RabbitMQ在github上有提供新的erlang包（<a href="https://link.jianshu.com?t=https%3A%2F%2Fgithub.com%2Frabbitmq%2Ferlang-rpm" rel="nofollow" target="_blank">https://github.com/rabbitmq/erlang-rpm</a>）<br />
也可以直接加到yum源中</p>
<pre class="hljs objectivec"><code class="objectivec"><span class="hljs-meta">#vim /etc/yum.repos.d/rabbitmq-erlang.repo
[rabbitmq-erlang]
name=rabbitmq-erlang
baseurl=https:<span class="hljs-comment">//dl.bintray.com/rabbitmq/rpm/erlang/20/el/7
gpgcheck=<span class="hljs-number">1
gpgkey=https:<span class="hljs-comment">//dl.bintray.com/rabbitmq/Keys/rabbitmq-release-signing-key.asc
repo_gpgcheck=<span class="hljs-number">0
enabled=<span class="hljs-number">1

<span class="hljs-meta">#yum clean all
<span class="hljs-meta">#yum makecache
</span></span></span></span></span></span></span></span></code></pre>
<p>然后下载RabbitMQ的RPM包(<a href="https://link.jianshu.com?t=http%3A%2F%2Fwww.rabbitmq.com%2Fdownload.html" rel="nofollow" target="_blank">http://www.rabbitmq.com/download.html</a>)</p>
<pre class="hljs cpp"><code class="cpp">这里是centos7的版本
<span class="hljs-meta">#wget https:<span class="hljs-comment">//dl.bintray.com/rabbitmq/all/rabbitmq-server/3.7.4/rabbitmq-server-3.7.4-1.el7.noarch.rpm
<span class="hljs-meta">#yum install rabbitmq-server-3.7.4-1.el7.noarch.rpm
yum会自动去源里安装依赖包
</span></span></span></code></pre>
<p>安装到这里就完成了，下面进行简单的配置</p>
<pre class="hljs cpp"><code class="cpp">启动RabbitMQ服务
<span class="hljs-meta">#service rabbitmq-server start
状态查看
<span class="hljs-meta">#rabbitmqctl status
启用插件
<span class="hljs-meta">#rabbitmq-plugins enable rabbitmq_management
重启服务
<span class="hljs-meta">#service rabbitmq-server restart
添加帐号:name 密码:passwd
<span class="hljs-meta">#rabbitmqctl add_user name passwd
赋予其administrator角色
<span class="hljs-meta">#rabbitmqctl set_user_tags name administrator
设置权限
<span class="hljs-meta">#rabbitmqctl set_permissions -p / name <span class="hljs-meta-string">".*" <span class="hljs-meta-string">".*" <span class="hljs-meta-string">".*"
</span></span></span></span></span></span></span></span></span></span></code></pre>
<p>然后就能够访问<a href="https://link.jianshu.com?t=http%3A%2F%2Fip%3A15672" rel="nofollow" target="_blank">http://ip:15672</a>进入web管理页面了(外部访问别忘记修改防火墙)。</p>
</div>
<br />感谢文文！！！<br />作者：薇文文<br />链接：https://www.jianshu.com/p/f54dc259a9ed<br />來源：简书<br />简书著作权归作者所有，任何形式的转载都请联系作者获得授权并注明出处。</div>
<div><br />感谢：</div>
<div>https://www.jianshu.com/p/f54dc259a9ed</div>
<div>https://blog.csdn.net/xiangliangyu/article/details/82456233</div>
<h3><strong>7<span style="font-family: 宋体;">、索引：</span><span style="font-family: Calibri;">INDEX</span></strong></h3>
<p><strong>索引</strong>：索引是对数据库表中一列或多列的值进行排序的一种结构。<strong>索引是一个单独的、物理的数据库结构</strong>，它是某个表中一列或若干列值的集合和相应的指向表中物理标识这些值的数据页的逻辑指针清单。由此可知，<strong>索引是要消耗数据库空间的</strong>。而<strong>约束是一种逻辑概念。</strong></p>
<p><img src="https://img2018.cnblogs.com/blog/1086649/201811/1086649-20181122150443217-482315176.png" alt="" /></p>
<p><span style="font-family: 宋体;">例如：一本字典，如何快速找到某个字，可以给字典加目录，对数据库来说</span>,<span style="font-family: 宋体;">索引的作用即是给</span><span style="font-family: Calibri;">"</span><span style="font-family: 宋体;">数据</span><span style="font-family: Calibri;">"</span><span style="font-family: 宋体;">加目录。</span></p>
<p><span style="font-family: 宋体;">设有</span>N<span style="font-family: 宋体;">条随机记录</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">不用索引</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">平均查找</span><span style="font-family: Calibri;">N/2</span><span style="font-family: 宋体;">次</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">那么用了索引之后呢。如果是</span><span style="font-family: Calibri;">btree(</span><span style="font-family: 宋体;">二叉树</span><span style="font-family: Calibri;">)</span><span style="font-family: 宋体;">索引，</span><img title="尚硅谷之MySQL基础第8章DDL7、索引：INDEX" alt="尚硅谷之MySQL基础第8章DDL7、索引：INDEX" width="37" height="22" /><span style="font-family: 宋体;">，如果是</span>hash(<span style="font-family: 宋体;">哈希</span><span style="font-family: Calibri;">)</span><span style="font-family: 宋体;">索引，时间复杂度是</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">。</span></p>
<p><strong>索引好处</strong><span style="font-family: 宋体;">：加快了查询速度</span>(select )</p>
<p><strong>索引坏处</strong>:<span style="font-family: 宋体;">降低了增</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">删</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">改的速度</span><span style="font-family: Calibri;">(update/delete/insert)</span><span style="font-family: 宋体;">，增大了表的文件大小</span><span style="font-family: Calibri;">(</span><span style="font-family: 宋体;">索引文件甚至可能比数据文件还大</span><span style="font-family: Calibri;">)</span></p>
<p>MySQL<span style="font-family: 宋体;">提供多种索引类型供选择：</span></p>
<p>l&nbsp;普通索引：</p>
<p>l&nbsp;唯一性索引：</p>
<p>l&nbsp;主键索引：只有一个主键索引</p>
<p>l&nbsp;<span style="font-family: 宋体;">全文索引：</span>MySQL5.X<span style="font-family: 宋体;">版本只有</span><span style="font-family: Calibri;">MyISAM</span><span style="font-family: 宋体;">存储引擎支持</span><span style="font-family: Calibri;">FULLTEXT</span><span style="font-family: 宋体;">，并且只限于</span><span style="font-family: Calibri;">CHAR</span><span style="font-family: 宋体;">、</span><span style="font-family: Calibri;">VARCHAR</span><span style="font-family: 宋体;">和</span><span style="font-family: Calibri;">TEXT</span><span style="font-family: 宋体;">类型的列上创建。</span></p>
<p>MySQL<span style="font-family: 宋体;">的索引方法：</span></p>
<p>l&nbsp;HASH</p>
<p>l&nbsp;BTREE</p>
<p>MySQL<span style="font-family: 宋体;">中多数索引都以</span><span style="font-family: Calibri;">BTREE</span><span style="font-family: 宋体;">的形式保存。</span></p>
<p><strong>&nbsp;</strong></p>
<p><strong>索引的使用原则：</strong></p>
<p><span style="font-family: 宋体;">（</span>1<span style="font-family: 宋体;">）不过度索引</span></p>
<p><span style="font-family: 宋体;">（</span>2<span style="font-family: 宋体;">）索引条件列</span><span style="font-family: Calibri;">(where</span><span style="font-family: 宋体;">后面最频繁的条件比较适宜索引</span><span style="font-family: Calibri;">)</span></p>
<p><span style="font-family: 宋体;">（</span>3<span style="font-family: 宋体;">）索引散列值</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">过于集中的值不要索引，例如</span><span style="font-family: Calibri;">:</span><span style="font-family: 宋体;">给性别</span><span style="font-family: Calibri;">"</span><span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">","</span><span style="font-family: 宋体;">女</span><span style="font-family: Calibri;">"</span><span style="font-family: 宋体;">加索引</span><span style="font-family: Calibri;">,</span><span style="font-family: 宋体;">意义不大</span></p>
<p>&nbsp;</p>
<p>CREATE INDEX&nbsp;<span style="font-family: 宋体;">索引名</span>&nbsp;<span style="font-family: Calibri;">ON</span>&nbsp;<span style="font-family: 宋体;">表名称</span>&nbsp;<span style="font-family: Calibri;">(column_name,[column_name...]); &nbsp;</span><span style="font-family: 宋体;">最左边的列最关键</span></p>
<p>alter table&nbsp;<span style="font-family: 宋体;">表名称</span>&nbsp;<span style="font-family: Calibri;">drop index</span>&nbsp;<span style="font-family: 宋体;">索引名</span><span style="font-family: Calibri;">;</span></p>
<h3><strong>8<span style="font-family: 宋体;">、自增列：</span><span style="font-family: Calibri;">AUTO_INCREMENT</span></strong></h3>
<p>例如：</p>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="712">
<p>CREATE TABLE t_stu(</p>
<p>sid INT PRIMARY KEY AUTO_INCREMENT,</p>
<p>sname VARCHAR(100) NOT NULL,</p>
<p>gender CHAR NOT NULL DEFAULT '<span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">',</span></p>
<p>birthday DATE,</p>
<p>address VARCHAR(200)</p>
<p>);</p>
</td>
</tr>
</tbody>
</table>
<p><span style="font-family: 宋体;">关于自增长</span>auto_increment<span style="font-family: 宋体;">：</span></p>
<p>（1）整数类型的字段才可以设置自增长。</p>
<p>（2）当需要产生唯一标识符或顺序值时，可设置自增长。</p>
<p>（3）一个表最多只能有一个自增长列</p>
<p>（4）自增长列必须非空</p>
<p>（5）自增长列必须是主键列或唯一键列。</p>
<p><a name="OLE_LINK2"></a>（6）InnoDB<span style="font-family: 宋体;">表的自动增长列可以手动插入，但是插入的值如果是空或者</span><span style="font-family: Calibri;">0</span><span style="font-family: 宋体;">，则实际插入的将是自动增长后的值。</span></p>
<p><span>本教程由尚硅谷教育大数据研究院出品，如需转载请注明来源，欢迎大家关注尚硅谷公众号（atguigu）了解更多。</span></p>
<p><a href="https://blog.csdn.net/weixin_39718665/article/details/78161818" target="_blank">https://blog.csdn.net/weixin_39718665/article/details/78161818</a></p>
<p>setting.py中设置:</p>
<div class="cnblogs_code">
<pre>EMAIL_HOST = <span style="color: #800000;">'</span><span style="color: #800000;">smtp.qq.com</span><span style="color: #800000;">'</span><span style="color: #000000;">
EMAIL_PORT </span>= 25

<span style="color: #008000;">#</span><span style="color: #008000;"> 设置授权登录账号和第三方客户端登录所使用的授权码。</span>
EMAIL_HOST_USER = <span style="color: #800000;">'</span><span style="color: #800000;">*****@qq.com</span><span style="color: #800000;">'</span><span style="color: #000000;">
EMAIL_HOST_PASSWORD </span>= <span style="color: #800000;">'</span><span style="color: #800000;">*******</span><span style="color: #800000;">'</span>

<span style="color: #008000;">#</span><span style="color: #008000;"> 是否采用安全链接进行邮件的发送</span>
EMAIL_USE_TLS = True</pre>
</div>
<p>views.py中</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">发送一封邮件(可以给多人)</span>
<span style="color: #000000;">
    result </span>= send_mail(<span style="color: #800000;">'</span><span style="color: #800000;">Django测试邮件</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">这是一个测试邮件，由&lt;%s&gt;发送！</span><span style="color: #800000;">'</span> % EMAIL_HOST_USER, EMAIL_HOST_USER, [<span style="color: #800000;">'</span><span style="color: #800000;">接收者邮箱</span><span style="color: #800000;">'</span>], auth_user=EMAIL_HOST_USER, auth_password=<span style="color: #000000;">EMAIL_HOST_PASSWORD)
    </span><span style="color: #0000ff;">if</span> result == 1<span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">'</span><span style="color: #800000;">一封邮件发送成功!!</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">'</span><span style="color: #800000;">一封邮件发送失败!!</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">发送多封邮件</span>
    message_one = (<span style="color: #800000;">'</span><span style="color: #800000;">邮箱激活账户</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">这是您的邮箱激活码：xxxx，点击激活</span><span style="color: #800000;">'</span>, EMAIL_HOST_USER, [<span style="color: #800000;">'</span><span style="color: #800000;">接收者邮箱</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    message_two </span>= (<span style="color: #800000;">'</span><span style="color: #800000;">账户密码找回</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">这是您的账户密码：xxxx，点击找回</span><span style="color: #800000;">'</span>, EMAIL_HOST_USER, [<span style="color: #800000;">'</span><span style="color: #800000;">接收者邮箱</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    result </span>=<span style="color: #000000;"> send_mass_mail((message_one, message_two))
    </span><span style="color: #0000ff;">if</span> result == 2<span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">'</span><span style="color: #800000;">多封邮件发送成功!!</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">else</span><span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">'</span><span style="color: #800000;">多封邮件发送失败!!</span><span style="color: #800000;">'</span>)</pre>
</div>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;">发送html邮件</span>
    result = send_mail(<span style="color: #800000;">'</span><span style="color: #800000;">一个链接</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">请点击以下链接：</span><span style="color: #800000;">'</span>, EMAIL_HOST_USER, [EMAIL_HOST_USER], html_message=<span style="color: #800000;">'</span><span style="color: #800000;">&lt;a href="https://www.baidu.com"&gt;https://www.baidu.com&lt;/a&gt;</span><span style="color: #800000;">'</span><span style="color: #000000;">)
    </span><span style="color: #0000ff;">if</span> result == 1<span style="color: #000000;">:
        </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">'</span><span style="color: #800000;">HTML邮件发送成功!!</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p>导入一个新的maven项目发现很奇怪的一个bug，提示错误，&ldquo;@Override is not allowed when implementing interface method&rdquo;。详细的代码描述如下：</p>
<p><img src="https://img2018.cnblogs.com/blog/1333410/201811/1333410-20181122135105351-1097459944.png" alt="" /></p>
<p>&nbsp;</p>
<p>错误原因（敲黑板，划重点了哈）：<strong><span style="color: #ff0000;">@Override注解是从jdk1.5开始出现的，是用来标注方法重写的。通常方法重写发生在继承父类，重写父类方法，或者实现接口，实现接口方法。@Override能够保证你正确重写方法，当你重写方法出错时，比如方法名误写，或者漏掉参数，编译器会提示编译错误。出现以上问题，则跟编译器版本问题有关。编译器1.5只支持@Override注释重写父类方法，不支持实现接口方法。</span></strong></p>
<p>&nbsp;</p>
<p>解决办法：我的IDE默认使用jdk1.5的编译器，我们将language level设置高于jdk1.5版本即可</p>
<p>1、File &mdash;&mdash;&gt; Project Structure &mdash;&mdash;&gt;Modules&mdash;&mdash;&gt;Language level 修改成 &ldquo;7 - Diamonds,ARM,multi-catch etc.&rdquo;</p>
<p><img src="https://img2018.cnblogs.com/blog/1333410/201811/1333410-20181122142017990-1280477404.png" alt="" /></p>
<p>&nbsp;</p>
<p>将File &mdash;&mdash;&gt; Settings &mdash;&mdash;&gt; Build, Execution, Deployment &mdash;&mdash;&gt; Compiler &mdash;&mdash;&gt; Java Compiler<br />Target bytecode version 改为1.8,即可</p>
<p><img src="https://img2018.cnblogs.com/blog/1333410/201811/1333410-20181122145906472-45391374.png" alt="" /></p>
<p>&nbsp;</p>
<p>参考网址：<a href="https://blog.csdn.net/fighting_wzc/article/details/79105960" target="_blank">https://blog.csdn.net/fighting_wzc/article/details/79105960</a></p>
<p>　　在做企业页面的时候，大部分页面都应该是活的，不应该写死，因为要从后台拿数据进行填充。而后台的数据是不确定的，有时候会让我们的容器撑得很大。这时候我们需要隐藏掉滚动条达到美观或者其他布局效果，隐藏掉单个方向滚动条，例如： 隐藏Y轴滚动条 overflow-Y :hidden 但这样，会让我们的滚动元素变得不可滚动。百度测试了一下，以下该伪类可以实现既隐藏掉滚动条，又不会影响元素的滚动/滑动。这里的隐藏属于 display:none 类似效果，是不会影响布局的。如图：</p>
<p><img src="https://img2018.cnblogs.com/blog/1394956/201811/1394956-20181122150355525-1438532569.png" alt="" /></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre> <span style="color: #0000ff;">var</span> json1 = { <br />addroleData: [<br />{ key:<span style="color: #800080;">1</span>, label:<span style="color: #800000;">'</span><span style="color: #800000;">一</span><span style="color: #800000;">'</span> },<br />{ label:<span style="color: #800000;">'</span><span style="color: #800000;">二</span><span style="color: #800000;">'</span>, key:<span style="color: #800080;">2</span> },<br />{ key:<span style="color: #800080;">3</span>, label:<span style="color: #800000;">'</span><span style="color: #800000;">三</span><span style="color: #800000;">'</span> },<br />{ key:<span style="color: #800080;">3</span>, label:<span style="color: #800000;">'</span><span style="color: #800000;">二</span><span style="color: #800000;">'</span> },<br />{ key:<span style="color: #800080;">4</span>, label:<span style="color: #800000;">'</span><span style="color: #800000;">二</span><span style="color: #800000;">'</span> }] <br />}; <br /><br /><span style="color: #0000ff;">var</span> json2 = { addroleData: [{ label:<span style="color: #800000;">'</span><span style="color: #800000;">一</span><span style="color: #800000;">'</span>, key:<span style="color: #800080;">1</span> },{ key:<span style="color: #800080;">2</span>, label:<span style="color: #800000;">'</span><span style="color: #800000;">二</span><span style="color: #800000;">'</span> }] }; <br />function mergeArr(json1, json2) <br />{ <br /><br /><span style="color: #0000ff;">　　var</span> keyArr = []; <br /><br /><span style="color: #0000ff;">　　for</span>(<span style="color: #0000ff;">var</span> i = <span style="color: #800080;">0</span>; i&lt; json1.length; i++) { <br /><br /><span style="color: #0000ff;">　　if</span> ( JSON.stringify(json2).indexOf(JSON.stringify(json1[i])) == -<span style="color: #800080;">1</span> ) { <br />　　　　　　keyArr.push(i); } <br />　　　　} <span style="color: #0000ff;">return</span> keyArr; <br />　　} console.log(mergeArr(json1.addroleData, json2.addroleData));<br /><br />判断的主要在于<code>if ( JSON.stringify(json2).indexOf(JSON.stringify(json1[i])) == -1 )</code> 
实践发现确实可以判断，但是你的数组里面的对象键值对的顺序要一致，否则即使对象相同，键值对顺序不同也会判断不一样。</pre>
</div>
<p>&nbsp;</p>
<p>配置文件优先级</p>
<p>./config/ &nbsp;./ &nbsp;classpath:config/ &nbsp;classpath:</p>
<p>关于 arch-utils-wechat&nbsp;WechatConf.class.getResourceAsStream("/wechat/wechat.properties") ，ide 读的是 resources/wechat/wechat .properties，java -jar 运行读的是 arch-utils-wechat.jar 中 classpath:wechat/wechat.properties</p>
<p><strong>1、读取文件并将文件存在字典中</strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">#</span><span style="color: #008000;"> 文件读取方式操作</span>
accounts_file = <span style="color: #800000;">'</span><span style="color: #800000;">F:\\Myself\\xxx\\xxx\\xxx\\user.txt</span><span style="color: #800000;">'</span>   <span style="color: #008000;">#</span><span style="color: #008000;">文件路径</span>
account_list = open(accounts_file) <span style="color: #008000;">#</span><span style="color: #008000;">打开文件</span>
user_list={}<span style="color: #008000;">#</span><span style="color: #008000;">创建一个空字典</span><span style="color: #008000;">
#</span><span style="color: #008000;">将文件一行行读取，并保存到字典中</span>
<span style="color: #0000ff;">for</span> user <span style="color: #0000ff;">in</span><span style="color: #000000;"> account_list.readlines():
    user </span>=<span style="color: #000000;">user.strip()
    </span><span style="color: #0000ff;">if</span> len(user)==<span style="color: #000000;">0:
        </span><span style="color: #0000ff;">continue</span>
    <span style="color: #0000ff;">else</span><span style="color: #000000;">:
        user_list[user.split(</span><span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span>)[0]] = user.split(<span style="color: #800000;">'</span><span style="color: #800000;">,</span><span style="color: #800000;">'</span>)[1] <span style="color: #008000;">#</span><span style="color: #008000;">为字典的key赋值value</span>
account_list.close()</pre>
</div>
<p>在读取路径时，比如c:\\niu\\desktop 这种，open在打开文件时会把c:\\niu 认为里面有一个\n，所以我们可以在文件路径前加一个r，比如f=open(r'c:\\niu\\desktop\haha')&nbsp;&nbsp;表示原字符，不需要转义。</p>
<p>print(f.readline())&nbsp;#读取一行数据</p>
<p>print(f.readlines())#获取文件里面所有的数据，每一行数据放到一个list里面</p>
<p>print(f.read())&nbsp;#获取全部文件内容</p>
<p>依次执行上面三种函数，读取时，readline读取第一行，readlines 读取剩余内容，read读取不到内容，产生这种原因，是因为文件指针的原因。</p>
<p>文件指针：打开文件，默认指针在前，readline 读取第一行，读取完后，指针读取到第二行，readlines表示读取全部，所以将文件所有内容都读取完，指针读取到最后，再使用read读取的时候，就读取不到任何东西了。</p>
<p><strong>2、写入文件</strong></p>
<div class="cnblogs_code">
<pre>fw = open(<span style="color: #800000;">'</span><span style="color: #800000;">F:\\Myself\\xxx\\xxx\\xxx\\user.txt</span><span style="color: #800000;">'</span>, mode=<span style="color: #800000;">'</span><span style="color: #800000;">a</span><span style="color: #800000;">'</span>, encoding=<span style="color: #800000;">'</span><span style="color: #800000;">UTF-8</span><span style="color: #800000;">'</span><span style="color: #000000;">)   #字符编码格式
fw.writelines(</span><span style="color: #800000;">'</span><span style="color: #800000;">%s,%s\n</span><span style="color: #800000;">'</span>%<span style="color: #000000;">(loginName.lower(),passwd))
fw.close()</span></pre>
</div>
<p>&nbsp;</p>
<p><strong>3、关于open()的mode参数</strong>：</p>
<p>'r'：读</p>
<p>'w'：写，如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</p>
<p>'a'：追加，如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</p>
<p>'x'：写模式，新建一个文件，如果该文件已存在则会报错。</p>
<p>'r+' == r+w（可读可写，文件若不存在就报错(IOError)）</p>
<p>'w+' == w+r（可读可写，文件若不存在就创建）</p>
<p>'a+' ==a+r（可追加可写，文件若不存在就创建）</p>
<p>对应的，如果是二进制文件，就都加一个b就好啦：</p>
<p>'rb'　　'wb'　　'ab'　　'rb+'　　'wb+'　　'ab+'</p>
<p><span style="font-size: 16px;"><strong>题记：</strong></span>项目打包bash脚本</p>
<p><span style="color: #ff00ff; font-size: 18px;"><strong>环境准备</strong></span></p>
<p><span style="font-size: 15px;"><strong>　　maven版本</strong></span>：3.5.2</p>
<div class="cnblogs_code">
<pre>　　　　mvn -v　　#查看maven的版本信息</pre>
</div>
<p><strong><span style="font-size: 15px;">　　svn版本：</span></strong>1.4.0</p>
<div class="cnblogs_code">
<pre>　　　　svn --version　　#查看svn版本信息</pre>
</div>
<p>&nbsp;</p>
<p>1、update_and_package.sh脚本代码如下：</p>
<div class="cnblogs_code">
<pre>#!/bin/<span style="color: #0000ff;">sh</span>

<span style="color: #0000ff;">if</span> [ $# == <span style="color: #800080;">1</span> ]; <span style="color: #0000ff;">then</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">[INFO] start update svn open...</span><span style="color: #800000;">"</span>

        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;"> ------------------------------------------------------------------------</span><span style="color: #800000;">"</span><span style="color: #000000;">


        cd </span>/home/hostname/webapps/project_name<span style="color: #000000;">

        svn update

        </span><span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">[INFO] success update svn open...</span><span style="color: #800000;">"</span>

        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;"> ------------------------------------------------------------------------</span><span style="color: #800000;">"</span>

        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">[INFO] start maven</span><span style="color: #800000;">"</span>

        <span style="color: #0000ff;">if</span> [ <span style="color: #800000;">"</span><span style="color: #800000;">$1</span><span style="color: #800000;">"</span> == <span style="color: #800000;">"</span><span style="color: #800000;">test</span><span style="color: #800000;">"</span> ]; <span style="color: #0000ff;">then</span><span style="color: #000000;">
           mvn test
        </span><span style="color: #0000ff;">fi</span>

        <span style="color: #0000ff;">if</span> [ <span style="color: #800000;">"</span><span style="color: #800000;">$1</span><span style="color: #800000;">"</span> == <span style="color: #800000;">"</span><span style="color: #800000;">install</span><span style="color: #800000;">"</span> ]; <span style="color: #0000ff;">then</span><span style="color: #000000;">
           mvn clean package </span>-Dmaven.test.skip=<span style="color: #0000ff;">true</span>
        <span style="color: #0000ff;">fi</span>

        <span style="color: #0000ff;">if</span> [ <span style="color: #800000;">"</span><span style="color: #800000;">$1</span><span style="color: #800000;">"</span> == <span style="color: #800000;">"</span><span style="color: #800000;">package</span><span style="color: #800000;">"</span> ]; <span style="color: #0000ff;">then</span><span style="color: #000000;">
           mvn package </span>-Dmaven.test.skip=<span style="color: #0000ff;">true</span>
        <span style="color: #0000ff;">fi</span>

        <span style="color: #0000ff;">if</span> [ <span style="color: #800000;">"</span><span style="color: #800000;">$1</span><span style="color: #800000;">"</span> == <span style="color: #800000;">"</span><span style="color: #800000;">clean</span><span style="color: #800000;">"</span> ]; <span style="color: #0000ff;">then</span><span style="color: #000000;">
           mvn clean
        </span><span style="color: #0000ff;">fi</span>
<span style="color: #0000ff;">else</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">Useage: </span><span style="color: #800000;">"</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">    ./update.sh test              Test the maven project.</span><span style="color: #800000;">"</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">    ./update.sh install           Install the maven project.</span><span style="color: #800000;">"</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">    ./update.sh package           Package the maven project.</span><span style="color: #800000;">"</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">    ./update.sh clean             Clean the maven project.</span><span style="color: #800000;">"</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">    ./update.sh compile           Compile the maven project.</span><span style="color: #800000;">"</span>
<span style="color: #0000ff;">fi</span></pre>
</div>
<p><strong>###注意：</strong>脚本将项目打包成<span style="color: #ff00ff;"><strong>jar包</strong></span></p>
<p><span style="color: #000000;">2、rsync_project.sh&nbsp; 更新并执行jar包</span></p>
<div class="cnblogs_code">
<pre>#!/bin/<span style="color: #000000;">bash
ARG</span>=$<span style="color: #800080;">1</span><span style="color: #000000;">
VERSION</span>=$<span style="color: #800080;">2</span><span style="color: #000000;">
date2</span>=`<span style="color: #0000ff;">date</span> +%Y%m%<span style="color: #000000;">d`

</span><span style="color: #0000ff;">if</span> [ -z $ARG ];<span style="color: #0000ff;">then</span>
        <span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">Please input you operation,such as update</span><span style="color: #800000;">"</span><span style="color: #000000;">
        exit </span><span style="color: #800080;">3</span>
<span style="color: #0000ff;">fi</span>

<span style="color: #0000ff;">case</span> $ARG <span style="color: #0000ff;">in</span><span style="color: #000000;"> update)
        </span><span style="color: #0000ff;">mkdir</span> /home/<span style="color: #0000ff;">hostname</span>/project_name/<span style="color: #000000;">$date2
        rsync </span>-avz --delete <span style="color: #800080;">192.168</span>.<span style="color: #800080;">1.10</span>::home/<span style="color: #0000ff;">hostname</span>/webapps/project_name/target/manage-<span style="color: #800080;">0.0</span>.<span style="color: #800080;">1</span>-SNAPSHOT.jar /home/<span style="color: #0000ff;">hostname</span>/webapps/$date2/manage-<span style="color: #800080;">0.0</span>.<span style="color: #800080;">1</span>-<span style="color: #000000;">SNAPSHOT.jar
        </span><span style="color: #0000ff;">cp</span> -f /home/<span style="color: #0000ff;">hostname</span>/project_name/$date2/manage-<span style="color: #800080;">0.0</span>.<span style="color: #800080;">1</span>-SNAPSHOT.jar <span style="color: #008000;">/</span><span style="color: #008000;">home/hostname/project_name/webapps/manage-0.0.1-SNAPSHOT.jar</span>
        <span style="color: #0000ff;">sh</span> /home/<span style="color: #0000ff;">hostname</span>/project_name/bin/stop.<span style="color: #0000ff;">sh</span>
        <span style="color: #0000ff;">sleep</span> <span style="color: #800080;">1</span>
        <span style="color: #0000ff;">sh</span> /home/<span style="color: #0000ff;">hostname</span>/project_name/bin/start.<span style="color: #0000ff;">sh</span><span style="color: #000000;">
        tailf </span>-<span style="color: #800080;">50</span> /home/<span style="color: #0000ff;">hostname</span>/project_name/logs/<span style="color: #000000;">nohup.out
                                ;;      
    </span>*<span style="color: #000000;">)
        </span><span style="color: #0000ff;">echo</span> <span style="color: #800000;">"</span><span style="color: #800000;">operation time: </span><span style="color: #800000;">"</span>$<span style="color: #0000ff;">date</span><span style="color: #000000;">
        ;;
    </span><span style="color: #0000ff;">esac</span></pre>
</div>
<p>3、stop.sh脚本</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>#! /bin/<span style="color: #0000ff;">sh</span><span style="color: #000000;">

APP_NAME</span>=<span style="color: #000000;">project_name.jar

tpid</span>=`<span style="color: #0000ff;">ps</span> -ef|<span style="color: #0000ff;">grep</span> $APP_NAME|<span style="color: #0000ff;">grep</span> -v <span style="color: #0000ff;">grep</span>|<span style="color: #0000ff;">grep</span> -v <span style="color: #0000ff;">kill</span>|<span style="color: #0000ff;">awk</span> <span style="color: #800000;">'</span><span style="color: #800000;">{print $2}</span><span style="color: #800000;">'</span><span style="color: #000000;">`
</span><span style="color: #0000ff;">if</span> [ ${tpid} ]; <span style="color: #0000ff;">then</span>
    <span style="color: #0000ff;">echo</span> <span style="color: #800000;">'</span><span style="color: #800000;">Kill Process!</span><span style="color: #800000;">'</span>
    <span style="color: #0000ff;">kill</span> -<span style="color: #800080;">9</span><span style="color: #000000;"> $tpid
</span><span style="color: #0000ff;">fi</span></pre>
</div>
<p>&nbsp;</p>
<p>4、start.sh</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>#! /bin/<span style="color: #0000ff;">sh</span><span style="color: #000000;">

JAVA_HOME</span>=/opt/jdk1.<span style="color: #800080;">8</span><span style="color: #000000;">.0_91

</span><span style="color: #0000ff;">if</span> test -n <span style="color: #800000;">"</span><span style="color: #800000;">${JAVA_HOME}</span><span style="color: #800000;">"</span>; <span style="color: #0000ff;">then</span>
  <span style="color: #0000ff;">if</span> test -z <span style="color: #800000;">"</span><span style="color: #800000;">${JAVA_EXE}</span><span style="color: #800000;">"</span>; <span style="color: #0000ff;">then</span><span style="color: #000000;">
    JAVA_EXE</span>=$JAVA_HOME/bin/<span style="color: #000000;">java
  </span><span style="color: #0000ff;">fi</span>
<span style="color: #0000ff;">fi</span>

<span style="color: #0000ff;">if</span> test -z <span style="color: #800000;">"</span><span style="color: #800000;">${JAVA_EXE}</span><span style="color: #800000;">"</span>; <span style="color: #0000ff;">then</span><span style="color: #000000;">
  JAVA_EXE</span>=<span style="color: #000000;">java
</span><span style="color: #0000ff;">fi</span><span style="color: #000000;">

nohup $JAVA_EXE </span>-jar /home/hostname/project_name/webapps/project_name.jar --spring.config.name=application-outter.properties --spring.config.location=/home/hostname/project_name/webapps/application-outter.properties --logging.config=/home/hostname/peoject_name/webapps/log4j2.xml &gt; /home/hostname/project_name/logs/nohup.out &amp;</pre>
</div>
<p>&nbsp;</p>
<p align="center">&nbsp;</p>
<p>网上的教程很多，我也参考了很多，以下是我实践的步骤，真实有效。</p>
<p align="center">&nbsp;</p>
<p align="left"><strong>1</strong><strong>．配置Mysql 8.0安装源：</strong></p>
<p align="left"><span style="color: #ff0000;">sudo rpm -Uvh <a href="https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm"><span style="color: #ff0000;">https://dev.mysql.com/get/mysql80-community-release-el7-1.noarch.rpm</span></a></span></p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151659938-1028858166.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left"><strong>2</strong><strong>．安装Mysql 8.0</strong></p>
<p align="left"><span style="color: #ff0000;">sudo yum --enablerepo=mysql80-community install mysql-community-server</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151708411-1944079796.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">以下都选y</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151717727-494236291.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151727025-1733677675.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">看到complete就是安装完啦，是不是很简单？</p>
<p align="left">&nbsp;</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151733442-1875742570.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left"><strong>3.</strong><strong>启动mysql服务</strong></p>
<p align="left">安装完的第一件事当然是启动mysql服务啦</p>
<p align="left"><span style="color: #ff0000;">sudo service mysqld start</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151755001-2084775461.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">这样就算启动完了哦，不信？看下运行状态：</p>
<p align="left">service mysqld status</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151804575-361254490.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p align="left">嗯，没骗你吧。。。</p>
<p align="left">&nbsp;</p>
<p align="left"><strong>4.</strong><strong>查看root临时密码：</strong></p>
<p align="left">安装完mysql之后，会生成一个临时的密码让root用户登录，那么临时密码在哪里看呢？</p>
<p align="left">输入以下命令就可以啦：</p>
<p align="left"><span style="color: #ff0000;">grep "A temporary password" /var/log/mysqld.log</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151814459-905048564.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">我去，好复杂。。。</p>
<p align="left">&nbsp;</p>
<p align="left"><strong>5.</strong><strong>更改临时密码：</strong></p>
<p align="left">这个密码估计也只有外星人能记得住了，作为地球人，第一件事就是改成我自己容易记得密码啦。</p>
<p align="left">先用临时密码登录mysql</p>
<p align="left">输入：<span style="color: #ff0000;">mysql -uroot -p</span></p>
<p align="left">在Enter password：后面输入密码，注意输入密码的时候是看不到的哟，别担心，直管输完回车就行。</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151822654-1418968098.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">恭喜你，这样就是登录成功了。</p>
<p align="left">先在我们要改密码了哟：</p>
<p align="left">输入：ALTER USER 'root'@'localhost' IDENTIFIED BY 'new password';</p>
<p align="left">这里的new password要改成你自己的密码哟，我想把密码改成root，所以我输入：ALTER USER 'root'@'localhost' IDENTIFIED BY 'root';</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151841717-1373578082.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">哎哟，提示密码不满足密码验证策略，也是，密码太简单了呢。</p>
<p align="left">好吧，现在有2种选择：</p>
<ol>
<li>把密码改复杂点，让它符合密码验证策略，这个当然是最好的，符合国际惯例；</li>
<li>把密码验证策略改简单点，让它适用简单的密码，这个符合懒人的做法。</li>
</ol>
<p align="left">额，作为一个上进的人，那我就选择2吧。</p>
<p align="left">&nbsp;</p>
<p align="left">那我们先看看当前的密码验证策略是怎么样的吧。</p>
<p align="left">输入：SHOW VARIABLES LIKE 'validate_password.%';</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151855753-1362027465.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">我去，重置密码之前还不让看。。。直接看官方文档吧：</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151902664-1580634622.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left"><code><span style="text-decoration: underline;"><a href="https://dev.mysql.com/doc/refman/8.0/en/validate-password-options-variables.html#sysvar_validate_password.length">validate_password.length</a></span></code> 是密码的最小长度，默认是8，我们把它改成4</p>
<p align="left">&nbsp;</p>
<p align="left"><span style="color: #ff0000;">set global validate_password.length=4;</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151932092-373943933.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left"><code><span style="text-decoration: underline;"><a href="https://dev.mysql.com/doc/refman/8.0/en/validate-password-options-variables.html#sysvar_validate_password.policy">validate_password.policy</a></span></code> 验证密码的复杂程度，我们把它改成0</p>
<p align="left">&nbsp;</p>
<p align="left"><span style="color: #ff0000;">set global validate_password.policy=0;</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151943674-1831942190.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left"><code><span style="text-decoration: underline;"><a href="https://dev.mysql.com/doc/refman/8.0/en/validate-password-options-variables.html#sysvar_validate_password.check_user_name">validate_password.check_user_name</a></span></code> 用户名检查，用户名和密码不能相同，我们也把它去掉</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151952390-1351286761.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left"><span style="color: #ff0000;">set global validate_password.check_user_name=off;</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122151959793-253316956.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">现在再执行修改密码的命令：</p>
<p align="left"><span style="color: #ff0000;">ALTER USER 'root'@'localhost' IDENTIFIED BY 'root';</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152007846-2005663146.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">成功了，密码设成了root，但是我建议大家还是设个复杂点密码，不要这么懒哦。</p>
<p align="left">&nbsp;</p>
<p align="left"><strong>6.</strong><strong>配置远程访问</strong></p>
<p align="left">用mysql客户连接报不允许连接的错误，那是因为没开通远程访问的权限哦。</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152019910-1326274016.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">百度上基本说执行</p>
<p align="left">GRANT ALL ON *.* TO 'root'@'%'; 就行了，但是一不下心报了个错：</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152028652-1151979303.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">看下默认MySQL用户：</p>
<p align="left">use mysql;</p>
<p align="left">select host, user, authentication_string, plugin from user;</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152036813-849038370.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">发现root的host是localhost，不是%哦，那我们就加个host是%的root账号：</p>
<p align="left"><span style="color: #ff0000;">CREATE USER 'root'@'%' IDENTIFIED BY 'root';</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152044599-644684323.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">再查下用户</p>
<p align="left">select host, user, authentication_string, plugin from user;</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152052613-2136359368.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">可以看到已经新增了host为%的root用户</p>
<p align="left">然后再执行：</p>
<p align="left"><span style="color: #ff0000;">GRANT ALL ON *.* TO 'root'@'%';</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152104792-859646088.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">成功了耶，嘿嘿。</p>
<p align="left">连接成功：</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152116626-764505593.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left"><strong>7.navicat</strong><strong>连接mysql</strong></p>
<p align="left">用navicat连接mysql还是会报错：</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152127843-363688530.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">原因是mysql8的加密方式规则不一样，是caching_sha2_password</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152143252-38338638.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">把加密方式改成mysql_native_password就行了：</p>
<p align="left">ALTER USER '[用户名]'@'%' IDENTIFIED WITH mysql_native_password BY '[密码]';</p>
<p align="left"><span style="color: #ff0000;">ALTER USER 'root'@'%' IDENTIFIED WITH mysql_native_password BY 'root';</span></p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152153176-32673483.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">加密方式以及改成了mysql_native_password：</p>
<p align="left">&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152200056-1532007007.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/blog/360288/201811/360288-20181122152208166-846659318.png" alt="" /></p>
<p>&nbsp;</p>
<p align="left">&nbsp;</p>
<p align="left">这样就可以了哦。大功告成！</p>
<h1 style="text-align: center;">Python3 解决 'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte</h1>
<h2>一、问题</h2>
<p>　　request.Request(url，headers=headerDict))的时候出现异常信息：'utf-8' codec can't decode byte 0x8b in position 1: invalid start byte</p>
<h2>二、解决方案</h2>
<p>　　http头中headerDict参数：&nbsp;"Accept-Encoding": "gzip, deflate",</p>
<p>　　代表本地可以接收压缩格式的数据，而服务器在处理时就将大文件压缩再发回客户端，IE在接收完成后在本地对这个文件又进行了解压操作。</p>
<p>　　出错的原因是因为你的程序没有解压这个文件，所以删掉这行就不会出现问题。</p>
<h1 class="postTitle">&nbsp;</h1>
<div class="postBody">
<div id="cnblogs_post_body" class="blogpost-body">
<p>在工作中，我们用于捕捉性能问题最常用的就是打开慢查询，定位执行效率差的SQL，那么当我们定位到一个SQL以后还不算完事，我们还需要知道该SQL的执行计划，比如是全表扫描，还是索引扫描，这些都需要通过EXPLAIN去完成。EXPLAIN命令是查看优化器如何决定执行查询的主要方法。可以帮助我们深入了解MySQL的基于开销的优化器，还可以获得很多可能被优化器考虑到的访问策略的细节，以及当运行SQL语句时哪种策略预计会被优化器采用。需要注意的是，生成的QEP并不确定，它可能会根据很多因素发生改变。MySQL不会将一个QEP和某个给定查询绑定，QEP将由SQL语句每次执行时的实际情况确定，即便使用存储过程也是如此。尽管在存储过程中SQL语句都是预先解析过的，但QEP仍然会在每次调用存储过程的时候才被确定。</p>
<p><strong>通过执行计划可以知道什么？</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select d1.age, t2.id from (select age,name from t1 where id in (1,2))d1, t2 where d1.age=t2.age group by d1.age, t2.id order by t2.id;
+----+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+
| id | select_type | table      | type  | possible_keys | key     | key_len | ref    | rows | Extra                           |
+----+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+
|  1 | PRIMARY     | &lt;derived2&gt; | ALL   | NULL          | NULL    | NULL    | NULL   |    2 | Using temporary; Using filesort |
|  1 | PRIMARY     | t2         | ref   | age           | age     | 5       | d1.age |    1 | Using where; Using index        |
|  2 | DERIVED     | t1         | range | PRIMARY       | PRIMARY | 4       | NULL   |    2 | Using where                     |
+----+-------------+------------+-------+---------------+---------+---------+--------+------+---------------------------------+
3 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>MySQL执行计划调用方式<br /></strong>1.EXPLAIN SELECT &hellip;&hellip;<br />变体：<br />2.EXPLAIN EXTENDED SELECT &hellip;&hellip;<br />将执行计划"反编译"成SELECT语句，运行SHOW WARNINGS&nbsp;<br />可得到被MySQL优化器优化后的查询语句<br />3.EXPLAIN PARTITIONS SELECT &hellip;&hellip;<br />用于分区表的EXPLAIN生成QEP的信息</p>
<p><strong>执行计划包含的信息</strong></p>
<div class="cnblogs_code">
<pre>+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+</pre>
</div>
<p><strong>1. id：</strong></p>
<p><strong>包含一组数字，表示查询中执行select子句或操作表的顺序</strong></p>
<p><strong>Example（</strong><strong>id相同，执行顺序由上至下</strong><strong>）</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select t2.* from t1, t2, t3 where t1.id=t2.id and t1.id=t3.id and t1.name='';
+----+-------------+-------+--------+---------------+---------+---------+------------+------+--------------------------+
| id | select_type | table | type   | possible_keys | key     | key_len | ref        | rows | Extra                    |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+--------------------------+
|  1 | SIMPLE      | t1    | ref    | PRIMARY,name  | name    | 63      | const      |    1 | Using where; Using index |
|  1 | SIMPLE      | t2    | eq_ref | PRIMARY       | PRIMARY | 4       | test.t1.id |    1 |                          |
|  1 | SIMPLE      | t3    | eq_ref | PRIMARY       | PRIMARY | 4       | test.t1.id |    1 | Using index              |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+--------------------------+
3 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>Example （如果是子查询，id的序号会递增，id值越大优先级越高，越先被执行）</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select t2.* from t2 where id = (select id from t1 where id = (select t3.id from t3 where t3.name=''));
+----+-------------+-------+------+---------------+------+---------+------+------+-----------------------------------------------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra                                               |
+----+-------------+-------+------+---------------+------+---------+------+------+-----------------------------------------------------+
|  1 | PRIMARY     | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | Impossible WHERE noticed after reading const tables |
|  2 | SUBQUERY    | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | no matching row in const table                      |
|  3 | SUBQUERY    | t3    | ref  | name          | name | 63      |      |    1 | Using where; Using index                            |
+----+-------------+-------+------+---------------+------+---------+------+------+-----------------------------------------------------+
3 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>Example（id如果相同，可以认为是一组，从上往下顺序执行；在所有组中，id值越大，优先级越高，越先执行）</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select t2.* from (select t3.id from t3 where t3.name='')s1, t2 where s1.id=t2.id;
+----+-------------+------------+--------+---------------+---------+---------+-------+------+--------------------------+
| id | select_type | table      | type   | possible_keys | key     | key_len | ref   | rows | Extra                    |
+----+-------------+------------+--------+---------------+---------+---------+-------+------+--------------------------+
|  1 | PRIMARY     | &lt;derived2&gt; | system | NULL          | NULL    | NULL    | NULL  |    1 |                          |
|  1 | PRIMARY     | t2         | const  | PRIMARY       | PRIMARY | 4       | const |    1 |                          |
|  2 | DERIVED     | t3         | ref    | name          | name    | 63      |       |    1 | Using where; Using index |
+----+-------------+------------+--------+---------------+---------+---------+-------+------+--------------------------+
3 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>2. select_type</strong></p>
<p><strong>示查询中每个select子句的类型（简单OR复杂）</strong></p>
<p><strong>a. SIMPLE：查询中不包含子查询或者UNION</strong><br /><strong>b. 查询中若包含任何复杂的子部分，最外层查询则被标记为：PRIMARY</strong><br /><strong>c. 在SELECT或WHERE列表中包含了子查询，该子查询被标记为：SUBQUERY</strong><br /><strong>d. 在FROM列表中包含的子查询被标记为：DERIVED（衍生）用来表示包含在from子句中的子查询的select，mysql会递归执行并将结果放到一个临时表中。服务器内部称为"派生表"，因为该临时表是从子查询中派生出来的</strong><br /><strong>e. 若第二个SELECT出现在UNION之后，则被标记为UNION；若UNION包含在FROM子句的子查询中，外层SELECT将被标记为：DERIVED</strong><br /><strong>f. 从UNION表获取结果的SELECT被标记为：UNION RESULT</strong></p>
<p><strong>SUBQUERY和UNION还可以被标记为DEPENDENT和UNCACHEABLE。</strong><br /><strong>DEPENDENT意味着select依赖于外层查询中发现的数据。</strong><br /><strong>UNCACHEABLE意味着select中的某些 特性阻止结果被缓存于一个item_cache中。</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select d1.name, ( select id from t3) d2 from (select id,name from t1 where name='')d1 union (select name,id from t2);
+----+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+
| id | select_type  | table      | type   | possible_keys | key  | key_len | ref  | rows | Extra                    |
+----+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+
|  1 | PRIMARY      | &lt;derived3&gt; | system | NULL          | NULL | NULL    | NULL |    0 | const row not found      |
|  3 | DERIVED      | t1         | ref    | name          | name | 63      |      |    1 | Using where; Using index |
|  2 | SUBQUERY     | t3         | index  | NULL          | age  | 5       | NULL |    6 | Using index              |
|  4 | UNION        | t2         | index  | NULL          | name | 63      | NULL |    4 | Using index              |
| NULL | UNION RESULT | &lt;union1,4&gt; | ALL    | NULL          | NULL | NULL    | NULL | NULL |                          |
+----+--------------+------------+--------+---------------+------+---------+------+------+--------------------------+
5 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>第一行：id列为1，表示第一个select，select_type列的primary表 示该查询为外层查询，table列被标记为&lt;derived3&gt;，表示查询结果来自一个衍生表，其中3代表该查询衍生自第三个select查询，即id为3的select。</strong><br /><strong>第二行：id为3，表示该查询的执行次序为2（ 4 =&gt; 3），是整个查询中第三个select的一部分。因查询包含在from中，所以为derived。</strong><br /><strong>第三行：select列表中的子查询，select_type为subquery，为整个查询中的第二个select。</strong><br /><strong>第四行：select_type为union，说明第四个select是union里的第二个select，最先执行。</strong><br /><strong>第五行：代表从union的临时表中读取行的阶段，table列的&lt;union1,4&gt;表示用第一个和第四个select的结果进行union操作。</strong></p>
<p><strong>3. type&nbsp;</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p><strong>表示MySQL在表中找到所需行的方式，又称&ldquo;访问类型&rdquo;，常见类型如下:</strong></p>
<p><strong>&nbsp;ALL, index,&nbsp; range, ref, eq_ref, const, system, NULL</strong></p>
<p><strong>从左到右，性能从最差到最好</strong></p>
<p><strong>Example</strong></p>
<p><strong>a. ALL：Full Table Scan， MySQL将遍历全表以找到匹配的行</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select * from t1 where email='';
+----+-------------+-------+------+---------------+------+---------+------+------+-------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+-------+------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | ALL  | NULL          | NULL | NULL    | NULL |    4 | Using where |
+----+-------------+-------+------+---------------+------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>b. index：Full Index Scan，index与ALL区别为index类型只遍历索引树</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select id from t1;
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>c. range:索引范围扫描，对索引的扫描开始于某一点，返回匹配值域的行。显而易见的索引范围扫描是带有between或者where子句里带有&lt;, &gt;查询。当mysql使用索引去查找一系列值时，例如IN()和OR列表，也会显示range（范围扫描）,当然性能上面是有差异的。</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select * from t1 where id in (1,4);
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    2 | Using where |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;explain select * from t1 where id between 1 and 4;
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    3 | Using where |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;explain select * from t1 where id=1 or id=4;       
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    2 | Using where |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
1 row in set (0.01 sec)

(root@yayun-mysql-server) [test]&gt;explain select * from t1 where id &gt; 1;      
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    3 | Using where |
+----+-------------+-------+-------+---------------+---------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>d. ref：使用非唯一索引扫描或者唯一索引的前缀扫描，返回匹配某个单独值的记录行</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select * from t1 where name='yayun';
+----+-------------+-------+------+---------------+------+---------+-------+------+-------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref   | rows | Extra       |
+----+-------------+-------+------+---------------+------+---------+-------+------+-------------+
|  1 | SIMPLE      | t1    | ref  | name          | name | 63      | const |    1 | Using where |
+----+-------------+-------+------+---------------+------+---------+-------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>e. eq_ref：类似ref，区别就在使用的索引是唯一索引，对于每个索引键值，表中只有一条记录匹配，简单来说，就是多表连接中使用primary key或者 unique key作为关联条件</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select t1.name from t1, t2 where t1.id=t2.id;
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
| id | select_type | table | type   | possible_keys | key     | key_len | ref        | rows | Extra       |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
|  1 | SIMPLE      | t1    | index  | PRIMARY       | name    | 63      | NULL       |    4 | Using index |
|  1 | SIMPLE      | t2    | eq_ref | PRIMARY       | PRIMARY | 4       | test.t1.id |    1 | Using index |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
2 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>f. const、system：当MySQL对查询某部分进行优化，并转换为一个常量时，使用这些类型访问。如将主键置于where列表中，MySQL就能将该查询转换为一个常量</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select * from ( select * from t1 where id=1)b1;
+----+-------------+------------+--------+---------------+---------+---------+------+------+-------+
| id | select_type | table      | type   | possible_keys | key     | key_len | ref  | rows | Extra |
+----+-------------+------------+--------+---------------+---------+---------+------+------+-------+
|  1 | PRIMARY     | &lt;derived2&gt; | system | NULL          | NULL    | NULL    | NULL |    1 |       |
|  2 | DERIVED     | t1         | const  | PRIMARY       | PRIMARY | 4       |      |    1 |       |
+----+-------------+------------+--------+---------------+---------+---------+------+------+-------+
2 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>注：system是const类型的特例，当查询的表只有一行的情况下，使用system</strong></p>
<p><strong>g. NULL：MySQL在优化过程中分解语句，执行时甚至不用访问表或索引，例如从一个索引列里选取最小值可以通过单独索引查找完成。</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select * from t1 where id = (select min(id) from t2);
+----+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref   | rows | Extra                        |
+----+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+
|  1 | PRIMARY     | t1    | const | PRIMARY       | PRIMARY | 4       | const |    1 |                              |
|  2 | SUBQUERY    | NULL  | NULL  | NULL          | NULL    | NULL    | NULL  | NULL | Select tables optimized away |
+----+-------------+-------+-------+---------------+---------+---------+-------+------+------------------------------+
2 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>4. possible_keys</strong><br /><strong>指出MySQL能使用哪个索引在表中找到记录，查询涉及到的字段上若存在索引，则该索引将被列出，但不一定被查询使用</strong></p>
<p><br /><strong>5. key</strong><br /><strong>显示MySQL在查询中实际使用的索引，若没有使用索引，显示为NULL</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select id,age from t1;
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>6. key_len</strong><br /><strong>表示索引中使用的字节数，可通过该列计算查询中使用的索引的长度（key_len显示的值为索引字段的最大可能长度，并非实际使用长度，即key_len是根据表定义计算而得，不是通过表内检索出的）</strong></p>
<p><strong>7. ref<br />表示上述表的连接匹配条件，即哪些列或常量被用于查找索引列上的值</strong></p>
<p><strong>8. rows<br />表示MySQL根据表统计信息及索引选用情况，估算的找到所需的记录所需</strong><strong>要读取的行数</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select * from t1 , t2 where t1.id=t2.id and t2.name='atlas';
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
| id | select_type | table | type   | possible_keys | key     | key_len | ref        | rows | Extra       |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
|  1 | SIMPLE      | t2    | ref    | PRIMARY,name  | name    | 63      | const      |    1 | Using where |
|  1 | SIMPLE      | t1    | eq_ref | PRIMARY       | PRIMARY | 4       | test.t2.id |    1 |             |
+----+-------------+-------+--------+---------------+---------+---------+------------+------+-------------+
2 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>9. Extra</strong><br /><strong>包含不适合在其他列中显示但十分重要的额外信息</strong><br /><strong>a. Using index</strong><br /><strong>该值表示相应的select操作中使用了覆盖索引（Covering Index）</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select id from t1;
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>覆盖索引（Covering Index）</strong><br /><strong>MySQL可以利用索引返回select列表中的字段，而不必根据索引再次读取数据文件</strong><br /><strong>包含所有满足查询需要的数据的索引称为覆盖索引（Covering Index）</strong><br /><strong>注意：如果要使用覆盖索引，一定要注意select列表中只取出需要的列，不可select *，因为如果将所有字段一起做索引会导致索引文件过大，查询性能下降</strong></p>
<p><strong>b. Using where<br />表示mysql服务器将在存储引擎检索行后再进行过滤。许多where条件里涉及索引中的列，当（并且如果）它读取索引时，就能被存储引擎检验，因此不是所有带where字句的查询都会显示"Using where"。有时"Using where"的出现就是一个暗示：查询可受益与不同的索引。</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select id,name from t1 where id&lt;4;
+----+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+
| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra                    |
+----+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+
|  1 | SIMPLE      | t1    | index | PRIMARY       | name | 63      | NULL |    4 | Using where; Using index |
+----+-------------+-------+-------+---------------+------+---------+------+------+--------------------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>c. Using temporary</strong><br /><strong>表示MySQL需要使用临时表来存储结果集，常见于排序和分组查询</strong></p>
<p><strong>这个值表示使用了内部临时(基于内存的)表。一个查询可能用到多个临时表。有很多原因都会导致MySQL在执行查询期间创建临时表。两个常见的原因是在来自不同表的上使用了DISTINCT,或者使用了不同的ORDER BY和GROUP BY列。可以强制指定一个临时表使用基于磁盘的MyISAM存储引擎。这样做的原因主要有两个：</strong><br /><strong>1)内部临时表占用的空间超过min(tmp_table_size，max_heap_table_size)系统变量的限制</strong><br /><strong>2)使用了TEXT/BLOB 列</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select id from t1 where id in (1,2) group by age,name;
+----+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+
| id | select_type | table | type  | possible_keys | key     | key_len | ref  | rows | Extra                                        |
+----+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+
|  1 | SIMPLE      | t1    | range | PRIMARY       | PRIMARY | 4       | NULL |    2 | Using where; Using temporary; Using filesort |
+----+-------------+-------+-------+---------------+---------+---------+------+------+----------------------------------------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>d. Using filesort</strong><br /><strong>MySQL中无法利用索引完成的排序操作称为&ldquo;文件排序&rdquo;</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select id,age from t1 order by name; 
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra          |
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
|  1 | SIMPLE      | t1    | ALL  | NULL          | NULL | NULL    | NULL |    4 | Using filesort |
+----+-------------+-------+------+---------------+------+---------+------+------+----------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;explain select id,age from t1 order by age; 
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
| id | select_type | table | type  | possible_keys | key  | key_len | ref  | rows | Extra       |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
|  1 | SIMPLE      | t1    | index | NULL          | age  | 5       | NULL |    4 | Using index |
+----+-------------+-------+-------+---------------+------+---------+------+------+-------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>e. Using join buffer</strong><br /><strong>改值强调了在获取连接条件时没有使用索引，并且需要连接缓冲区来存储中间结果。如果出现了这个值，那应该注意，根据查询的具体情况可能需要添加索引来改进</strong><strong>能。</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select t1.name from t1 inner join t2 on t1.name=t2.name;
+----+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+
| id | select_type | table | type  | possible_keys | key  | key_len | ref          | rows | Extra                    |
+----+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+
|  1 | SIMPLE      | t1    | index | name          | name | 63      | NULL         |    4 | Using index              |
|  1 | SIMPLE      | t2    | ref   | name          | name | 63      | test.t1.name |    2 | Using where; Using index |
+----+-------------+-------+-------+---------------+------+---------+--------------+------+--------------------------+
2 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;alter table t1 drop key name;                                   
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

(root@yayun-mysql-server) [test]&gt;alter table t2 drop key name; 
Query OK, 0 rows affected (0.02 sec)
Records: 0  Duplicates: 0  Warnings: 0

(root@yayun-mysql-server) [test]&gt;explain select t1.name from t1 inner join t2 on t1.name=t2.name;
+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra                          |
+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+
|  1 | SIMPLE      | t1    | ALL  | NULL          | NULL | NULL    | NULL |    4 |                                |
|  1 | SIMPLE      | t2    | ALL  | NULL          | NULL | NULL    | NULL |    4 | Using where; Using join buffer |
+----+-------------+-------+------+---------------+------+---------+------+------+--------------------------------+
2 rows in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>f. Impossible where</strong><br /><strong>这个值强调了where语句会导致没有符合条件的行。</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;EXPLAIN SELECT * FROM t1 WHERE 1=2;
+----+-------------+-------+------+---------------+------+---------+------+------+------------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra            |
+----+-------------+-------+------+---------------+------+---------+------+------+------------------+
|  1 | SIMPLE      | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | Impossible WHERE |
+----+-------------+-------+------+---------------+------+---------+------+------+------------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>h. Select tables optimized away</strong><br /><strong>这个值意味着仅通过使用索引，优化器可能仅从聚合函数结果中返回一行.</strong></p>
<p><strong>Example</strong></p>
<div class="cnblogs_code">
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
<pre>(root@yayun-mysql-server) [test]&gt;explain select max(id) from t1;
+----+-------------+-------+------+---------------+------+---------+------+------+------------------------------+
| id | select_type | table | type | possible_keys | key  | key_len | ref  | rows | Extra                        |
+----+-------------+-------+------+---------------+------+---------+------+------+------------------------------+
|  1 | SIMPLE      | NULL  | NULL | NULL          | NULL | NULL    | NULL | NULL | Select tables optimized away |
+----+-------------+-------+------+---------------+------+---------+------+------+------------------------------+
1 row in set (0.00 sec)

(root@yayun-mysql-server) [test]&gt;</pre>
<div class="cnblogs_code_toolbar"><span class="cnblogs_code_copy"><a title="复制代码"><img src="https://common.cnblogs.com/images/copycode.gif" alt="复制代码" /></a></span></div>
</div>
<p><strong>I. Index merges</strong><br /><strong>当MySQL 决定要在一个给定的表上使用超过一个索引的时候，就会出现以下格式中的一个，详细说明使用的索引以及合并的类型。</strong><br /><strong>Using sort_union(...)</strong><br /><strong>Using union(...)</strong><br /><strong>Using intersect(...)</strong></p>
<p>&nbsp;</p>
<p><strong>总结：</strong><strong><br />&bull; EXPLAIN不会告诉你关于触发器、存储过程的信息或用户自定义函数对查询的影响情况<br />&bull; EXPLAIN不考虑各种Cache<br />&bull; EXPLAIN不能显示MySQL在执行查询时所作的优化工作<br />&bull; 部分统计信息是估算的，并非精确值<br />&bull; EXPALIN只能解释SELECT操作，其他操作要重写为SELECT后查看执行计划。</strong></p>


</div>


</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>接口控制类模型描述用户接口与系统其他层之间的通信，接口控制类位于系统结构的商业上下文服务层，接口控制类模型用类图和包图描述。首先简要介绍接口控制类模型的设计方法，然后设计子系统的接口控制类与接口类的类图，最后设计系统及子系统的接口控制类的包图。</p>
<p>　　<strong>1、设计方法</strong></p>
<p><strong>　　</strong>接口控制类承担用户接口与应用程序的其他层之间通信的大多数工作，接口控制类比较简单，对于每一个需要与应用程序的其他层进行通信的用户接口，都应该有一个相应的接口控制类，对应的一个接口类即定义一个接口控制类。接口控制类通常是临时的，不用保存在外部存储器中，其生命周期在交互完成时结束。为使类之间的交互简捷、明了，接口控制类只与接口类、用例控制类有关系，接口控制类之间不应该有关系，接口类依赖接口控制类，而接口控制类又依赖用例控制类。接口控制类的操作和属性可以在设计序列图时定义，也可以在实现阶段设计程序代码时定义。</p>
<p>　　<strong>2、类图</strong></p>
<p><strong>　　</strong>前一篇文章<a href="http://www.cnblogs.com/hnlshzx/p/3485918.html">&ldquo;软件工程之系统建模篇【设计接口类模型】&rdquo;</a>已经定义了发文办理接口类，这里我们依然以前一篇文章的发文办理流程来定义接口控制类，我们分别对接口类定义接口控制类，但是不直接与应用程序的其他层通信的类，则不需要定义接口控制类。由于接口控制类之间不存在关系，类图应该反映接口控制类和接口类之间的关系。发文办理接口控制类包括：UICSFileList、UICDraftSFile、UICAuditSFileList、UICAuditSFile、UICCheckSFileList、UICCheckSFile、UICSignSFileList、UICSignSFile、UICEnreSFileList、UICEnreSFile、UICSendSFile,下图为发文办理接口控制类和接口类的类图，在图中区别有两个类型的类，接口控制类的名称用斜体字显示。<img src="https://img2018.cnblogs.com/blog/1515898/201811/1515898-20181122150345729-736756167.png" alt="" /></p>
<p><strong>3、包图</strong></p>
<p>　　我们将系统实例的接口控制类从系统层划分为8个包，分别为发文办理接口控制类包UICSFilePack、收文办理接口控制类包UICRFilePack、会议管理接口控制类包UICMeetingPack、档案管理接口控制类包UICArchivePack、公告管理接口控制类包UICNoticePack、个人助理接口控制类包UICAssistantPack、系统管理接口控制类包UICSSystemPack、用户登录接口控制类UICLogin。</p>
<p><img src="https://img2018.cnblogs.com/blog/1515898/201811/1515898-20181122150438112-1030922529.png" alt="" /></p>
<p>我们将发文办理子系统的接口控制类，进一步划分为6个包：草拟发文接口控制类包UICDraftSFilePack、审核发文接口控制类包UICAuditSFilePack、复核发文接口控制类包UICCheckSFilePack、签发发文接口控制类包UICSignSFilePack、分发发文接口控制类包UICEnreSFilePack和送发文至档案室接口控制类包UICSendSFilePack。</p>
<p><img src="https://img2018.cnblogs.com/blog/1515898/201811/1515898-20181122150510258-1128716969.png" alt="" /></p>
<p>至此发文办理流程中的每一个用户接口，都对应一个接口控制类，下一章我们将介绍设计用例控制类模型。</p>
<p>&nbsp;</p>
<p>UPDATE</p>
<p>tab1&nbsp; &nbsp;a INNER JOIN tab_game_version as b ON a.id=b.id</p>
<p>SET a.advert_data=0</p>
<p>where a.advert_data is NULL</p>
<p>&nbsp;</p>
<p>sql server&nbsp;</p>
<p>&nbsp;update tab set&nbsp; f =&nbsp; 1 from&nbsp; xxxxxxxxx</p>
<p>xxxxxxxxxx&nbsp;</p>
<p>where&nbsp;</p>
<h3>web服务交互</h3>
<div class="postBody">
<div id="cnblogs_post_body" class="blogpost-body">
<p>　　　　我们在浏览器中能看到的每个网站，都是一个web服务。那么我们在提供每个web服务的时候，</p>
<p>　　都需要前后端交互，前后端交互就一定有一些实现方案，我们通常叫web服务交互方案。</p>
<p>　　目前主流的三种web服务交互方案：</p>
<p>　　　　-- REST （&nbsp;Representational State Transfer）表述性状态转移</p>
<p>　　　　-- SOAP （Simple Object Access Protocol）&nbsp; 简单的对象访问协议</p>
<p>　　　　--&nbsp;XML-RPC （XML Remote Procedure Call）基于XML的远程过程调用</p>
<p>　　XML-RPC是通过XML将调用函数封装，并使用HTTP协议作为传送机制。</p>
<p>　　后来在新的功能不断被引入下，这个标准慢慢演变成为今日的SOAP协定。</p>
<p>　　SOAP服务则是以本身所定义的操作集，来访问网络上的资源。</p>
<p>　　SOAP也是基于XML的，但是它不只限于HTTP协议的传输，包括TCP协议，UDP协议都可以传输。</p>
<p>　　REST是Roy Thomas Fielding<span class="ilh-all" data-orig-title="Roy Thomas Fielding" data-lang-code="en" data-lang-name="英语" data-foreign-title="Roy Thomas Fielding">博士于2000年在他的博士论文里提出来的。</span></p>
<p><span class="ilh-all" data-orig-title="Roy Thomas Fielding" data-lang-code="en" data-lang-name="英语" data-foreign-title="Roy Thomas Fielding">　　REST相比SOAP更加简洁，性能和开发效率也有突出的优势。</span></p>
<p>　　我们今天主要说一下这个REST，现在越来越多的web服务开始采用REST风格设计和实现。</p>
<p>　　例如，amazon.com提供接近REST风格的Web服务进行图书查找；雅虎提供的Web服务也是REST风格的。</p>
<p>　　我们接下来要学的框架也是遵循REST风格的，那么我们来看下它到底是个什么样的风格，</p>
<p>　　了解了它是什么后，我们看下它的优点是什么，我们为什么用它。</p>
<h3>理解REST</h3>
<p>　　　　如果我们想要理解restful，就要理解Representational State Transfer这个词组的意思，表征性状态转移。</p>
<p>　　这里所说的表征性，其实指的就是资源。通常我们称为资源状态转移。</p>
<h4>什么是资源</h4>
<p>　　　　任何事物，只要有被引用到的必要，它就是一个资源。</p>
<p>　　我们在浏览器中看到的文本，视频，图片等等都是资源。这些都是实实在在存在的实体。</p>
<p>　　资源可以是一个实体，也可以是抽象概念。</p>
<p>　　比如说吧：</p>
<p>　　　　-- Alex的个人信息</p>
<p>　　　　-- 沛齐的手机号</p>
<p>　　　　-- Alex跟沛齐的潜在关系</p>
<p>　　　　这些都是资源，可以是实体比如个人信息，手机号。也可以是抽象的概念，比如两个人的关系......</p>
<p>　　那么在我们的网络中，我们要引用资源，资源一定要有一个标识，在web中的唯一标识就是URI，</p>
<p>　　URI我们不常听说，我们经常用URL，那么两者区别是什么呢~</p>
<h4>什么是URI，URL</h4>
<p>　　URI 统一资源标志符。</p>
<p>　　URL 统一资源定位符。</p>
<p>　　URI是给我们的资源进行标识的，URL是描述我们资源地址的。</p>
<p>　　比如说我们每个人都有名字和身份证，名字可能重名，但是身份证是唯一的，</p>
<p>　　那么身份证号就可以是我们的URI，标识我们每个人，也可以说标识我们每个资源。</p>
<p>　　我们可以通过身份证号找到Alex，也可以通过下面这种方式找到他.....</p>
<p>　　Alex的住址协议://地球/中国/屌丝省/屌丝市/寡妇村/250号街道/250号/Alex</p>
<p>　　这个就是我们的URL，我们通过这两种方式都可以找到我们的资源，</p>
<p>　　其实我们的URL可以说是URI的子集，通过定位的方式实现的URI。</p>
<p>　　这是我们资源的定位~~有了资源的地址后，我们要去访问资源，那么我们要通过什么方式去访问呢~~</p>
<h4>统一资源接口</h4>
<p>　　　　现在我们可以通过URL去访问到资源，那么我们对资源会有很多不同的操作，增删改查，</p>
<p>　　以前我们可能会为了这个增加新设计一个URL，然后这个URL就是对数据进行增加的，</p>
<p>　　还会为了更新和删除分别设计一个URL，现在我们不用了，我们只有一个URL，</p>
<p>　　然后根据HTTP请求方式的不同，对资源进行不同的操作，这个就是是统一资源接口。</p>
<p>　　我们一定要遵循HTTP请求方法的语义，也就是说POST请求就在新增数据等....</p>
<h4>资源的表述</h4>
<p>　　　　资源的表述其实就是资源的展现形式，我们客户端和服务端传输的都是资源的表述，而不是资源本身。</p>
<p>　　例如文本资源可以采用html、xml、json等格式，图片可以使用PNG或JPG展现出来。</p>
<p>　　那么客户端如何知道服务端提供哪种表述形式呢?</p>
<p>　　可以通过HTTP内容协商，客户端可以通过Accept头请求一种特定格式的表述，服务端则通过Content-Type告诉客户端资源的表述形式。</p>
<p>　　这些资源的表述呈现在页面上，就是我们说的资源状态。</p>
<h4>状态转移</h4>
<p>　　　　我们在看页面的时候，从当前资源的表述(也可以说状态或者表现层)会跳转到其他的资源状态。</p>
<p>　　服务端通过超媒体告诉客户端当前状态有哪些后续状态可以进入。</p>
<p>　　这些类似"下一页"之类的链接起的就是这种推进状态的作用&mdash;&mdash;指引你如何从当前状态进入下一个可能的状态。</p>
<h4>总结　</h4>
<p>　　　　可以得知REST风格的特点如下：</p>
<p>　　（1）在web中，只要有被引用的必要都叫资源。</p>
<p>　　（2）每个URI代表一个资源，独一无二的。</p>
<p>　　（3）客户端通过HTTP的方法，对服务器端资源进行操作；</p>
<p>　　（4）客户端和服务器之间，传递这种资源的某种表现层；</p>
<p>　　（5）通过超链接的指引，实现"表现层状态转移"。</p>
<h3>RESTful&nbsp;　</h3>
<p>　　　　如果一个架构符合REST的约束条件和原则，我们就称它为RESTful架构。</p>
<p>　　　　一种软件的架构风格，设计风格,&nbsp; 为客户端和服务端的交互提供一组设计原则和约束条件。</p>
<h3>restful规范</h3>
<h4>一&nbsp; 面向资源编程</h4>
<p>　　每个URL代表一种资源，URL中尽量不要用动词，要用名词。</p>
<h4>二&nbsp; 根据method不同，进行不同的操作</h4>
<p>　　GET/POST/PUT/DELETE/PATCH</p>
<h4>三&nbsp; 在URL中体现版本</h4>
<p>　　https://www.bootcss.com/v1/mycss</p>
<p>　　https://v1.bootcss.com/mycss</p>
<h4>四&nbsp; 在URL中体现是否是API</h4>
<p>　　https://www.bootcss.com/api/mycss</p>
<p>　　https://api.bootcss.com/mycss</p>
<h4>五&nbsp; 在URL中的过滤条件</h4>
<p>　　https://www.bootcss.com/v1/mycss？page=3</p>
<h4>六&nbsp; 尽量使用HTTPS</h4>
<p>　　https://www.bootcss.com/v1/mycss</p>
<h4>七&nbsp; 响应时设置状态码</h4>
<p>　　1**&nbsp; &nbsp;信息，服务器收到请求，需要请求者继续执行操作</p>
<p>　　2**&nbsp;&nbsp;成功，操作被成功接收并处理</p>
<p>　　3**&nbsp;&nbsp;重定向，需要进一步的操作以完成请求</p>
<p>　　4**&nbsp;&nbsp;客户端错误，请求包含语法错误或无法完成请求</p>
<p>　　5**&nbsp;&nbsp;服务器错误，服务器在处理请求的过程中发生了错误</p>
<h4>八&nbsp; 返回值</h4>
<p>　　GET请求 返回查到所有或单条数据</p>
<p>　　POST请求&nbsp; 返回新增的数据</p>
<p>　　PUT请求&nbsp; 返回更新数据</p>
<p>　　PATCH请求&nbsp; 局部更新&nbsp; 返回更新整条数据</p>
<p>　　DELETE请求&nbsp; 返回值为空</p>
<h4>九&nbsp; 返回错误信息</h4>
<p>　　返回值携带错误信息</p>
<h4>十&nbsp; &nbsp;Hypermedia API</h4>
<p>　　如果遇到需要跳转的情况 携带调转接口的URL</p>
<div>
<div>　　ret = {</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;code: 1000,</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;data:{</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;id:1,</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name:'小强',</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;depart_id:http://www.luffycity.com/api/v1/depart/8/</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div>
<div>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</div>
</div>
</div>
</div>
<h1 class="postTitle"><a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/hellojesson/p/5961570.html">Python终端如何输出彩色字体</a></h1>
<div class="clear">&nbsp;</div>
<div class="postBody">
<div id="cnblogs_post_body" class="blogpost-body">
<div><strong>实现过程：</strong></div>
<div>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;终端的字符颜色是用转义序列控制的，是文本模式下的系统显示功能，和具体的语言无关。</div>
<div>&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;转义序列是以ESC开头,即用\033来完成（ESC的ASCII码用十进制表示是27，用八进制表示就是033）。</div>
<div>&nbsp;</div>
<div><strong><span data-wiz-span="data-wiz-span">书写格式：<span data-wiz-span="data-wiz-span"><br /></span></span></strong><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; &nbsp;<strong><span data-wiz-span="data-wiz-span">开头部分</span></strong><span data-wiz-span="data-wiz-span">：<span data-wiz-span="data-wiz-span">\033[显示方式;前景色;背景色m +&nbsp;<span data-wiz-span="data-wiz-span"><strong><span data-wiz-span="data-wiz-span">结尾部分：</span></strong><span data-wiz-span="data-wiz-span">\033[0m</span></span></span></span></span></div>
<div><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; &nbsp;注意：开头部分的三个参数：显示方式，前景色，背景色是可选参数，可以只写其中的某一个；另外由于表示三个参数不同含义的数值都是唯一的没有重复的，所以三个参数的书写先后顺序没有固定要求，系统都能识别；但是，建议按照默认的格式规范书写。</span></div>
<div><span data-wiz-span="data-wiz-span">&nbsp; &nbsp; &nbsp;对于结尾部分，其实也可以省略，但是为了书写规范，建议\033[***开头，\033[0m结尾。</span></div>
<div>&nbsp;</div>
<div><strong>数值表示的参数含义：</strong></div>
<div><span data-wiz-span="data-wiz-span"><strong>显示方式:</strong>&nbsp;0（默认值）、1（高亮）、22（非粗体）、4（下划线）、24（非下划线）、 5（闪烁）、25（非闪烁）、7（反显）、27（非反显）<span data-wiz-span="data-wiz-span"><br /><span data-wiz-span="data-wiz-span"><strong>前景色:</strong>&nbsp;30（黑色）、31<span data-wiz-span="data-wiz-span">（红色）<span data-wiz-span="data-wiz-span">、32<span data-wiz-span="data-wiz-span">（绿色）<span data-wiz-span="data-wiz-span">、 33<span data-wiz-span="data-wiz-span">（黄色）<span data-wiz-span="data-wiz-span">、34<span data-wiz-span="data-wiz-span">（蓝色）<span data-wiz-span="data-wiz-span">、35<span data-wiz-span="data-wiz-span">（洋 红）<span data-wiz-span="data-wiz-span">、36<span data-wiz-span="data-wiz-span">（青色）<span data-wiz-span="data-wiz-span">、37（白色）<span data-wiz-span="data-wiz-span"><br /><span data-wiz-span="data-wiz-span"><strong>背景色:</strong>&nbsp;40<span data-wiz-span="data-wiz-span">（黑色）<span data-wiz-span="data-wiz-span">、41<span data-wiz-span="data-wiz-span">（红色）<span data-wiz-span="data-wiz-span">、42<span data-wiz-span="data-wiz-span">（绿色）<span data-wiz-span="data-wiz-span">、 43<span data-wiz-span="data-wiz-span">（黄色）<span data-wiz-span="data-wiz-span">、44<span data-wiz-span="data-wiz-span">（蓝色）<span data-wiz-span="data-wiz-span">、45<span data-wiz-span="data-wiz-span">（洋 红）<span data-wiz-span="data-wiz-span">、46<span data-wiz-span="data-wiz-span">（青色）<span data-wiz-span="data-wiz-span">、47（白色）</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></div>
<div><span data-wiz-span="data-wiz-span"><br /><strong><span data-wiz-span="data-wiz-span">常见开头格式</span></strong><span data-wiz-span="data-wiz-span">：<span data-wiz-span="data-wiz-span"><br /><span data-wiz-span="data-wiz-span">\033[0m &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;默认字体正常显示，不高亮<span data-wiz-span="data-wiz-span"><br /><span data-wiz-span="data-wiz-span">\033[32;0m &nbsp; &nbsp; &nbsp; 红色字体正常显示<span data-wiz-span="data-wiz-span"><br /><span data-wiz-span="data-wiz-span">\033[1;32;40m &nbsp;显示方式: 高亮 &nbsp; &nbsp;字体前景色：绿色 &nbsp;背景色：黑色<span data-wiz-span="data-wiz-span"><br /><span data-wiz-span="data-wiz-span">\033[0;31;46m &nbsp;显示方式: 正常 &nbsp; &nbsp;字体前景色：红色 &nbsp;背景色：青色</span></span></span></span></span></span></span></span></span></span></div>
<div>&nbsp;</div>
<div><strong>实例：</strong></div>
<div>
<div><span data-wiz-span="data-wiz-span">　　(1)<span data-wiz-span="data-wiz-span">print<span data-wiz-span="data-wiz-span">(<span data-wiz-span="data-wiz-span">"<span data-wiz-span="data-wiz-span">\033<span data-wiz-span="data-wiz-span">[1;31;40m您输入的帐号或密码错误！<span data-wiz-span="data-wiz-span">\033<span data-wiz-span="data-wiz-span">[0m"<span data-wiz-span="data-wiz-span">) &nbsp;</span></span></span></span></span></span></span></span></span></div>
<div><span data-wiz-span="data-wiz-span">　　上方代码的输出格式为：<span data-wiz-span="data-wiz-span">字体高亮，红色前景，黄色背景 &nbsp; &nbsp; &nbsp;PS：前景色也就是字体的颜色<span data-wiz-span="data-wiz-span"><span data-wiz-span="data-wiz-span"><br />　　<img src="https://images2015.cnblogs.com/blog/575577/201610/575577-20161014181934500-70961015.png" alt="" border="0" /></span></span></span></span></div>

</div>
<div>　　(2)print("\033[0;31m%s\033[0m" % "输出红色字符")<span data-wiz-span="data-wiz-span"><br /></span></div>
<div>　　#上方代码的输出格式为：<span data-wiz-span="data-wiz-span">字体默认，红色前景</span></div>
<div>　　<img src="https://images2015.cnblogs.com/blog/575577/201610/575577-20161014181934875-89903123.png" alt="" border="0" /></div>

</div>

</div>
<p>获取APK的classes.dex：打包得到APK文件，将扩展名改为rar，使用解压工具解压即可得到，将其拷贝到dex2jar的目录，例如：</p>
<p><img src="https://img2018.cnblogs.com/blog/749718/201811/749718-20181122150532186-1255293483.png" alt="" /></p>
<p>&nbsp;</p>
<p><br />打开命令窗口进入dex2jar目录,键入dex2jar命令（我的此命令文件大家可以看到是d2j-dex2jar.bat）,回车即可。</p>
<p><img src="https://img2018.cnblogs.com/blog/749718/201811/749718-20181122150546267-1699488358.png" alt="" /></p>
<p><img id="uploading_image_17548" src="https://common.cnblogs.com/images/loading.gif" alt="" /></p>
<p>&nbsp;</p>
<p><br />查看结果，打开jd-gui,在其中打开上一步生成的classes-dex2jar.jar文件。</p>
<p><img src="https://img2018.cnblogs.com/blog/749718/201811/749718-20181122150605600-1732474897.png" alt="" /></p>
<p>&nbsp;</p>
<p>在大型分布式系统中，定会存在大量并发写入的场景。在这种场景下如何进行更好的并发控制，即在多个任务同时存取数据时保证数据的一致性，成为分布式系统必须解决的问题。<br />悲观并发控制和乐观并发控制是并发控制中采用的主要技术手段，对于不同的业务场景，应该选择不同的控制方法。<br />悲观锁<br />悲观并发控制（又名&ldquo;悲观锁&rdquo;，Pessimistic Concurrency Control，缩写&ldquo;PCC&rdquo;）是一种并发控制的方法。它可以阻止一个事务以影响其他用户的方式来修改数据。如果一个事务执行的操作读某行数据应用了锁，那只有当这个事务把锁释放，其他事务才能够执行与该锁冲突的操作。<br />在悲观锁的场景下，假设用户A和B要修改同一个文件，A在锁定文件并且修改的过程中，B是无法修改这个文件的，只有等到A修改完成，并且释放锁以后，B才可以获取锁，然后修改文件。由此可以看出，悲观锁对并发的控制持悲观态度，它在进行任何修改前，首先会为其加锁，确保整个修改过程中不会出现冲突，从而有效的保证数据一致性。但这样的机制同时降低了系统的并发性，尤其是两个同时修改的对象本身不存在冲突的情况。同时也可能在竞争锁的时候出现死锁，所以现在很多的系统例如Kubernetes采用了乐观并发的控制方法。<br />乐观锁<br />乐观并发控制（又名&ldquo;乐观锁&rdquo;，Optimistic Concurrency Control，缩写&ldquo;OCC&rdquo;）是一种并发控制的方法。它假设多用户并发的事务在处理时不会彼此影响，各事务能够在不请求锁的情况下处理各自的数据。在提交数据更新之前，每个事务会先检查在该事务读取数据后，有没有其他事务又修改了该数据。如果其他事务有更新的话，正在提交的事务会进行回滚。<br />相对于悲观锁对锁的提前控制，乐观锁相信请求之间出现冲突的概率是比较小的，在读取及更改的过程中都是不加锁的，只有在最后提交更新时才会检测冲突，因此在高并发量的系统中占有绝对优势。同样假设用户A和B要修改同一个文件，A和B会先将文件获取到本地，然后进行修改。如果A已经修改好并且将数据提交，此时B再提交，服务器端会告知B文件已经被修改，返回冲突错误。此时冲突必须由B来解决，可以将文件重新获取回来，再一次修改后提交。<br />乐观锁通常通过增加一个资源版本字段，来判断请求是否冲突。初始化时指定一个版本值，每次读取数据时将版本号一同读出，每次更新数据，同时也对版本号进行更新。当服务器端收到数据时，将数据中的版本号与服务器端的做对比，如果不一致，则说明数据已经被修改，返回冲突错误。<br />Kubernetes中的并发控制<br />在Kubernetes集群中，外部用户及内部组件频繁的数据更新操作，导致系统的数据并发读写量非常大。假设采用悲观并行的控制方法，将严重损耗集群性能，因此Kubernetes采用乐观并行的控制方法。Kubernetes通过定义资源版本字段实现了乐观并发控制，资源版本(ResourceVersion)字段包含在Kubernetes对象的元数据(Metadata)中。这个字符串格式的字段标识了对象的内部版本号，其取值来自etcd的modifiedindex，且当对象被修改时，该字段将随之被修改。值得注意的是该字段由服务端维护，不建议在客户端进行修改。<br />type ObjectMeta struct {<br />      ......<br />      // An opaque value that represents the internal version of this object   that can<br />      // be used by clients to determine when objects have changed. May be   used for optimistic<br />      // concurrency, change detection, and the watch operation on a   resource or set of resources.<br />      // Clients must treat these values as opaque and passed unmodified   back to the server.<br />      // They may only be valid for a particular resource or set of   resources.<br />      //<br />      // Populated by the system.<br />      // Read-only.<br />      // Value must be treated as opaque by clients and .<br />      // More info:   https://git.k8s.io/community/contributors/devel/api-conventions.md#concurrency-control-and-consistency<br />      // +optional<br />      ResourceVersion string<br />      ......<br />}<br />Kube-Apiserver可以通过该字段判断对象是否已经被修改。当包含ResourceVersion的更新请求到达Apiserver，服务器端将对比请求数据与服务器中数据的资源版本号，如果不一致，则表明在本次更新提交时，服务端对象已被修改，此时Apiserver将返回冲突错误(409)，客户端需重新获取服务端数据，重新修改后再次提交到服务器端。上述并行控制方法可防止如下的data race：<br />Client #1: GET Foo<br />Client #2: GET Foo<br />Client #1: Set Foo.Bar =   "one"<br />Client #1: PUT Foo<br />Client #2: Set Foo.Baz =   "two"<br />Client #2: PUT Foo<br />当未采用并发控制时，假设发生如上请求序列，两个客户端同时从服务端获取同一对象Foo(含有Bar、Baz两个字段)，Client#1先将Bar字段置成one，其后Client#2对Baz字段赋值的更新请求到服务端时，将覆盖Client#1对Bar的修改。反之在对象中添加资源版本字段，同样的请求序列将如下：<br />Client #1: GET Foo  //初始Foo.ResourceVersion=1<br />Client #2: GET Foo  //初始Foo.ResourceVersion=1<br />Client #1: Set Foo.Bar =   "one"<br />Client #1: PUT Foo  //更新Foo.ResourceVersion=2<br />Client #2: Set Foo.Baz =   "two"<br />Client #2: PUT Foo  //返回409冲突<br />Client#1更新对象后资源版本号将改变，Client#2在更新提交时将返回冲突错误(409)，此时Client#2必须在本地重新获取数据，更新后再提交到服务端。<br />假设更新请求的对象中未设置ResourceVersion值，Kubernetes将会根据硬改写策略(可配置)决定是否进行硬更新。如果配置为可硬改写，则数据将直接更新并存入Etcd，反之则返回错误，提示用户必须指定ResourceVersion。<br />Kubernetes中的Update和Patch<br />Kubernetes实现了Update和Patch两个对象更新的方法，两者提供不同的更新操作方式，但冲突判断机制是相同的。<br />Update<br />对于Update，客户端更新请求中包含的是整个obj对象，服务器端将对比该请求中的obj对象和服务器端最新obj对象的ResourceVersion值。如果相等，则表明未发生冲突，将成功更新整个对象。反之若不相等则返回409冲突错误，Kube-Apiserver中冲突判断的代码片段如下。<br />e.Storage.GuaranteedUpdate(ctx,   key...) (runtime.Object, *uint64, error) {<br />              //   If AllowUnconditionalUpdate() is true and the object specified by<br />              //   the user does not have a resource version, then we populate it with<br />              //   the latest version. Else, we check that the version specified by<br />              //   the user matches the version of latest storage object.<br />              resourceVersion,   err := e.Storage.Versioner().ObjectResourceVersion(obj)<br />              if   err != nil {<br />                     return   nil, nil, err<br />              }<br />                version, err :=   e.Storage.Versioner().ObjectResourceVersion(existing)<br />              doUnconditionalUpdate   := resourceVersion == 0 &amp;&amp; e.UpdateStrategy.AllowUnconditionalUpdate()     <br />              if   doUnconditionalUpdate {<br />                     //   Update the object's resource version to match the latest<br />                     //   storage object's resource version.<br />                     err   = e.Storage.Versioner().UpdateObject(obj, res.ResourceVersion)<br />                     if   err != nil {<br />                            return   nil, nil, err<br />                     }<br />              }   else {<br />                     //   Check if the object's resource version matches the latest<br />                     //   resource version.<br />                     ......<br />                     if   resourceVersion != version {<br />                            return   nil, nil, kubeerr.NewConflict(qualifiedResource, name,   fmt.Errorf(OptimisticLockErrorMsg))<br />                     }<br />              }<br />         ......<br />       return   out, creating, nil<br />}<br />基本流程为：<br />1. 获取当前更新请求中obj对象的ResourceVersion值，及服务器端最新obj对象(existing)的ResourceVersion值<br />2. 如果当前更新请求中obj对象的ResourceVersion值等于0，即客户端未设置该值，则判断是否要硬改写(AllowUnconditionalUpdate)，如配置为硬改写策略，将直接更新obj对象<br />3. 如果当前更新请求中obj对象的ResourceVersion值不等于0，则判断两个ResourceVersion值是否一致，不一致返回冲突错误(OptimisticLockErrorMsg)<br />Patch<br />相比Update请求包含整个obj对象，Patch请求实现了更细粒度的对象更新操作，其请求中只包含需要更新的字段。例如要更新pod中container的镜像，可使用如下命令：<br />kubectl patch pod my-pod -p   '{"spec":{"containers":[{"name":"my-container","image":"new-image"}]}}'<br />服务器端只收到以上的patch信息，然后通过如下代码将该patch更新到Etcd中。<br />func (p *patcher) patchResource(ctx   context.Context) (runtime.Object, error) {<br />       p.namespace   = request.NamespaceValue(ctx)<br />       switch   p.patchType {<br />       case   types.JSONPatchType, types.MergePatchType:<br />              p.mechanism   = &amp;jsonPatcher{patcher: p}<br />       case   types.StrategicMergePatchType:<br />              schemaReferenceObj,   err := p.unsafeConvertor.ConvertToVersion(p.restPatcher.New(),   p.kind.GroupVersion())<br />              if   err != nil {<br />                     return   nil, err<br />              }<br />              p.mechanism   = &amp;smpPatcher{patcher: p, schemaReferenceObj: schemaReferenceObj}<br />       default:<br />              return   nil, fmt.Errorf("%v: unimplemented patch type", p.patchType)<br />       }<br />       p.updatedObjectInfo   = rest.DefaultUpdatedObjectInfo(nil, p.applyPatch, p.applyAdmission)<br />       return   finishRequest(p.timeout, func() (runtime.Object, error) {<br />              updateObject,   _, updateErr := p.restPatcher.Update(ctx, p.name, p.updatedObjectInfo,   p.createValidation, p.updateValidation, false, p.options)<br />             return   updateObject, updateErr<br />       })<br />}<br />基本流程为：<br />1.首先判断patch的类型，根据类型选择相应的mechanism<br />2.利用DefaultUpdatedObjectInfo方法将applyPatch(应用Patch的方法)添加到admission chain的头部<br />3.最终还是调用上述Update方法执行更新操作<br />在步骤2中将applyPatch方法挂到admission chain的头部，与admission行为相似，applyPatch方法会将patch应用到最新获取的服务器端obj上，生成一个已更新的obj，再对该obj继续执行admission chain中的Admit与Validate。最终调用的还是update方法，因此冲突检测的机制与上述Update方法完全一致。<br />相比Update，Patch的主要优势在于客户端不必提供全量的obj对象信息。客户端只需以patch的方式提交要修改的字段信息，服务器端会将该patch数据应用到最新获取的obj中。省略了Client端获取、修改再提交全量obj的步骤，降低了数据被修改的风险，更大大减小了冲突概率。 由于Patch方法在传输效率及冲突概率上都占有绝对优势，目前Kubernetes中几乎所有更新操作都采用了Patch方法，我们在编写代码时也应该注意使用Patch方法。<br />附：<br />ResourceVersion字段在Kubernetes中除了用在上述并发控制机制外，还用在Kubernetes的list-watch机制中。Client端的list-watch分为两个步骤，先list取回所有对象，再以增量的方式watch后续对象。Client端在list取回所有对象后，将会把最新对象的ResourceVersion作为下一步watch操作的起点参数，也即Kube-Apiserver以收到的ResourceVersion为起始点返回后续数据，保证了list-watch中数据的连续性与完整性。</p>
<p><span style="font-size: 18pt;">划重点： </span></p>
<p><span style="font-size: 18pt;">　　显示游标对应于一个返回结果为多行多列的SELECT语句。</span></p>
<p><span style="font-size: 18pt;">应用场景：</span></p>
<p><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 在判断节点配置页面实现删除功能，例如删除执行次序=3的数据，那么就需要同步更新删除前次序为4和5的执行次序。</span></p>
<p><span style="font-size: 18pt;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src="https://img2018.cnblogs.com/blog/1456804/201811/1456804-20181122141626537-1823146030.png" alt="" /></span></p>
<p><span style="font-size: 18pt;">实现过程：</span></p>
<p><span style="font-size: 18pt;">　　1.前台：传递将要删除的数据的执行次序</span>　　</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> <span style="color: #000000;">                delJudge: function () {
</span><span style="color: #008080;"> 2</span>                     <span style="color: #0000ff;">var</span> that =<span style="color: #000000;"> modObj;
</span><span style="color: #008080;"> 3</span>                     <span style="color: #0000ff;">var</span> indexNo =<span style="color: #000000;"> [];
</span><span style="color: #008080;"> 4</span>                     <span style="color: #0000ff;">var</span> rows =<span style="color: #000000;"> that.uiStore.gvJudgeList.getCheckRows();
</span><span style="color: #008080;"> 5</span>                     <span style="color: #0000ff;">if</span> (rows.length == <span style="color: #800080;">0</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 6</span>                         alert(<span style="color: #800000;">"</span><span style="color: #800000;">至少选择一条数据!</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 7</span>                         <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;"> 9</span>                     <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">var</span> i = <span style="color: #800080;">0</span>; i &lt; rows.length; i++<span style="color: #000000;">) {
</span><span style="color: #008080;">10</span> <span style="color: #000000;">                        console.log(rows[i]);                        
</span><span style="color: #008080;">11</span> <span style="color: #000000;">                        indexNo.push(rows[i].INDEX_NO);                        
</span><span style="color: #008080;">12</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;">13</span>                     <span style="color: #0000ff;">var</span> param =<span style="color: #000000;"> {
</span><span style="color: #008080;">14</span>                         reqType: <span style="color: #800000;">"</span><span style="color: #800000;">delJudgeByNode</span><span style="color: #800000;">"</span><span style="color: #000000;">,
</span><span style="color: #008080;">15</span> <span style="color: #000000;">                        nodeID: that.dataStore.nodeID,
</span><span style="color: #008080;">16</span> <span style="color: #000000;">                        modelID: that.dataStore.modelID,
</span><span style="color: #008080;">17</span> <span style="color: #000000;">                        indexNo: indexNo.join(that.splitChar.splitStr1st)//被选中的多行数据的执行次序拼接成的字符串
</span><span style="color: #008080;">18</span> <span style="color: #000000;">                    }
</span><span style="color: #008080;">19</span> <span style="color: #000000;">                    that.ajaxDeal(that.dataStore.ajaxUrl, param, function (result) {
</span><span style="color: #008080;">20</span>                         alert(<span style="color: #800000;">"</span><span style="color: #800000;">删除成功</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">21</span>                         <span style="color: #008000;">//</span><span style="color: #008000;">重新加载数据</span>
<span style="color: #008080;">22</span> <span style="color: #000000;">                        that.loadJudgeList();
</span><span style="color: #008080;">23</span> <span style="color: #000000;">                    });
</span><span style="color: #008080;">24</span>                 }</pre>
</div>
<p>　　　<span style="font-size: 18pt;">2.AJAX层：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 2</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 删除当前节点的判断检查配置情况
</span><span style="color: #008080;"> 3</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 4</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;returns&gt;&lt;/returns&gt;</span>
<span style="color: #008080;"> 5</span>         <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">string</span><span style="color: #000000;"> delJudgeByNode()
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 7</span>             <span style="color: #0000ff;">var</span> nodeID = GetQueryString(<span style="color: #800000;">"</span><span style="color: #800000;">nodeID</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 8</span>             <span style="color: #0000ff;">var</span> modelID = GetQueryString(<span style="color: #800000;">"</span><span style="color: #800000;">modelID</span><span style="color: #800000;">"</span><span style="color: #000000;">);            
</span><span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">var</span> indexNo = GetQueryString(<span style="color: #800000;">"</span><span style="color: #800000;">indexNo</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">10</span> 
<span style="color: #008080;">11</span>             Dictionary&lt;<span style="color: #0000ff;">string</span>, <span style="color: #0000ff;">string</span>&gt; param = <span style="color: #0000ff;">new</span> Dictionary&lt;<span style="color: #0000ff;">string</span>, <span style="color: #0000ff;">string</span>&gt;<span style="color: #000000;">();
</span><span style="color: #008080;">12</span>             param.Add(<span style="color: #800000;">"</span><span style="color: #800000;">modelID</span><span style="color: #800000;">"</span><span style="color: #000000;">, modelID);
</span><span style="color: #008080;">13</span>             param.Add(<span style="color: #800000;">"</span><span style="color: #800000;">nodeID</span><span style="color: #800000;">"</span><span style="color: #000000;">, nodeID);           
</span><span style="color: #008080;">14</span> 
<span style="color: #008080;">15</span> <span style="color: #000000;">            FlowConfigService.GetService().delJudgeByNode(param, indexNo);
</span><span style="color: #008080;">16</span>             <span style="color: #0000ff;">return</span> <span style="color: #0000ff;">new</span>
<span style="color: #008080;">17</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">18</span>                 state = <span style="color: #800000;">"</span><span style="color: #800000;">ok</span><span style="color: #800000;">"</span><span style="color: #000000;">,
</span><span style="color: #008080;">19</span> <span style="color: #000000;">            }.ToJson();
</span><span style="color: #008080;">20</span>         }</pre>
</div>
<p>　　<span style="font-size: 18pt;">3.在Service层拆分执行次序字符串，循环取出需要删除的执行次序</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 2</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 删除当前节点的判断检查配置情况
</span><span style="color: #008080;"> 3</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 4</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="param"&gt;&lt;/param&gt;</span>
<span style="color: #008080;"> 5</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="indexNo"&gt;&lt;/param&gt;</span>
<span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> delJudgeByNode(Dictionary&lt;<span style="color: #0000ff;">string</span>, <span style="color: #0000ff;">string</span>&gt; param, <span style="color: #0000ff;">string</span><span style="color: #000000;"> indexNo)
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 8</span>             <span style="color: #0000ff;">var</span> indexNos =<span style="color: #000000;"> indexNo.Split(PublicValue.FirstSplitString);
</span><span style="color: #008080;"> 9</span>             <span style="color: #0000ff;">foreach</span> (<span style="color: #0000ff;">var</span> item <span style="color: #0000ff;">in</span><span style="color: #000000;"> indexNos)
</span><span style="color: #008080;">10</span> <span style="color: #000000;">            {
</span><span style="color: #008080;">11</span> <span style="color: #000000;">                _flowConfigDao.delJudgeByNode(param, item);
</span><span style="color: #008080;">12</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">13</span>         }    </pre>
</div>
<p>　　　<span style="font-size: 18pt;">4.接口层:</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;">2</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 删除当前节点的判断检查配置情况
</span><span style="color: #008080;">3</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;">4</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="param"&gt;&lt;/param&gt;</span>
<span style="color: #008080;">5</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="indexNo"&gt;&lt;/param&gt;</span>
<span style="color: #008080;">6</span>         <span style="color: #0000ff;">void</span> delJudgeByNode(Dictionary&lt;<span style="color: #0000ff;">string</span>, <span style="color: #0000ff;">string</span>&gt; param, <span style="color: #0000ff;">string</span> indexNo);</pre>
</div>
<p><span style="font-size: 18pt;">　&nbsp; 5.Dao层：</span><span style="font-size: 18pt;">　</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;summary&gt;</span>
<span style="color: #008080;"> 2</span>         <span style="color: #808080;">///</span><span style="color: #008000;"> 删除当前节点的判断检查配置情况
</span><span style="color: #008080;"> 3</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;/summary&gt;</span>
<span style="color: #008080;"> 4</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="param"&gt;&lt;/param&gt;</span>
<span style="color: #008080;"> 5</span>         <span style="color: #808080;">///</span> <span style="color: #808080;">&lt;param name="indexNo"&gt;&lt;/param&gt;</span>
<span style="color: #008080;"> 6</span>         <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> delJudgeByNode(Dictionary&lt;<span style="color: #0000ff;">string</span>, <span style="color: #0000ff;">string</span>&gt; param, <span style="color: #0000ff;">string</span><span style="color: #000000;"> indexNo)
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">        {
</span><span style="color: #008080;"> 8</span> <span style="color: #000000;">            BLLService.ExecuteNonQuery(
</span><span style="color: #008080;"> 9</span>                       <span style="color: #800000;">"</span><span style="color: #800000;">PKG_TEST.JUDGE_LIST_DEL</span><span style="color: #800000;">"</span><span style="color: #000000;">,
</span><span style="color: #008080;">10</span>                       <span style="color: #800000;">"</span><span style="color: #800000;">P_WF_M_ID</span><span style="color: #800000;">"</span>, param[<span style="color: #800000;">"</span><span style="color: #800000;">modelID</span><span style="color: #800000;">"</span><span style="color: #000000;">],
</span><span style="color: #008080;">11</span>                       <span style="color: #800000;">"</span><span style="color: #800000;">P_WF_M_NODE_ID</span><span style="color: #800000;">"</span>, param[<span style="color: #800000;">"</span><span style="color: #800000;">nodeID</span><span style="color: #800000;">"</span><span style="color: #000000;">],                     
</span><span style="color: #008080;">12</span>                       <span style="color: #800000;">"</span><span style="color: #800000;">P_INDEX_NO</span><span style="color: #800000;">"</span><span style="color: #000000;">, indexNo
</span><span style="color: #008080;">13</span> <span style="color: #000000;">                      );
</span><span style="color: #008080;">14</span>         }</pre>
</div>
<p><span style="font-size: 18pt; color: #0000ff;">哎呀，重点终于来了。。。</span></p>
<p><span style="font-size: 18pt; color: #0000ff;">　　看看怎么在存储过程里通过游标循环操作每一行数据</span></p>
<p><span style="font-size: 18pt; color: #0000ff;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span style="font-size: 18px;"><span style="color: #008080;">/*<br />&nbsp;&nbsp;&nbsp;　　 功能描述：删除判断节点配置情况<br />&nbsp;&nbsp;&nbsp;　　 创建人：mengmeng.chen 2018-11-22<br />&nbsp; 　　*/ </span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;">　　<span style="color: #000000;">PROCEDURE JUDGE_LIST_DEL</span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;">　　(</span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;">　　　　<span style="font-size: 18px;">P_WF_M_ID IN TWF_MODEL_NODE_JUDGE.WF_M_ID%<span style="color: #000000;">TYPE,</span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;">　　　　<span style="font-size: 18px;">P_WF_M_NODE_ID IN TWF_MODEL_NODE_JUDGE.WF_M_NODE_ID%<span style="color: #000000;">TYPE,</span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　 <span style="font-size: 18px;">P_INDEX_NO IN TWF_MODEL_NODE_JUDGE.INDEX_NO%<span style="color: #000000;">TYPE <span style="color: #ff0000;">--将要删除的数据的执行次序</span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;">　　)　 AS</span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;">　　　　　　<span style="font-size: 18px;"><span style="color: #000000;">V_COUNT INTEGER;</span></span>&nbsp;</span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;">　　　　　　<span style="font-size: 18px;">V_INDEX_NO INTEGER;&nbsp;<span style="color: #ff0000;"> --游标参数</span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;">　　　　　　　<span style="font-size: 14pt;">1.</span></span></span></span><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 14pt;">声明显示游标</span> </span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;">　　　　　　　　&nbsp; --声明格式： &nbsp; CURSOR 游标名[(参数1 数据类型[，参数2 数据类型...])] &nbsp;&nbsp; IS SELECT语句;　</span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;">　　　　　　&nbsp; 　　--参数是可选部分，所定义的参数可以出现在SELECT语句的WHERE子句中。</span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;">　　　　　　&nbsp; 　　--如果定义了参数，则必须在打开游标时传递相应的实际参数。　　　　　</span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;">　　　　　　　<span style="font-size: 18px;"><span style="color: #000000;">CURSOR&nbsp;&nbsp; C_JUDGE (P_C_INDEX_NO 　　IN 　　INTEGER) IS　　　　　　　</span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"> 　　　　　　　　　　SELECT *<span style="color: #000000;"> FROM TWF_MODEL_NODE_JUDGE&nbsp;</span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;">　　　　　　　　　　WHERE INDEX_NO &gt;<span style="color: #000000;"> P_C_INDEX_NO <span style="color: #008080;">12 <span style="color: #000000;"> ORDER BY INDEX_NO; </span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;">　　　　　　　<span style="color: #ff0000;">--将一行数据取到记录变量中，需要使用%ROWTYPE事先定义记录变量；</span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;">　　　　　　　<span style="font-size: 18px;">C_JUDE_ROW &nbsp; &nbsp; C_JUDGE%ROWTYPE;&nbsp; <span style="color: #ff0000;">--定义游标变量</span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;">　　　　　<span style="font-size: 18px;"><span style="color: #000000;">BEGIN</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　--判断该模板是否在使用中，若在使用中，不能删除<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　SELECT COUNT(1)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　INTO V_COUNT<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　FROM TWF_INSTANCE<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　WHERE WF_M_ID = P_WF_M_ID;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　IF V_COUNT = 0 THEN<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　　　　 　　 --先删除检查配置<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　 DELETE FROM TWF_MODEL_NODE_JUDGE<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　 WHERE INDEX_NO = P_INDEX_NO AND <br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　WF_M_ID =&nbsp; P_WF_M_ID AND<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　WF_M_NODE_ID = P_WF_M_NODE_ID;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　COMMIT;&nbsp;&nbsp; </span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　　 --更新删除后的数据的执行次序</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　 &nbsp; &nbsp;V_INDEX_NO := P_INDEX_NO ;&nbsp; --给游标参数赋值</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　　<span style="color: #ff0000;">2.打开游标，SELECT语句的查询结果被传送到了游标工作区</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　 OPEN C_JUDGE(V_INDEX_NO);</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　　<span style="color: #ff0000;">3.提取数据，将游标工作区中的数据取到变量中，用循环控制一行一行提取，并更新执行次序</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;　　　　　　&nbsp;&nbsp; LOOP&nbsp;&nbsp; 　　　　　　　　　　　　<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　　FETCH&nbsp;&nbsp;&nbsp; C_JUDGE &nbsp;&nbsp; INTO&nbsp;&nbsp;&nbsp; C_JUDE_ROW;&nbsp; &nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　　 EXIT&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; WHEN 　　&nbsp; C_JUDGE%NOTFOUND;&nbsp; &nbsp;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　&nbsp; <span style="color: #ff0000;">4.对提取出的数据进行操作</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　UPDATE TWF_MODEL_NODE_JUDGE<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　SET INDEX_NO = C_JUDE_ROW.INDEX_NO - 1<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　WHERE TWF_MODEL_NODE_JUDGE.WF_M_NODE_CFG_ID = C_JUDE_ROW.WF_M_NODE_CFG_ID;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　COMMIT;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">　　　　　　　　&nbsp; <span style="color: #ff0000;">5.结束循环</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 　　　　　　END LOOP;</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="color: #008080;"><span style="color: #000000;"><span style="font-size: 18px;"><span style="color: #ff0000;"><span style="font-size: 18px;"><span style="color: #000000;">&nbsp;　　　　　　END IF;<br />&nbsp; END JUDGE_LIST_DEL;　　　　　</span></span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><span style="font-size: 18pt; color: #0000ff;"><span style="font-size: 18px; color: #ff0000;">完整的存储过程：　　　　</span></span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 18px;"><span style="color: #008080;">&nbsp; 　　/*<br />&nbsp;&nbsp;&nbsp;　　 功能描述：删除判断节点配置情况<br />&nbsp;&nbsp;&nbsp;　　 创建人：mengmeng.chen 2018-11-22<br />&nbsp; 　　*/ <br /> 1</span> <span style="color: #000000;">  PROCEDURE JUDGE_LIST_DEL
</span><span style="color: #008080;"> 2</span> <span style="color: #000000;">  (    
</span><span style="color: #008080;"> 3</span>      P_WF_M_ID    IN TWF_MODEL_NODE_JUDGE.WF_M_ID%<span style="color: #000000;">TYPE,
</span><span style="color: #008080;"> 4</span>      P_WF_M_NODE_ID IN TWF_MODEL_NODE_JUDGE.WF_M_NODE_ID%<span style="color: #000000;">TYPE,
</span><span style="color: #008080;"> 5</span>      P_INDEX_NO     IN TWF_MODEL_NODE_JUDGE.INDEX_NO%<span style="color: #000000;">TYPE
</span><span style="color: #008080;"> 6</span> <span style="color: #000000;">  ) AS     
</span><span style="color: #008080;"> 7</span> <span style="color: #000000;">    V_COUNT INTEGER;
</span><span style="color: #008080;"> 8</span>     V_INDEX_NO INTEGER;--<span style="color: #000000;">游标参数
</span><span style="color: #008080;"> 9</span>     CURSOR C_JUDGE(P_C_INDEX_NO IN INTEGER) IS --<span style="color: #000000;">声明显式游标  
</span><span style="color: #008080;">10</span>       SELECT *<span style="color: #000000;"> FROM TWF_MODEL_NODE_JUDGE
</span><span style="color: #008080;">11</span>       WHERE INDEX_NO &gt;<span style="color: #000000;"> P_C_INDEX_NO
</span><span style="color: #008080;">12</span> <span style="color: #000000;">      ORDER BY INDEX_NO; 
</span><span style="color: #008080;">13</span>     C_JUDE_ROW C_JUDGE%ROWTYPE; --<span style="color: #000000;">定义游标变量 
</span><span style="color: #008080;">14</span>     V_INDEX_NO_TEMP    INTEGER;--<span style="color: #000000;">临时次序
</span><span style="color: #008080;">15</span> <span style="color: #000000;">  BEGIN 
</span><span style="color: #008080;">16</span>     
<span style="color: #008080;">17</span>        --<span style="color: #000000;">判断该模板是否在使用中
</span><span style="color: #008080;">18</span>        SELECT COUNT(<span style="color: #800080;">1</span><span style="color: #000000;">)
</span><span style="color: #008080;">19</span> <span style="color: #000000;">       INTO V_COUNT
</span><span style="color: #008080;">20</span> <span style="color: #000000;">       FROM TWF_INSTANCE
</span><span style="color: #008080;">21</span>        WHERE WF_M_ID =<span style="color: #000000;"> P_WF_M_ID;
</span><span style="color: #008080;">22</span>        
<span style="color: #008080;">23</span>        IF V_COUNT = <span style="color: #800080;">0</span><span style="color: #000000;"> THEN
</span><span style="color: #008080;">24</span>          --<span style="color: #000000;">删除检查配置
</span><span style="color: #008080;">25</span> <span style="color: #000000;">         DELETE FROM TWF_MODEL_NODE_JUDGE
</span><span style="color: #008080;">26</span>          WHERE INDEX_NO =<span style="color: #000000;"> P_INDEX_NO AND 
</span><span style="color: #008080;">27</span>                WF_M_ID =<span style="color: #000000;">  P_WF_M_ID AND
</span><span style="color: #008080;">28</span>                WF_M_NODE_ID =<span style="color: #000000;"> P_WF_M_NODE_ID;
</span><span style="color: #008080;">29</span> <span style="color: #000000;">         COMMIT;        
</span><span style="color: #008080;">30</span>          V_INDEX_NO :=<span style="color: #000000;"> P_INDEX_NO ; 
</span><span style="color: #008080;">31</span>          --<span style="color: #000000;">打开游标
</span><span style="color: #008080;">32</span> <span style="color: #000000;">         OPEN C_JUDGE(V_INDEX_NO);
</span><span style="color: #008080;">33</span> <span style="color: #000000;">         LOOP   
</span><span style="color: #008080;">34</span> <span style="color: #000000;">         FETCH C_JUDGE INTO C_JUDE_ROW;   
</span><span style="color: #008080;">35</span>            EXIT WHEN C_JUDGE%<span style="color: #000000;">NOTFOUND;   
</span><span style="color: #008080;">36</span> <span style="color: #000000;">           UPDATE TWF_MODEL_NODE_JUDGE
</span><span style="color: #008080;">37</span>            SET INDEX_NO = C_JUDE_ROW.INDEX_NO - <span style="color: #800080;">1</span>
<span style="color: #008080;">38</span>            WHERE TWF_MODEL_NODE_JUDGE.WF_M_NODE_CFG_ID =<span style="color: #000000;"> C_JUDE_ROW.WF_M_NODE_CFG_ID;
</span><span style="color: #008080;">39</span> <span style="color: #000000;">           COMMIT;
</span><span style="color: #008080;">40</span> <span style="color: #000000;">         END LOOP;
</span><span style="color: #008080;">41</span>          
<span style="color: #008080;">42</span> <span style="color: #000000;">       END IF;
</span><span style="color: #008080;">43</span>   END JUDGE_LIST_DEL;</span></pre>
</div>
<p>&nbsp;</p>
<p>cat dockerlist |while read line;do docker rmi&nbsp; $line ;done</p>
<h2>jsp标签的作用</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; jsp标签作用：替换jsp脚本。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1）流程判断（if&nbsp;&nbsp; for循环）</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2）跳转页面（转发，重定向）</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3）。。。。。</p>
<p>&nbsp;</p>
<h2>&nbsp;Jsp标签分类</h2>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1）内置标签（动作标签）： 不需要在jsp页面导入标签</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2）jstl标签： 需要在jsp页面中导入标签</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3）自定义标签 ： 开发者自行定义，需要在jsp页面导入标签</p>
<h1><strong><span style="font-family: 宋体;">第</span>9<span style="font-family: 宋体;">章</span>&nbsp;<span style="font-family: Calibri;">DML</span></strong></h1>
<p><span style="font-family: 宋体;">数据操纵语言（</span>DML<span style="font-family: 宋体;">）</span><span style="font-family: Calibri;">DML</span><span style="font-family: 宋体;">用于插入、修改、删除数据记录，包括如下</span><span style="font-family: Calibri;">SQL</span><span style="font-family: 宋体;">语句：</span></p>
<p>INSERT<span style="font-family: 宋体;">：添加数据到数据库中</span></p>
<p>UPDATE<span style="font-family: 宋体;">：修改数据库中的数据</span></p>
<p>DELETE<span style="font-family: 宋体;">：删除数据库中的数据</span></p>
<h2><strong>9.1&nbsp;<span style="font-family: 黑体;">插入数据</span></strong></h2>
<div><img src="https://img2018.cnblogs.com/blog/1086649/201811/1086649-20181122150731019-8262974.png" alt="" /><br />
<h3><strong>1<span style="font-family: 宋体;">、语法</span></strong></h3>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="712">
<p>INSERT INTO&nbsp;<span style="font-family: 宋体;">表名称 &nbsp;</span><span style="font-family: Calibri;">VALUES(</span><span style="font-family: 宋体;">值</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，值</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......);</span></p>

</td>

</tr>
<tr>
<td valign="top" width="712">
<p>INSERT INTO&nbsp;<span style="font-family: 宋体;">表名称 &nbsp;</span><span style="font-family: Calibri;">VALUES(</span><span style="font-family: 宋体;">值</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，值</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......),(</span><span style="font-family: 宋体;">值</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，值</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......),...;</span></p>

</td>

</tr>
<tr>
<td valign="top" width="712">
<p>INSERT INTO&nbsp;<span style="font-family: 宋体;">表名称</span>&nbsp;<span style="font-family: Calibri;">(</span><span style="font-family: 宋体;">字段</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，字段</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......) VALUES(</span><span style="font-family: 宋体;">值</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，值</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......);</span></p>

</td>

</tr>
<tr>
<td valign="top" width="712">
<p>INSERT INTO&nbsp;<span style="font-family: 宋体;">表名称</span>&nbsp;<span style="font-family: Calibri;">(</span><span style="font-family: 宋体;">字段</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，字段</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......) VALUES(</span><span style="font-family: 宋体;">值</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，值</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......),(</span><span style="font-family: 宋体;">值</span><span style="font-family: Calibri;">1</span><span style="font-family: 宋体;">，值</span><span style="font-family: Calibri;">2</span><span style="font-family: 宋体;">，</span><span style="font-family: Calibri;">......),.....;</span></p>

</td>

</tr>

</tbody>

</table>
<h3><strong>2<span style="font-family: 宋体;">、说明</span></strong></h3>
<p>1<span style="font-family: 宋体;">、值的顺序、个数与字段列表中字段的顺序、个数一致</span></p>
<p><span style="font-family: 宋体;">（</span>1<span style="font-family: 宋体;">）如果个数少了就报</span><span style="font-family: Calibri;">Column count doesn</span>&rsquo;t match value count</p>
<p><span style="font-family: 宋体;">（</span>2<span style="font-family: 宋体;">）如果</span><span style="font-family: Calibri;">VALUES</span><span style="font-family: 宋体;">前面的</span><span style="font-family: Calibri;">()</span><span style="font-family: 宋体;">中没有列出字段，那么默认就是为表中的所有字段赋值，那么个数与顺序与表结构中字段定义的一致</span></p>
<p>2<span style="font-family: 宋体;">、关于自增长列，默认值列，允许为</span><span style="font-family: Calibri;">NULL</span><span style="font-family: 宋体;">列的赋值</span></p>
<p><span style="font-family: 宋体;">（</span>1<span style="font-family: 宋体;">）如果字段列表列出了字段名，那么值列表中就要为其赋值，哪怕它是自增长列，有默认值列，可以为</span><span style="font-family: Calibri;">NULL</span><span style="font-family: 宋体;">值的列。</span></p>
<p>l&nbsp;InnoDB<span style="font-family: 宋体;">表的自动增长列可以手动插入合适的值，但是插入的值如果是</span><span style="font-family: Calibri;">NULL</span><span style="font-family: 宋体;">或者</span><span style="font-family: Calibri;">0</span><span style="font-family: 宋体;">，则实际插入的将是自动增长后的值；</span></p>
<p>l&nbsp;<span style="font-family: 宋体;">如果列声明了</span>&ldquo;默认约束&rdquo;那么对应的位置可以赋值具体的值，也可以使用&ldquo;<span style="font-family: Calibri;">DEFAULT</span><span style="font-family: 宋体;">&rdquo;，表示使用默认值；</span></p>
<p>l&nbsp;<span style="font-family: 宋体;">如果列允许了</span>NULL<span style="font-family: 宋体;">值，那么可以为对应的字段可以赋值为具体值也可以赋值为</span><span style="font-family: Calibri;">NULL</span></p>
<p><span style="font-family: 宋体;">（</span>2<span style="font-family: 宋体;">）对于没有列出的字段，像自增列就自动赋值，像默认值列就自动赋默认值，像允许</span><span style="font-family: Calibri;">NULL</span><span style="font-family: 宋体;">的列就自动赋</span><span style="font-family: Calibri;">NULL</span><span style="font-family: 宋体;">值</span></p>
<p>3<span style="font-family: 宋体;">、</span><span style="font-family: Calibri;">VALUES</span><span style="font-family: 宋体;">也可以写成</span><span style="font-family: Calibri;">VALUE</span><span style="font-family: 宋体;">，但是</span><span style="font-family: Calibri;">VALUES</span><span style="font-family: 宋体;">是标准写法</span></p>
<p>4<span style="font-family: 宋体;">、可以同时插入多行</span></p>
<p>5<span style="font-family: 宋体;">、如果插入从表的数据，要注意查看主表参照字段的值是否存在</span></p>
<p>6<span style="font-family: 宋体;">、值的位置可以是常量值、表达式、函数</span></p>
<p><span>本教程由尚硅谷教育大数据研究院出品，如需转载请注明来源，欢迎大家关注尚硅谷公众号（atguigu）了解更多。</span></p>

</div>
<p><img src="https://img2018.cnblogs.com/blog/1115571/201811/1115571-20181122150729530-1887782507.png" alt="" /></p>
<p>&nbsp;</p>
<p><strong>nihao</strong></p>
<p>&nbsp;</p>
<p><strong><img src="https://img2018.cnblogs.com/blog/814114/201811/814114-20181122150640335-125597076.png" alt="" /></strong></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><a href="http://www.baidu.com" target="_blank">https://www.baidi.com</a></p>
<p>　　此题要求实现给定二叉搜索树的5种常用操作。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">  1</span> #include &lt;stdio.h&gt;
<span style="color: #008080;">  2</span> #include &lt;stdlib.h&gt;
<span style="color: #008080;">  3</span> 
<span style="color: #008080;">  4</span> typedef <span style="color: #0000ff;">int</span><span style="color: #000000;"> ElementType;
</span><span style="color: #008080;">  5</span> typedef <span style="color: #0000ff;">struct</span> TNode *<span style="color: #000000;">Position;
</span><span style="color: #008080;">  6</span> <span style="color: #000000;">typedef Position BinTree;
</span><span style="color: #008080;">  7</span> <span style="color: #0000ff;">struct</span><span style="color: #000000;"> TNode{
</span><span style="color: #008080;">  8</span> <span style="color: #000000;">    ElementType Data;
</span><span style="color: #008080;">  9</span> <span style="color: #000000;">    BinTree Left;
</span><span style="color: #008080;"> 10</span> <span style="color: #000000;">    BinTree Right;
</span><span style="color: #008080;"> 11</span> <span style="color: #000000;">};
</span><span style="color: #008080;"> 12</span> 
<span style="color: #008080;"> 13</span> <span style="color: #0000ff;">void</span> PreorderTraversal( BinTree BT ); <span style="color: #008000;">/*</span><span style="color: #008000;"> 先序遍历，由裁判实现，细节不表 </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 14</span> <span style="color: #0000ff;">void</span> InorderTraversal( BinTree BT );  <span style="color: #008000;">/*</span><span style="color: #008000;"> 中序遍历，由裁判实现，细节不表 </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 15</span> 
<span style="color: #008080;"> 16</span> <span style="color: #000000;">BinTree Insert( BinTree BST, ElementType X );
</span><span style="color: #008080;"> 17</span> <span style="color: #000000;">BinTree Delete( BinTree BST, ElementType X );
</span><span style="color: #008080;"> 18</span> <span style="color: #000000;">Position Find( BinTree BST, ElementType X );
</span><span style="color: #008080;"> 19</span> <span style="color: #000000;">Position FindMin( BinTree BST );
</span><span style="color: #008080;"> 20</span> <span style="color: #000000;">Position FindMax( BinTree BST );
</span><span style="color: #008080;"> 21</span> 
<span style="color: #008080;"> 22</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
</span><span style="color: #008080;"> 23</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 24</span> <span style="color: #000000;">    BinTree BST, MinP, MaxP, Tmp;
</span><span style="color: #008080;"> 25</span> <span style="color: #000000;">    ElementType X;
</span><span style="color: #008080;"> 26</span>     <span style="color: #0000ff;">int</span><span style="color: #000000;"> N, i;
</span><span style="color: #008080;"> 27</span> 
<span style="color: #008080;"> 28</span>     BST =<span style="color: #000000;"> NULL;
</span><span style="color: #008080;"> 29</span>     scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>, &amp;<span style="color: #000000;">N);
</span><span style="color: #008080;"> 30</span>     <span style="color: #0000ff;">for</span> ( i=<span style="color: #800080;">0</span>; i&lt;N; i++<span style="color: #000000;"> ) {
</span><span style="color: #008080;"> 31</span>         scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>, &amp;<span style="color: #000000;">X);
</span><span style="color: #008080;"> 32</span>         BST =<span style="color: #000000;"> Insert(BST, X);
</span><span style="color: #008080;"> 33</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 34</span>     printf(<span style="color: #800000;">"</span><span style="color: #800000;">Preorder:</span><span style="color: #800000;">"</span>); PreorderTraversal(BST); printf(<span style="color: #800000;">"</span><span style="color: #800000;">\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 35</span>     MinP =<span style="color: #000000;"> FindMin(BST);
</span><span style="color: #008080;"> 36</span>     MaxP =<span style="color: #000000;"> FindMax(BST);
</span><span style="color: #008080;"> 37</span>     scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>, &amp;<span style="color: #000000;">N);
</span><span style="color: #008080;"> 38</span>     <span style="color: #0000ff;">for</span>( i=<span style="color: #800080;">0</span>; i&lt;N; i++<span style="color: #000000;"> ) {
</span><span style="color: #008080;"> 39</span>         scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>, &amp;<span style="color: #000000;">X);
</span><span style="color: #008080;"> 40</span>         Tmp =<span style="color: #000000;"> Find(BST, X);
</span><span style="color: #008080;"> 41</span>         <span style="color: #0000ff;">if</span> (Tmp == NULL) printf(<span style="color: #800000;">"</span><span style="color: #800000;">%d is not found\n</span><span style="color: #800000;">"</span><span style="color: #000000;">, X);
</span><span style="color: #008080;"> 42</span>         <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;"> 43</span>             printf(<span style="color: #800000;">"</span><span style="color: #800000;">%d is found\n</span><span style="color: #800000;">"</span>, Tmp-&gt;<span style="color: #000000;">Data);
</span><span style="color: #008080;"> 44</span>             <span style="color: #0000ff;">if</span> (Tmp==MinP) printf(<span style="color: #800000;">"</span><span style="color: #800000;">%d is the smallest key\n</span><span style="color: #800000;">"</span>, Tmp-&gt;<span style="color: #000000;">Data);
</span><span style="color: #008080;"> 45</span>             <span style="color: #0000ff;">if</span> (Tmp==MaxP) printf(<span style="color: #800000;">"</span><span style="color: #800000;">%d is the largest key\n</span><span style="color: #800000;">"</span>, Tmp-&gt;<span style="color: #000000;">Data);
</span><span style="color: #008080;"> 46</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 47</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 48</span>     scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>, &amp;<span style="color: #000000;">N);
</span><span style="color: #008080;"> 49</span>     <span style="color: #0000ff;">for</span>( i=<span style="color: #800080;">0</span>; i&lt;N; i++<span style="color: #000000;"> ) {
</span><span style="color: #008080;"> 50</span>         scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%d</span><span style="color: #800000;">"</span>, &amp;<span style="color: #000000;">X);
</span><span style="color: #008080;"> 51</span>         BST =<span style="color: #000000;"> Delete(BST, X);
</span><span style="color: #008080;"> 52</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 53</span>     printf(<span style="color: #800000;">"</span><span style="color: #800000;">Inorder:</span><span style="color: #800000;">"</span>); InorderTraversal(BST); printf(<span style="color: #800000;">"</span><span style="color: #800000;">\n</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;"> 54</span> 
<span style="color: #008080;"> 55</span>     <span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 56</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 57</span> <span style="color: #008000;">/*</span><span style="color: #008000;"> 你的代码将被嵌在这里 </span><span style="color: #008000;">*/</span>
<span style="color: #008080;"> 58</span> <span style="color: #000000;">BinTree Insert( BinTree BST, ElementType X )
</span><span style="color: #008080;"> 59</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 60</span>     <span style="color: #0000ff;">if</span> ( !<span style="color: #000000;">BST ) {
</span><span style="color: #008080;"> 61</span>         BST = (BinTree)<span style="color: #0000ff;">malloc</span>(<span style="color: #0000ff;">sizeof</span>(<span style="color: #0000ff;">struct</span><span style="color: #000000;"> TNode));
</span><span style="color: #008080;"> 62</span>         BST-&gt;Left = BST-&gt;Right =<span style="color: #000000;"> NULL;
</span><span style="color: #008080;"> 63</span>         BST-&gt;Data =<span style="color: #000000;"> X;
</span><span style="color: #008080;"> 64</span> <span style="color: #000000;">    } 
</span><span style="color: #008080;"> 65</span>     <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;"> 66</span>         <span style="color: #0000ff;">if</span> ( X &lt; BST-&gt;<span style="color: #000000;">Data )        
</span><span style="color: #008080;"> 67</span>             BST-&gt;Left = Insert(BST-&gt;Left, X);  <span style="color: #008000;">//</span><span style="color: #008000;"> 递归插入左子树 </span>
<span style="color: #008080;"> 68</span>         <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ( X &gt; BST-&gt;<span style="color: #000000;">Data )    
</span><span style="color: #008080;"> 69</span>             BST-&gt;Right = Insert(BST-&gt;Right, X); <span style="color: #008000;">//</span><span style="color: #008000;"> 递归插入右子树</span>
<span style="color: #008080;"> 70</span>         <span style="color: #008000;">/*</span><span style="color: #008000;"> else X 已经存在，什么也不做 </span><span style="color: #008000;">*/</span> 
<span style="color: #008080;"> 71</span> <span style="color: #000000;">    }    
</span><span style="color: #008080;"> 72</span>     
<span style="color: #008080;"> 73</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> BST;
</span><span style="color: #008080;"> 74</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 75</span> 
<span style="color: #008080;"> 76</span> <span style="color: #000000;">BinTree Delete( BinTree BST, ElementType X )
</span><span style="color: #008080;"> 77</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 78</span> <span style="color: #000000;">    BinTree Tmp;
</span><span style="color: #008080;"> 79</span>     
<span style="color: #008080;"> 80</span>     <span style="color: #0000ff;">if</span> ( !BST )    printf(<span style="color: #800000;">"</span><span style="color: #800000;">Not Found\n</span><span style="color: #800000;">"</span>); <span style="color: #008000;">//</span><span style="color: #008000;"> 要删除元素未找到 </span>
<span style="color: #008080;"> 81</span>     <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;"> 82</span>         <span style="color: #0000ff;">if</span> ( X &lt; BST-&gt;<span style="color: #000000;">Data )
</span><span style="color: #008080;"> 83</span>             BST-&gt;Left = Delete(BST-&gt;Left, X); <span style="color: #008000;">//</span><span style="color: #008000;"> 从左子树递归删除 </span>
<span style="color: #008080;"> 84</span>         <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ( X &gt; BST-&gt;<span style="color: #000000;">Data )
</span><span style="color: #008080;"> 85</span>             BST-&gt;Right = Delete(BST-&gt;Right, X);<span style="color: #008000;">//</span><span style="color: #008000;"> 从右子树递归删除 </span>
<span style="color: #008080;"> 86</span>         <span style="color: #0000ff;">else</span> {  <span style="color: #008000;">//</span><span style="color: #008000;"> BST 就是要删除的节点 
</span><span style="color: #008080;"> 87</span>             <span style="color: #008000;">//</span><span style="color: #008000;"> 被删除节点有左右两个子节点 </span>
<span style="color: #008080;"> 88</span>             <span style="color: #0000ff;">if</span> ( BST-&gt;Left &amp;&amp; BST-&gt;<span style="color: #000000;">Right ) {
</span><span style="color: #008080;"> 89</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> 从右子树中找到最小元素填充被删除节点 </span>
<span style="color: #008080;"> 90</span>                 Tmp = FindMin(BST-&gt;<span style="color: #000000;">Right);
</span><span style="color: #008080;"> 91</span>                 BST-&gt;Data = Tmp-&gt;<span style="color: #000000;">Data;
</span><span style="color: #008080;"> 92</span>                 <span style="color: #008000;">//</span><span style="color: #008000;"> 删除 右子树中的最小元素 </span>
<span style="color: #008080;"> 93</span>                 BST-&gt;Right = Delete(BST-&gt;Right, BST-&gt;<span style="color: #000000;">Data); 
</span><span style="color: #008080;"> 94</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 95</span>             <span style="color: #0000ff;">else</span> { <span style="color: #008000;">//</span><span style="color: #008000;"> 被删除节点有一个或无子节点 </span>
<span style="color: #008080;"> 96</span>                 Tmp =<span style="color: #000000;"> BST;
</span><span style="color: #008080;"> 97</span>                 <span style="color: #0000ff;">if</span> ( !BST-&gt;Left ) <span style="color: #008000;">//</span><span style="color: #008000;">  只有右节点或无子节点 </span>
<span style="color: #008080;"> 98</span>                     BST = BST-&gt;<span style="color: #000000;">Right;
</span><span style="color: #008080;"> 99</span>                 <span style="color: #0000ff;">else</span>              <span style="color: #008000;">//</span><span style="color: #008000;">  只有左孩子</span>
<span style="color: #008080;">100</span>                     BST = BST-&gt;<span style="color: #000000;">Left;
</span><span style="color: #008080;">101</span>                 <span style="color: #0000ff;">free</span><span style="color: #000000;">(Tmp); 
</span><span style="color: #008080;">102</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">103</span> <span style="color: #000000;">        } 
</span><span style="color: #008080;">104</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">105</span>     
<span style="color: #008080;">106</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> BST;
</span><span style="color: #008080;">107</span> <span style="color: #000000;">}
</span><span style="color: #008080;">108</span> 
<span style="color: #008080;">109</span> <span style="color: #000000;">Position Find( BinTree BST, ElementType X )
</span><span style="color: #008080;">110</span> <span style="color: #000000;">{    
</span><span style="color: #008080;">111</span>     <span style="color: #0000ff;">if</span> ( !BST )        <span style="color: #0000ff;">return</span> NULL; <span style="color: #008000;">//</span><span style="color: #008000;"> 没找着，返回空指针 </span>
<span style="color: #008080;">112</span>     <span style="color: #0000ff;">if</span> ( X &lt; BST-&gt;<span style="color: #000000;">Data ) 
</span><span style="color: #008080;">113</span>         <span style="color: #0000ff;">return</span> Find(BST-&gt;<span style="color: #000000;">Left, X);
</span><span style="color: #008080;">114</span>     <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ( X &gt; BST-&gt;<span style="color: #000000;">Data )
</span><span style="color: #008080;">115</span>         <span style="color: #0000ff;">return</span> Find(BST-&gt;<span style="color: #000000;">Right, X);
</span><span style="color: #008080;">116</span>     <span style="color: #0000ff;">else</span> 
<span style="color: #008080;">117</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> BST;
</span><span style="color: #008080;">118</span> <span style="color: #000000;">}
</span><span style="color: #008080;">119</span> 
<span style="color: #008080;">120</span> <span style="color: #000000;">Position FindMin( BinTree BST )
</span><span style="color: #008080;">121</span> <span style="color: #000000;">{
</span><span style="color: #008080;">122</span>     <span style="color: #0000ff;">if</span> ( !BST )    <span style="color: #0000ff;">return</span><span style="color: #000000;"> NULL;
</span><span style="color: #008080;">123</span>     <span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> ( !BST-&gt;<span style="color: #000000;">Left )    
</span><span style="color: #008080;">124</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> BST;
</span><span style="color: #008080;">125</span>     <span style="color: #0000ff;">else</span>
<span style="color: #008080;">126</span>         <span style="color: #0000ff;">return</span> FindMin(BST-&gt;<span style="color: #000000;">Left);
</span><span style="color: #008080;">127</span> <span style="color: #000000;">}
</span><span style="color: #008080;">128</span> 
<span style="color: #008080;">129</span> <span style="color: #000000;">Position FindMax( BinTree BST )
</span><span style="color: #008080;">130</span> <span style="color: #000000;">{
</span><span style="color: #008080;">131</span>     <span style="color: #0000ff;">if</span><span style="color: #000000;"> ( BST )
</span><span style="color: #008080;">132</span>         <span style="color: #0000ff;">while</span> ( BST-&gt;Right )    BST = BST-&gt;<span style="color: #000000;">Right;
</span><span style="color: #008080;">133</span>     <span style="color: #0000ff;">return</span><span style="color: #000000;"> BST;
</span><span style="color: #008080;">134</span> }</pre>
</div>
<p>&nbsp;</p>
#语法检测&代码提示
![](https://img2018.cnblogs.com/blog/1341972/201811/1341972-20181122150012981-1895724039.png)

#中文友好：
![](https://img2018.cnblogs.com/blog/1341972/201811/1341972-20181122150119056-271669164.png)

#tab
可以选中一大块代码，一起缩进

#快速注释
先选中你要注释的代码区，然后右键，选择Advanced，Comment Selection 就可以了

#查找替换
查找：Ctrl + F  （ide上方的图标亦可）
多文件查找替换：Ctrl+shift + F （ide上方的图标亦可）
查找替换：CTRL+H， 

先双击你要找的函数/变量名（这里我们还是以系统时钟
初始化函数： Stm32_Clock_Init 为例），然后再点击 IDE 上面的 ，
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Net;<br />using System.Net.Http;<br />using System.Web.Http;</p>
<p>namespace VacationOA.API.Controllers<br />{<br />    using BLL;<br />    using MODEL;<br />    public class VacationAPIController : ApiController<br />    {<br />        StaffBLL staffbll = new StaffBLL();<br />        LeaveBLL leaveBll = new LeaveBLL();<br />        CheckBLL checkbll = new CheckBLL();<br />        [Route("LoginStaff")]<br />        [HttpGet]<br />        public Staff LoginStaff(string name, string department)<br />        {<br />            return staffbll.LoginStaff(name, department);<br />        }<br />        /// &lt;summary&gt;<br />        /// 添加请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        [Route("AddLeave")]<br />        [HttpPost]<br />        public int AddLeave(Leave l)<br />        {<br />            //异常处理<br />            try<br />            {<br />                return leaveBll.AddLeave(l);<br />            }<br />            catch (Exception ex)<br />            {<br />                return 0;<br />            }<br />           <br />        }<br />        /// &lt;summary&gt;<br />        /// 修改请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;</p>
<p>        [Route("updateleave")]<br />        [HttpPost]<br />        public int updateleave(Leave l)<br />        {<br />            return leaveBll.updateleave(l);<br />        }<br />        /// &lt;summary&gt;<br />        /// 获取请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        [Route("GetLeaves")]<br />       [HttpPost]<br />        public Paging GetLeaves(LikeShow ls)<br />        {<br />            Paging paging = new Paging();<br />            List&lt;Leave&gt; list1 = leaveBll.GetLeaves();<br />            list1 = list1.Where(n =&gt; n.staffID.Equals(ls.staffID)).ToList();<br />            if (ls.state != "" &amp;&amp; ls.state != null)<br />            {<br />                list1 = list1.Where(n=&gt;n.state.Equals(ls.state)).ToList();<br />            }<br />            if (ls.starttime != null)<br />            {<br />                list1 = list1.Where(n =&gt; n.startTime&gt;=ls.starttime).ToList();<br />            }<br />            if (ls.endtiome != null)<br />            {<br />                list1 = list1.Where(n =&gt; n.endTime&lt;=ls.endtiome).ToList();<br />            }<br />            if (ls.Department!=null&amp;&amp;ls.Department!="")<br />            {<br />                list1 = list1.Where(n =&gt; n.Department.Equals(ls.Department)).ToList();<br />            }<br />            paging.Currentpage = ls.Currentpage;<br />            paging.Totlepage = list1.Count / 3 + (list1.Count % 3==0?0:1);<br />            paging.RowCounts = list1.Count;<br />            paging.DataBox = list1.Skip((ls.Currentpage-1)*3).Take(3).ToList();<br />            return paging;<br />        }<br />        /// &lt;summary&gt;<br />        /// 获取请假单 我的审核列表<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        [Route("GetLeavesCheck")]<br />        [HttpPost]<br />        public Paging GetLeavesCheck(LikeShow ls)<br />        {<br />            Paging paging = new Paging();<br />            List&lt;Leave&gt; list1 = leaveBll.GetLeavesCheck();<br />            if (ls.starttime != null)<br />            {<br />                list1 = list1.Where(n =&gt; n.startTime &gt;= ls.starttime).ToList();<br />            }<br />            if (ls.endtiome != null)<br />            {<br />                list1 = list1.Where(n =&gt; n.endTime &lt;= ls.endtiome).ToList();<br />            }<br />            if (ls.Department != null &amp;&amp; ls.Department != "")<br />            {<br />                list1 = list1.Where(n =&gt; n.Department.Equals(ls.Department)).ToList();<br />            }<br />            paging.Currentpage = ls.Currentpage;<br />            paging.Totlepage = list1.Count / 3 + (list1.Count % 3 == 0 ? 0 : 1);<br />            paging.RowCounts = list1.Count;<br />            paging.DataBox = list1.Skip((ls.Currentpage - 1) * 3).Take(3).ToList();<br />            return paging;<br />        }<br />        /// &lt;summary&gt;<br />        /// 反填请假单<br />        /// &lt;/summary&gt;<br />        [Route("GetleaveByID")]<br />        [HttpGet]<br />        public Leave GetleaveByID(int id)<br />        {<br />            List&lt;Leave&gt; list1 = leaveBll.GetLeaves();<br />            return list1.Where(n=&gt;n.leaveID.Equals(id)).FirstOrDefault();<br />        }<br />        /// &lt;summary&gt;<br />        /// 根据假条id查询是否有关于这个假条审核通过的审核单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="id"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        [Route("GetCheckbyid")]<br />        [HttpGet]<br />        public int GetCheckbyid(int id)<br />        {<br />            return checkbll.GetCheckbyid(id);<br />        }<br />        /// &lt;summary&gt;<br />        /// 添加审核清单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="tcheck"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        [Route("AddTcheck")]<br />        [HttpPost]<br />        public int AddTcheck(TCheck tcheck)<br />        {<br />            return checkbll.AddTcheck(tcheck);<br />        }<br />        /// &lt;summary&gt;<br />        /// 修改请假单的状态，审核时间，说明，<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        [Route("updateleaveState")]<br />        [HttpGet]<br />        public int updateleaveState(int id, DateTime checktime, string explain, string state)<br />        {<br />            return leaveBll.updateleaveState(id, checktime, explain, state);<br />        }<br />        /// &lt;summary&gt;<br />        /// 根据id获取对应请假单的审核历史<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        [Route("GetChecks")]<br />        [HttpGet]<br />        public List&lt;TCheck&gt; GetChecks(int id)<br />        {<br />            return checkbll.GetChecks(id);<br />        }<br />    }<br />}</p>
<p><br data-filtered="filtered" />接下来，分享一下上传本地项目到Github的步骤：<br data-filtered="filtered" />第一步：打开Github网站：<a href="https://github.com/%EF%BC%8C%E7%99%BB%E5%BD%95%E8%87%AA%E5%B7%B1%E7%9A%84%E8%B4%A6%E5%8F%B7%E3%80%82" target="_blank">https://github.com/，登录自己的账号。</a><br data-filtered="filtered" />第二步：如下图所示，点击Your profile，进入仓库管理：</p>
<div class="image-package"><img src="https://upload-images.jianshu.io/upload_images/2915863-5ea725bac6c6359c.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="" data-original-src="//upload-images.jianshu.io/upload_images/2915863-5ea725bac6c6359c.png?imageMogr2/auto-orient/strip%7CimageView2/2" /></div>
<p><br data-filtered="filtered" />第三步：如下图所示，新建仓库：</p>
<div class="image-package"><img src="https://upload-images.jianshu.io/upload_images/2915863-4c641fd724e30173.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="" data-original-src="//upload-images.jianshu.io/upload_images/2915863-4c641fd724e30173.png?imageMogr2/auto-orient/strip%7CimageView2/2" /></div>
<p><br data-filtered="filtered" />仓库命名Test：</p>
<div class="image-package"><img src="https://upload-images.jianshu.io/upload_images/2915863-270d87be63c7c3dd.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="" data-original-src="//upload-images.jianshu.io/upload_images/2915863-270d87be63c7c3dd.png?imageMogr2/auto-orient/strip%7CimageView2/2" /></div>
<p><br data-filtered="filtered" />仓库创建成功：</p>
<div class="image-package"><img src="https://upload-images.jianshu.io/upload_images/2915863-9a3e49176b6892fc.png?imageMogr2/auto-orient/strip%7CimageView2/2" alt="" data-original-src="//upload-images.jianshu.io/upload_images/2915863-9a3e49176b6892fc.png?imageMogr2/auto-orient/strip%7CimageView2/2" /></div>
<p><br data-filtered="filtered" />上图已经写清楚了Github上传项目的方法，有两种方法：一种通过https，一种通过ssh。<br data-filtered="filtered" />我刚开始是使用ssh的方法，不过一直报错，就直接换了https方法，这次一次就成功了。<br data-filtered="filtered" />第四步：因为GitHub是基于git实现的代码托管，所以git是少不了的。我们要确认电脑上安装了git，没有安装的，就去安装git。至于安装方法，就自行百度吧。<br data-filtered="filtered" />第五步：新建Test文件夹，里面添加几个文件。右击Test文件夹根目录，点击&ldquo;Git Bash Here&rdquo;，打开git命令行。<br data-filtered="filtered" />第五步：按照github新建仓库上的文档提示，提交项目：<br data-filtered="filtered" /><span style="color: #000000;">1.在命令行中，输入&ldquo;git init&rdquo;，使Test文件夹加入git管理；</span></p>
<p><span style="color: #ff0000;">在添加项目前应先把Git的key用命令直接生成，复制该key添加到你的Github账号上</span></p>
<p>执行 ssh-keygen -t rsa -C "1028617248@qq.com" 找到 C:\Users\Administrator\.ssh\id_rsa.pub文件，复制里面的内容</p>
<p><img src="https://img2018.cnblogs.com/blog/1244548/201811/1244548-20181122152408120-1153982751.png" alt="" /></p>
<p>&nbsp;</p>
<p>2.输入&ldquo;git add .&rdquo;（不要漏了&ldquo;.&rdquo;），将Test文件夹全部内容添加到git。<br data-filtered="filtered" />3.输入&ldquo;git commit -m "first commit"&rdquo;（&ldquo;git commit -m "提交信息"&rdquo;<br data-filtered="filtered" />）<br data-filtered="filtered" />4.输入&ldquo;git remote add origin&nbsp;<a href="https://github.com/shench5612390/Test.git%E2%80%9D%EF%BC%88git" target="_blank">https://github.com/shench5612390/Test.git&rdquo;（git</a>&nbsp;remote add origin 你自己的https地址），连接你的guthub仓库。<br data-filtered="filtered" />5.输入&ldquo;git push -u origin master&rdquo;，上传项目到Github。这里会要求输入Github的账号密码，按要求输入就可以。</p>
<p><strong>二、在linux服务器上搭建git服务</strong></p>
<p>1、安装git服务：yum install -y git 验证 git 是否安装成功 git --help <br />2、进入一个空文件夹 ：执行 git init;<br />3、 配置本地仓库的账号和邮箱</p>
<p>git config --global user.name "lijianeng10";<br />git config --global user.email "1028617248@qq.com"</p>
<p>4、为了避免每次远程访问需要输密码，将使用ssh登陆。ssh应该与本机信息绑定。</p>
<p>ssh-keygen -t rsa -C "1028617248@qq.com"<br />5、复制public key  到github<br />执行 cd ~/.ssh/ 找到 vim id_rsa.pub</p>
<p>6、执行：git clone&nbsp; git@github.com:michaelliao/gitskills.git&nbsp; //后面是项目ssh地址<br />7、拉取代码：git pull origin master</p>
<p><strong>1、增删改&mdash;通用存储过程</strong></p>
<p>--增删改 存储过程<br />create proc Infos_InsertUpdateDelete<br />(<br />	@Id int,<br />	@Name varchar(50),<br />	@DataTable_Action_ varchar(10) = '' --操作方法：Insert:增加 Update:修改 Delete:删除<br />)<br />AS<br />	declare @ReturnValue varchar(18) -- 返回操作结果<br />set @ReturnValue = -1<br />	--开启事务<br />	begin tran<br />	--错误捕捉机制<br />	begin try<br />		--新增<br />		if(@DataTable_Action_='Insert')<br />		begin<br />			insert into Infos(Name) values(@Name)<br />			select<br />			@ReturnValue = SCOPE_IDENTITY()<br />		end</p>
<p>		--删除<br />		if(@DataTable_Action_='Delete')<br />		begin<br />			delete Infos where Id=@Id<br />			set @ReturnValue = @@REMSERVER<br />		end<br />	commit tran</p>
<p>end try<br />begin catch<br />rollback tran<br />end catch<br />select<br />	@ReturnValue</p>
<p><br />exec Infos_InsertUpdateDelete @Id,@AId,@DId,@Ceng,@HomeNum,@FSize,@JSize,@HId,@JieGou,@Address,@Path,@XingZhi,@States,@DataTable_Action_</p>
<p>&nbsp;</p>
<p><strong>2、查询分页&mdash;通用存储过程</strong></p>
<p>Create PROC [dbo].[ProcPageList] (<br />    @pageSize INT = 20,					--每页记录数<br />    @pageNo INT =1,						--当前页<br />	@tableName VARCHAR(50),				--表名<br />    @whereString VARCHAR(800) = ' 1=1 ',--WHERE条件<br />	@orderString VARCHAR(200),			--排序条件(倒序需要带desc)<br />	@recordTotal INT OUTPUT       --输出记录总数<br />)<br />AS<br />BEGIN<br />     DECLARE @tempSql NVARCHAR(4000)<br />     --输出参数@recordTotal为总记录数<br />     SET @tempSql = N'select @recordTotal = count(*) from ' + @tableName + ' where '+ @whereString<br />	 EXEC sp_executesql @tempSql,N'@recordTotal INT OUTPUT',@recordTotal OUTPUT<br />     --主查询返回结果集<br />	 SET @tempSql = N'select * from (select *,Row_number() over(order by '+@orderString+') as rows from '+@tableName+' WHERE '+@whereString+') as main_temp where rows BETWEEN '+ convert(varchar(100),(@pageNo - 1) * @pageSize+ 1) + ' and ' + convert(varchar(100),@pageNo * @pageSize)<br />     EXEC(@tempSql)<br />END</p>
<p>&nbsp;</p>
<p><strong>3、比较完整的查询分页存储过程</strong></p>
<p>create PROCEDURE [dbo].[commonPagination]<br />@columns varchar(500), --要显示的列名，用逗号隔开&nbsp;<br />@tableName varchar(100), --要查询的表名&nbsp;<br />@orderColumnName varchar(100), --排序的列名&nbsp;<br />@order varchar(50), --排序的方式，升序为asc,降序为 desc&nbsp;<br />@where varchar(100), --where 条件，如果不带查询条件，请用 1=1&nbsp;<br />@pageIndex int, --当前页索引&nbsp;<br />@pageSize int, --页大小(每页显示的记录条数)&nbsp;<br />@pageCount int out --总页数，输出参数&nbsp;<br />as&nbsp;<br />begin&nbsp;<br />declare @sqlRecordCount nvarchar(1000) --得到总记录条数的语句&nbsp;<br />declare @sqlSelect nvarchar(1000) --查询语句&nbsp;<br />set @sqlRecordCount=N'select @recordCount=count(*) from ' +@tableName + ' where '+ @where&nbsp;<br /><br />declare @recordCount int --保存总记录条数的变量&nbsp;<br />exec sp_executesql @sqlRecordCount,N'@recordCount int output',@recordCount output&nbsp;<br /><br />--动态 sql 传参&nbsp;<br />if( @recordCount % @pageSize = 0) --如果总记录条数可以被页大小整除&nbsp;<br />set @pageCount = @recordCount / @pageSize --总页数就等于总记录条数除以页大小&nbsp;<br />else --如果总记录条数不能被页大小整除&nbsp;<br />set @pageCount = @recordCount / @pageSize + 1 --总页数就等于总记录条数除以页大小加1&nbsp;<br /><br />set @sqlSelect =&nbsp;<br />N'select '+@columns+' from (&nbsp;<br />select row_number() over (order by '&nbsp;<br />+@orderColumnName+' '+@order&nbsp;<br />+') as tempid,* from '&nbsp;<br />+@tableName+' where '+ @where&nbsp;<br />+') as tempTableName where tempid between '&nbsp;<br />+str((@pageIndex - 1)*@pageSize + 1 )&nbsp;<br />+' and '+str( @pageIndex * @pageSize)&nbsp;<br />exec (@sqlSelect) --执行动态Sql&nbsp;<br />end</p>
<p>1.鼠标悬浮到方法后</p>
<p>2.Ctrl+Enter打开操作列表</p>
<p>3.选择[Mybatis] Generate @Param自动生成@Param()</p>
<p><img src="https://img2018.cnblogs.com/blog/1506487/201811/1506487-20181122150809740-1058098092.png" alt="" /></p>
<p>4.说明:@Param("参数名"),表示给参数命名,名称就是括号中的内容</p>
<p><a>https://www.cnblogs.com/yinheyi/p/6648242.html</a></p>
<p><strong>本文发表于《中国数字医学》2018.4</strong></p>
<p><strong>摘要：目的：</strong>为维和医疗分队定制一套贴合业务需求的患者信息管理系统，用信息化手段辅助维和医疗分队实现从粗放式管理向精细化管理的转变。<strong>方法：</strong>在南苏丹瓦乌任务区完成需求分析，结合任务区实际现场设计及开发，及时响应用户新需求，多版本快速迭代。使用java语言，MySql数据库，后台采用Spring + SpringMVC + Hibernate开发框架，前台采用Html5+Easyui框架，以IntelliJ idea为开发工具，开发B/S模式的信息管理系统。根据任务区现地情况，采用无线+有线局域网相结合的方式组网。利用Vmware虚拟化技术搭设数据和网站服务器。<strong>结果：</strong>完成了维和医疗分队患者信息管理系统的设计与开发，该系统已在南苏丹瓦乌中国2级医院正常运行。<strong>结论：</strong>维和医疗分队信息管理系统填补了我国和所有联合国出兵国在维和任务中信息系统的空白，把维和医疗分队的工作模式从纸质手工记录转变为信息系统管理，把医疗人员从繁重的手工报表统计工作中解放出来，把维和分队信息化水平提升了一个维度，发现并解决了历史数据一致性的问题，制定了规范的医疗数据标准，把数据转化为信息，把信息转变为知识，为医疗辅助决策打下基础，为医疗大数据分析和智慧医疗提供了可能性。</p>
<p><strong>关键词：</strong>维和 医疗分队 信息管理系统</p>
<p><strong>1&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong>引言</strong></p>
<p>中国自1990年开始参加联合国维和任务，已是维和中坚力量。笔者所在的南苏丹瓦乌二级医院承担着联合国所有人员包括出兵国医疗救治和对部分难民的人道主义救援工作。自2016年，由联合国雇员组成的一级诊所已依托互联网，部署了医疗信息系统。但由各出兵国组建的各级医院在信息系统建设上仍属空白。笔者作为第8批赴南苏丹维和医疗分队通讯工程师，在2017年9月底抵达南苏丹瓦乌任务区后进行需求分析，系统和数据库设计，制定开发规范与文档，利用虚拟化技术搭建数据和业务服务器，铺设无线、有线相结合的局域网，使用java语言，MySql数据库，后台采用Spring + SpringMVC + Hibernate开发框架，前台采用Html5+Easyui框架，以IntelliJ idea为开发工具，开发B/S模式的医院信息管理系统，该系统于2017年12月初正式投入使用，已具有患者登记，信息管理，检查、检验等项目记录与计价，门急诊、住院等各种报表的自动生成，医疗数据查询、统计与分析等功能。在使用中，根据进一步需求继续开发，快速迭代版本，完善功能，做到一切业务都是数据，一切数据体现业务。在任务期内完成需求分析到信息系统落地的全过程，不断感知来自真实业务的反馈，不断的自我修正，迭代更新功能，积累数据，是任务区信息系统建设较好的实践方式，本文将提供任务区信息系统架设的完整解决方案。</p>
<p><strong>2&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong>系统</strong><strong>设计</strong></p>
<p><strong>2.1&nbsp;&nbsp; </strong><strong>基础设施建设</strong></p>
<p>结合瓦乌中国2级医院医疗区现地状况，铺设无线结合有线的局域网络，利用3部TP-LINK TL-WDR6500 1300M 11AC双频无线路由器桥接，信号覆盖整个医疗区，将门诊部、住院部、药房及各检查、检验、特诊科室网络打通。结合医疗区每日不定时换电实际，以Lenovo天逸510 Pro商用台式机(CPU i7-7700+16G内存+128G SSD)+UPS作为虚拟机Vmware WorkStation实体宿主，搭建数据库+业务服务器。</p>
<p><strong>2.2&nbsp;&nbsp; </strong><strong>需求分析</strong></p>
<p>以门诊登统记等医疗需求为抓手，结合国内HIS、LIS、PACS、RIS等信息系统经验，充分考虑系统的扩展性，综合考虑完成基础需求分析，进行初级版开发，快速上线，在系统使用中根据进一步需求迅速迭代产品，完善功能。</p>
<p><strong>2.3&nbsp;&nbsp; </strong><strong>系统构架、数据库设计与开发规范</strong></p>
<p>系统构架：后台采用Spring + SpringMVC + Hibernate开发框架，前台采用Html5+Easyui框架，分为UI层，Control层，Service层，Dao层与实体层。使用Vmware WorkStation虚拟化服务器，提供MySQL数据库服务和Tomcat网站服务。（如图1）</p>
<p align="center">&nbsp;<img src="https://img2018.cnblogs.com/blog/276251/201811/276251-20181122150701022-1954587432.png" alt="" /></p>
<p align="center">图1系统构架图</p>
<p align="center">&nbsp;</p>
<p>数据库设计：采用MySQL5.7数据库，在满足数据库设计范式的基础上，参造军卫一号数据结构进行信息系统的数据结构设计，形成数据结构手册。主要涉及表如下:（表1）</p>
<div align="center">
<table border="1" cellspacing="0" cellpadding="0">
<tbody>
<tr>
<td valign="top" width="136">
<p>表名</p>
</td>
<td valign="top" width="166">
<p>描述</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Pat_master_index</p>
</td>
<td valign="top" width="166">
<p>患者基本信息</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Pat_info</p>
</td>
<td valign="top" width="166">
<p>患者就诊信息</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>InPatient_info</p>
</td>
<td valign="top" width="166">
<p>住院患者信息</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Pat_item</p>
</td>
<td valign="top" width="166">
<p>计价项目记录</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Item_dict</p>
</td>
<td valign="top" width="166">
<p>计价项目字典</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Exam_apply</p>
</td>
<td valign="top" width="166">
<p>检查申请</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Exam_report</p>
</td>
<td valign="top" width="166">
<p>检查报告</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Exam_dict</p>
</td>
<td valign="top" width="166">
<p>检查字典</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Lab_apply</p>
</td>
<td valign="top" width="166">
<p>检验申请</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Lab_report</p>
</td>
<td valign="top" width="166">
<p>检验报告</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Lab_dict</p>
</td>
<td valign="top" width="166">
<p>检验字典</p>
</td>
</tr>
<tr>
<td valign="top" width="136">
<p>Users</p>
</td>
<td valign="top" width="166">
<p>用户管理</p>
</td>
</tr>
</tbody>
</table>
</div>
<p align="center">表1</p>
<p align="left">每天16:00利用脚本对MySQL数据库进行热备份完成本地备份，并传输数据至开发环境实现异地备份和业务重现，笔者任务期结束回国后仍能根据后续维和医疗分队交付的MySQL数据库文件重现任务区业务场景，对系统进行持续维护。</p>
<p align="left">开发规范：</p>
<p align="left">1）mvc开发框架的选用:spring3.2.8 + springmvc3.2.8 + hibernate4.1.7 + easyui1.3.4）。</p>
<p align="left">2）约束开发分层,保证代码的高聚合、低耦合。</p>
<p align="left">UI层：JSP用户页面。</p>
<p align="left">Controller层：业务模块流程控制，package命名为com.xforce.controller</p>
<p align="left">Service层： 业务逻辑层，package命名为com.xforce.service</p>
<p align="left">Dao层：数据持久层，package命名为com.xforce.dao</p>
<p align="left">实体层： Hibernate Mapping和持久化实体类，package命名为com.xforce.entity</p>
<p align="left">3）Http请求与URI表达符合RESTful风格。</p>
<p align="left">4）命名规范</p>
<p align="left">所有命名均为英文，望文知义；</p>
<p align="left">类命名首字母大写，多个单词每个单词首字母大写，位置对应于相应package下；</p>
<p align="left">JSP命名均小写，位置对应于相应功能的文件夹下；</p>
<p align="left">变量与函数采用驼峰原则命名。</p>
<p align="left">5）开发文档</p>
<p align="left">根据开发进度实时书写开发过程文档与流程测试文档。</p>
<p align="left">参照《阿里巴巴java开发手册》，从编程规约、 异常日志、数据库规约、工程规约四个方面较细致的制定规范。</p>
<p><strong>3&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong>功能设计</strong></p>
<p>本系统在功能上分为患者登记，门诊患者信息管理，急诊患者信息管理，住院患者信息管理，医疗数据统计与分析，系统管理六个功能模块（如图2）。已实现患者登记，患者信息管理，计价项目记录，药品管理，检查、检验申请与报告，统计分析，多种中英文医疗报表自动生成等功能（如图3），不同用户身份针对不同模块进行权限控制。在后续的迭代开发中，拟实现电子病历，手术麻醉，与其他系统的对接，医疗数据挖掘利用与辅助决策，针对任务区特点为交叉学科提供数据支持。</p>
<p align="center"><img src="https://img2018.cnblogs.com/blog/276251/201811/276251-20181122150722835-6549376.png" alt="" />&nbsp;</p>
<p align="center">图2 系统功能模块图</p>
<p align="center"><img src="https://img2018.cnblogs.com/blog/276251/201811/276251-20181122150731919-1068316475.png" alt="" />&nbsp;</p>
<p align="center">图3 系统界面</p>
<p align="center">&nbsp;</p>
<p><strong>4&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </strong><strong>总结与讨论</strong></p>
<p><strong>4.1&nbsp;&nbsp; </strong><strong>总结</strong></p>
<p>信息系统相较传统手工记录的模式的优势在此不再赘述。&ldquo;军字一号&rdquo;是全军医院使用的大型综合型医院管理信息系统，其网络结构复杂，功能繁多，适合中心医院以上规模医院使用。国内多有野战医疗所信息管理系统的开发报道，但立足于国内抢险救灾、处突维稳时医疗所展开时临时使用，既定项目并不适合维和任务区各级医院所需。维和医疗分队在特定地域展开，虽有轮换派遣制度，但对医疗工作及管理信息本身却要求具有连续性、完整性和准确性。维和任务区条件艰苦，网络和计算机软硬件资源紧张，维和队员中开发人员稀缺，信息系统需在任务期内完成开发并上线实际使用，积累数据，检验效果。本系统在第八批赴南苏丹维和医疗分队抵达任务区2个月内即根据任务区实际医疗流程完成了基础模块的开发并上线使用，填补了出兵国医疗信息系统的空白，是军队医院信息系统的有效延伸<sup>[1]</sup>。</p>
<p>在系统使用过程中，发现医疗分队在传统手工记录模式下，门诊、急诊、住院部、医疗助理办各部门对患者登记信息，诊断信息，检查、检验等信息的记录均存在标准不统一的问题，甚至在门诊部的不同统计表中，对患者身份、诊断等信息的记录都存在这个问题。信息系统上线后，制定了统一的数据标准，解决了数据一致性的问题，给医疗质控管理提供依据，为维和医疗分队从粗放型管理转向精细化管理提供信息化支持。</p>
<p>系统可选择中文版本或是英文版本，分别针对中国医疗分队使用和向其他出兵国分队推广。</p>
<p>在任务期内，医疗专家可根据任务区患者特点，积累相关数据，开展医疗信息交叉学科。及时的收集科研需求，迭代开发，更新系统，把数据转化为信息，把信息转化为知识。数据将带回国内和交接给下批维和分队，继续挖掘利用。</p>
<p><strong>4.2&nbsp;&nbsp; </strong><strong>展望</strong></p>
<p>患者信息管理系统的落地，跨越了任务区信息系统从0到1的阶段，然而任务区信息化建设从1到100的过程还大有可为。</p>
<p>电子病历、手术麻醉、医疗数据利用与挖掘、辅助决策等功能模块尚未完成，仍处于迭代开发阶段。</p>
<p>由于时间与精力的限制，目前任务区的药库管理和耗材管理分别采用的是&ldquo;军字一号&rdquo;中的药库管理和物资管理程序，下一步考虑维和医疗分队信息管理系统与这两个系统以及其他第三方系统的对接，实现系统对MySQL、Oracle、Sqlserver等多种数据库的兼容，在实现医疗全流程信息化的同时实现维和医疗分队卫勤保障行动各个环节的全面信息化。</p>
<p><strong>4.3&nbsp;&nbsp; </strong><strong>结语</strong></p>
<p>在中国包括各其他国家维和分队部署针对任务区实际，统一数据标准的维和分队信息管理系统，对维和行动各环节产生的信息进行全面的数字化采集、存储、传输、利用和共享，通过对数据进行挖掘分析，给联合国、各国维和局和分队自身后续维和人员分配、资源配备等部署等情况提供强有力的数据支持和科学依据，从多维度提升保障能力。维和医疗分队患者信息管理系统按照联合国维和卫勤保障任务要求，紧贴我军维和医疗分队执行维和卫勤任务实际需求，对维和卫勤保障行动的各个环节进行全程综合的信息化管理，充分应用信息化手段提高了综合救治能力。该系统的研发与使用对提升军队医院遂行多样化军事卫勤保障任务有重要借鉴意义<sup>[2]</sup>。期望维和医疗分队的信息化建设能够一定程度的推动联合国维和任务，为南苏丹乃至非洲做出贡献。</p>
<p align="center"><strong>&nbsp;</strong></p>
<p align="center"><strong>参考文献</strong></p>
<p align="center"><strong>&nbsp;</strong></p>
<p>[1] 肖丽佳，胡剑超，唐斌. 门诊挂号系统在维和医院中的应用[J]. 解放军医院管理，2014，18（5）：447-448.</p>
<p>[2] 周睿，黄田海，李毅志. 维和卫勤指挥管理系统的研究与实现[J]. 医疗卫生装备，2016，37（3）：30-32.</p>
<p>[3] 冉建鹏. 我军维和分队医疗管理系统的设计与实践[D]. 第三军医大学，2015.</p>
<p>[4] 周睿，代剑，刘富春. 维和医疗分队药品管理系统的设计与研发[J]. 中国药房，2017，28（10）：1375-1378.</p>
<p>[5] 李永革，张小东. 国际维和医疗分队训练管理与考评系统[J]. 中国数字医学，2014，1（20）：67-68.</p>
<div class="cnblogs_Highlighter">
<pre class="brush:csharp;gutter:true;">//检测端口是否使用
public static bool VerifyListenerPort(int port)
{
	bool inUse = false;
	System.Net.NetworkInformation.IPGlobalProperties ipProperties = System.Net.NetworkInformation.IPGlobalProperties.GetIPGlobalProperties();
	IPEndPoint[] ipEndPoints = ipProperties.GetActiveTcpListeners();
	if (port &gt; 65535) return true;// 超出范围
	foreach (IPEndPoint endPoint in ipEndPoints)
	{
		if (endPoint.Port == port)
		{
			inUse = true;
			break;
		}
	}
	return inUse;
}


public class rep_QueryACLReviewHistInfo
    {
        private int _result;
        private string _errorDesc = "";
        private long _histListNo;
        private static int MAX_REVIEW_HIST_CNT = 100;
        private ArrayWrapper&lt;Typ_ACLReviewHistInfo&gt; _histList = new ArrayWrapper&lt;Typ_ACLReviewHistInfo&gt;(MAX_REVIEW_HIST_CNT);

        public int result
        {
            get { return _result; }
            set { _result = value; }
        }

        public string errorDesc
        {
            get { return _errorDesc; }
            set { _errorDesc = value; }
        }

        public long histListNo
        {
            get { return _histListNo; }
            set
            {
                if (value &gt; MAX_REVIEW_HIST_CNT)
                {
                    throw new Exception("histListNo must be less than MAX_REVIEW_HIST_CNT (100).");
                }
                _histListNo = value;
            }
        }

        public ArrayWrapper&lt;Typ_ACLReviewHistInfo&gt; histList
        {
            get { return _histList; }
        }
    }
public static bool rqst_QueryReviewHistInfo_to_XMLObject(rqst_QueryACLReviewHistInfo userData, ref string xmlStr, out string errDesc)
        {
            bool funcResult = false;
            errDesc = "";
            StringBuilder tmpStr = null;
            StringWriter xmlWriter = null;
            XmlTextWriter textWriter = null;

            try
            {
                tmpStr = new StringBuilder(xmlStr);
                xmlWriter = new StringWriter();
                textWriter = new XmlTextWriter(xmlWriter);
                textWriter.WriteStartElement("msgBody");
                textWriter.WriteElementString("instanceSysId", userData.instanceSysId);
                textWriter.WriteElementString("reviewNo", userData.reviewNo.ToString());

                textWriter.WriteEndElement();
                xmlStr = tmpStr.Append(xmlWriter.ToString()).ToString();
                funcResult = true;
            }
            catch (Exception e)
            {
                errDesc = e.Message;
                funcResult = false;
            }
            finally
            {
                xmlWriter.Close();
                textWriter.Close();
            }

            return funcResult;
        }

        public static bool rep_QueryReviewHistInfo_from_XMLObject(string xmlStr, ref rep_QueryACLReviewHistInfo userData, out string errDesc)
        {
            bool funcResult = false;
            errDesc = "";
            StringReader xmlReader = null;
            XmlTextReader textReader = null;
            Dictionary&lt;string, bool&gt; dicFlag = null;
            bool OuterxmlFlag = false;

            try
            {
                xmlReader = new StringReader(xmlStr);
                textReader = new XmlTextReader(xmlReader);
                dicFlag = new Dictionary&lt;string, bool&gt;();
                int histListIndex = 0;

                while (!textReader.EOF)
                {
                    if (OuterxmlFlag == true)
                    {
                        OuterxmlFlag = false;
                    }
                    else
                    {
                        textReader.Read();
                    }

                    dicFlag[textReader.Name] = true;
                    if (textReader.IsEmptyElement)
                    {
                        continue;
                    }

                    if (textReader.NodeType == XmlNodeType.Element)
                    {
                        switch (textReader.Name)
                        {
                            case "result":
                                userData.result = int.Parse(textReader.ReadString());
                                break;

                            case "errorDesc":
                                userData.errorDesc = textReader.ReadString();
                                break;

                            case "histListNo":
                                userData.histListNo = int.Parse(textReader.ReadString());
                                break;

                            case "histList":
                                string tempStr = textReader.ReadOuterXml();
                                OuterxmlFlag = true;
                                Typ_ACLReviewHistInfo temp_Typ_ACLReviewHistInfo = new Typ_ACLReviewHistInfo();
                                if (MsgTyp.Typ_ACLReviewHistInfo_from_XMLObject(tempStr, ref temp_Typ_ACLReviewHistInfo, out errDesc))
                                {
                                    userData.histList[histListIndex] = temp_Typ_ACLReviewHistInfo;
                                    histListIndex++;
                                }
                                else
                                {
                                    return false;
                                }
                                break;
                        }
                    }
                }

                if (!dicFlag.ContainsKey("result"))
                {
                    errDesc = "rep_QueryACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'result' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("errorDesc"))
                {
                    errDesc = "rep_QueryACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'errorDesc' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("histListNo"))
                {
                    errDesc = "rep_QueryACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'histListNo' not found";
                    return funcResult;
                }

                if (userData.histListNo &gt; 0)
                {
                    if (!dicFlag.ContainsKey("histList"))
                    {
                        errDesc = "rep_QueryACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'histList' not found";
                        return funcResult;
                    }
                }

                funcResult = true;
            }
            catch (Exception e)
            {
                errDesc = e.Message;
                funcResult = false;
            }
            finally
            {
                xmlReader.Close();
                textReader.Close();
            }

            return funcResult;
        }

        public static bool Typ_ACLReviewHistInfo_from_XMLObject(string xmlStr, ref Typ_ACLReviewHistInfo userData, out string errDesc)
        {
            bool funcResult = false;
            errDesc = "";
            StringReader xmlReader = null;
            XmlTextReader textReader = null;
            Dictionary&lt;string, bool&gt; dicFlag = null;

            try
            {
                xmlReader = new StringReader(xmlStr);
                textReader = new XmlTextReader(xmlReader);
                dicFlag = new Dictionary&lt;string, bool&gt;();

                while (!textReader.EOF)
                {
                    textReader.Read();

                    dicFlag[textReader.Name] = true;
                    if (textReader.IsEmptyElement)
                    {
                        continue;
                    }

                    if (textReader.NodeType == XmlNodeType.Element)
                    {
                        switch (textReader.Name)
                        {
                            case "userId":
                                userData.userId = textReader.ReadString();
                                break;

                            case "activity":
                                userData.activity = textReader.ReadString();
                                break;

                            case "txnTime":
                                userData.txnTime = textReader.ReadString();
                                break;

                            case "txnComment":
                                userData.txnComment = textReader.ReadString();
                                break;

                            case "costTime":
                                userData.costTime = textReader.ReadString();
                                break;

                            case "choosedPathDesc":
                                userData.choosedPathDesc = textReader.ReadString();
                                break;

                            case "reviewNo":
                                userData.reviewNo = textReader.ReadString();
                                break;

                            case "stepSeq":
                                userData.stepSeq = textReader.ReadString();
                                break;

                            case "stepName":
                                userData.stepName = textReader.ReadString();
                                break;

                            case "txnSysId":
                                userData.txnSysId = textReader.ReadString();
                                break;
                        }
                    }
                }

                if (!dicFlag.ContainsKey("userId"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'userId' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("activity"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'activity' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("txnTime"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'txnTime' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("txnComment"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'txnComment' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("costTime"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'costTime' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("choosedPathDesc"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'choosedPathDesc' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("reviewNo"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'reviewNo' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("stepSeq"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'stepSeq' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("stepName"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'stepName' not found";
                    return funcResult;
                }

                if (!dicFlag.ContainsKey("txnSysId"))
                {
                    errDesc = "Typ_ACLReviewHistInfo_from_XMLObject: Parse from XML failed,item 'txnSysId' not found";
                    return funcResult;
                }

                funcResult = true;
            }
            catch (Exception e)
            {
                errDesc = e.Message;
                funcResult = false;
            }
            finally
            {
                xmlReader.Close();
                textReader.Close();
            }

            return funcResult;
        }

		
        public static void Typ_MsgHdr_to_XMLObject(Typ_MsgHdr userData, out string XmlMsgStr)
        {
            XmlMsgStr = "";

            try
            {
                XElement MsgHeader = XElement.Parse(SFWUtility.SFW_MSG_HEADER);
                MsgHeader.Element(SFWUtility.SFW_MSG_SRVADDR).Value = userData.SrvAddr;
                MsgHeader.Element(SFWUtility.SFW_MSG_REQADDR).Value = userData.ReqAddr;
                MsgHeader.Element(SFWUtility.SFW_MSG_MESSAGEOWNER).Value = userData.MsgOwner;
                MsgHeader.Element(SFWUtility.SFW_MSG_SERVERMETHOD).Value = userData.SrvMethod;
                MsgHeader.Element(SFWUtility.SFW_MSG_SERVERID).Value = userData.SrvId;
                MsgHeader.Element(SFWUtility.SFW_MSG_TIMESTAMP).Value = userData.TimeStamp.ToString();
                MsgHeader.Element(SFWUtility.SFW_MSG_TIMEOUT).Value = userData.Timeout.ToString();
                MsgHeader.Element(SFWUtility.SFW_MSG_TRANSID).Value = userData.TransId.ToString();
                MsgHeader.Element(SFWUtility.SFW_MSG_LOCALE).Value = userData.Locale;
                MsgHeader.Element(SFWUtility.SFW_MSG_RETCODE).Value = ((int)userData.RetCode).ToString();
                MsgHeader.Element(SFWUtility.SFW_MSG_RETMSG).Value = userData.RetMsg;
                XmlMsgStr = MsgHeader.ToString(SaveOptions.DisableFormatting);
            }
            catch (Exception e)
            {
                Log.WriteLog(MethodBase.GetCurrentMethod().ReflectedType.ToString() + ": " + MethodBase.GetCurrentMethod().Name + ": " + e.Message);
            }
        }

        public static void Typ_MsgHdr_from_XMLObject(string XmlMsgStr, out Typ_MsgHdr userData)
        {
            userData = new Typ_MsgHdr();
 
            try
            {
                XElement MsgHeader = XElement.Parse(XmlMsgStr);
                userData.SrvAddr = MsgHeader.Element(SFWUtility.SFW_MSG_SRVADDR).Value;
                userData.ReqAddr = MsgHeader.Element(SFWUtility.SFW_MSG_REQADDR).Value;
                userData.MsgOwner = MsgHeader.Element(SFWUtility.SFW_MSG_MESSAGEOWNER).Value;
                userData.SrvMethod = MsgHeader.Element(SFWUtility.SFW_MSG_SERVERMETHOD).Value;
                userData.SrvId = MsgHeader.Element(SFWUtility.SFW_MSG_SERVERID).Value;
                userData.TimeStamp = Convert.ToDateTime(MsgHeader.Element(SFWUtility.SFW_MSG_TIMEOUT).Value);
                userData.Timeout = int.Parse(MsgHeader.Element(SFWUtility.SFW_MSG_TIMEOUT).Value);
                userData.TransId = int.Parse(MsgHeader.Element(SFWUtility.SFW_MSG_TRANSID).Value);
                userData.Locale = MsgHeader.Element(SFWUtility.SFW_MSG_LOCALE).Value;
                userData.RetCode = int.Parse(MsgHeader.Element(SFWUtility.SFW_MSG_RETCODE).Value);
            }
            catch (Exception e)
            {
                Log.WriteLog(MethodBase.GetCurrentMethod().ReflectedType.ToString() + ": " + MethodBase.GetCurrentMethod().Name + ": " + e.Message);
            }
        }
</pre>
</div>
<p>　　</p>
#### 安装配置JDK

###### 下载安装
```
# 下载: 
wget --no-check-certificate --no-cookies --header "Cookie: oraclelicense=accept-securebackup-cookie" "https://download.oracle.com/otn-pub/java/jdk/8u191-b12/2787e4a523244c269598db4e85c51e0c/jdk-8u191-linux-x64.tar.gz"

# 解压
tar -zxvf jdk-8u191-linux-x64.tar.gz

sudo mkdir -pv /usr/java
cp -r jdk1.8.0_191/ /usr/java

# 配置环境变量
vi /etc/profile

--------------------- 
export JAVA_HOME=/usr/java/jdk1.8.0_111
export JRE_HOME=${JAVA_HOME}/jre  
export CLASSPATH=.:${JAVA_HOME}/lib:${JRE_HOME}/lib  
export PATH=${JAVA_HOME}/bin:$PATH  
--------------------- 
```

###### 判断配置是否生效


```
source /etc/profile  # 配置立即生效

root@yuubuntutest:~# java -version
java version "1.8.0_191"
Java(TM) SE Runtime Environment (build 1.8.0_191-b12)
Java HotSpot(TM) 64-Bit Server VM (build 25.191-b12, mixed mode)

```

#### 安装配置Tomcat

```
# 下载
wget http://mirrors.hust.edu.cn/apache/tomcat/tomcat-8/v8.5.35/bin/apache-tomcat-8.5.35.tar.gz

# 解压
tar xvzf apache-tomcat-8.5.35.tar.gz

# 管理
cd apache-tomcat-8.5.35/

sh bin/startup.sh # 打开tomcat

# 开启后可使用服务器IP:8080 端口访问Tomcat首页

sh bin/shutdown.sh # 关闭tomcat
```

#### 安装及配置Nginx


```
# 安装
sudo apt-get install nginx

# 启动Nginx
sudo /etc/init.d/nginx start

# 关闭Nginx
sudo /etc/init.d/nginx stop

```

#### Nginx配置Tomcat代理

```
 server {
        listen       80;
        server_name localhost;

        location / {
                proxy_pass http://127.0.0.1:8080;
                }
        }
} # 和http 元素在一个}内

```
<p>　本章介绍动态模型的设计过程，系统实例的动态模型用序列图来描述，首先介绍选择序列图的理由，最后分别设计各个用例主路径的序列图。本设计结果将充实和完善系统结构的表示服务层、商业上下文服务层、商业规则服务层、数据转化服务层和数据访问服务层的内容。</p>
<p>　　<strong>1、选择序列图</strong></p>
<p><strong>　　</strong>UML以图的形式提供了4种动态模型：序列图、协作图、状态图和活动图，序列图和协作图都是交互图。序列图是描述对象如何交互的，其中最重要的是时间，由于序列图于用例路径有关，所以在大多数动态建模中都要用到它。协作图也是描述对象交付的，但侧重于对象空间的协作，协作图是序列图的&ldquo;孪生兄弟&rdquo;，在序列图和协作图中可以任选一个，状态图只有在一个类具有复制的动态特性时才有用，多用于实时应用程序，大多数应用程序不需要状态图。活动图描述活动序列，适合表单工作流和并发处理。序列图可以清楚地描述一个用例路径的实现步骤，所以在系统设计中用得最多，其他3个图只有在需要的时候才使用，在办公自动化系统实例中，只用序列图就可以满足设计动态模型的需要。一个用例路径用一个序列图来描述，序列图中的消息序列来自用例路径选用的对象序列来自类图。</p>
<p><strong>　　2、选择序列图</strong></p>
<p><strong>　　</strong>我们以发文流程为例子，来讲解序列图的设计，新拟发文序列图如下：</p>
<p><img src="https://img2018.cnblogs.com/blog/1515898/201811/1515898-20181122150849094-1521973411.png" alt="" /></p>
<p>&nbsp;</p>
<p id="main-toc"><strong>目录</strong></p>
<p id="0.%E5%89%8D%E8%A8%80-toc"><a href="#0.%E5%89%8D%E8%A8%80" target="_self" data-cke-saved-href="#0.%E5%89%8D%E8%A8%80">0.引言</a></p>
<p id="1.DDD%E5%88%86%E5%B1%82-toc"><a href="#1.DDD%E5%88%86%E5%B1%82" target="_self" data-cke-saved-href="#1.DDD%E5%88%86%E5%B1%82">1.DDD分层</a></p>
<p id="2.ABP%E5%BA%94%E7%94%A8%E6%9E%84%E6%9E%B6%E6%A8%A1%E5%9E%8B-toc"><a href="#2.ABP%E5%BA%94%E7%94%A8%E6%9E%84%E6%9E%B6%E6%A8%A1%E5%9E%8B" target="_self" data-cke-saved-href="#2.ABP%E5%BA%94%E7%94%A8%E6%9E%84%E6%9E%B6%E6%A8%A1%E5%9E%8B">2.ABP应用构架模型</a></p>
<p id="%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F(Client%20Applications)-toc"><a href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F(Client%20Applications)" target="_self" data-cke-saved-href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F(Client%20Applications)">客户端应用程序(Client Applications)</a></p>
<p id="%E8%A1%A8%E7%8E%B0%E5%B1%82(Presentation%20Layer)-toc"><a href="#%E8%A1%A8%E7%8E%B0%E5%B1%82(Presentation%20Layer)" target="_self" data-cke-saved-href="#%E8%A1%A8%E7%8E%B0%E5%B1%82(Presentation%20Layer)">表现层(Presentation Layer)</a></p>
<p id="%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%B1%82(Distributed%20Service%20Layer)-toc"><a href="#%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%B1%82(Distributed%20Service%20Layer)" target="_self" data-cke-saved-href="#%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%B1%82(Distributed%20Service%20Layer)">分布式服务层(Distributed Service Layer)</a></p>
<p id="%E5%BA%94%E7%94%A8%E5%B1%82(Application%20Layer)-toc"><a href="#%E5%BA%94%E7%94%A8%E5%B1%82(Application%20Layer)" target="_self" data-cke-saved-href="#%E5%BA%94%E7%94%A8%E5%B1%82(Application%20Layer)">应用层(Application Layer)</a></p>
<p id="%E9%A2%86%E5%9F%9F%E5%B1%82-toc"><a href="#%E9%A2%86%E5%9F%9F%E5%B1%82" target="_self" data-cke-saved-href="#%E9%A2%86%E5%9F%9F%E5%B1%82">领域层</a></p>
<p id="%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E5%B1%82-toc"><a href="#%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E5%B1%82" target="_self" data-cke-saved-href="#%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E5%B1%82">基础设施层</a></p>
<p id="%E4%BD%BF%E7%94%A8ABP%E9%A1%B9%E7%9B%AE%E6%A8%A1%E7%89%88-toc"><a href="#%E4%BD%BF%E7%94%A8ABP%E9%A1%B9%E7%9B%AE%E6%A8%A1%E7%89%88" target="_self" data-cke-saved-href="#%E4%BD%BF%E7%94%A8ABP%E9%A1%B9%E7%9B%AE%E6%A8%A1%E7%89%88">3.使用ABP项目模版快速生成应用程序</a></p>
<hr id="hr-toc" />
<h1 id="0.%E5%89%8D%E8%A8%80">0.引言</h1>
<p>应用程序的分层是一种广泛接受的技术，&nbsp;可以降低复杂度和提高代码的可重用性。为了实现分层架构，ABP遵循领域驱动设计<strong>(DDD)</strong>原则。</p>
<h1 id="1.DDD%E5%88%86%E5%B1%82">1.DDD分层</h1>
<p>领域驱动设计有四个基本的层：</p>
<ul>
<li><span style="color: #00ccff;"><strong>表现层(Presentaiton Layer)：</strong></span>为用户提供接口。使用应用层实现与用户交互。</li>
<li><span style="color: #00ccff;"><strong>应用层(Application Layer)：</strong></span>表现层和领域层的中间者。协调业务对象以执行特定的应用程序任务。</li>
<li><span style="color: #00ccff;"><strong>领域层(Domain Layer)：</strong></span>包含业务对象和规则，是整个应用程序的核心。</li>
<li><span style="color: #00ccff;"><strong>基础设施层：</strong></span>提供支持上层通用的技术能力，大部分是借助于第三方库</li>
</ul>
<h1 id="2.ABP%E5%BA%94%E7%94%A8%E6%9E%84%E6%9E%B6%E6%A8%A1%E5%9E%8B">2.ABP应用构架模型</h1>
<p>除了DDD，现代的应用程序架构还包括逻辑和物理层等。如下图是ABP建议并实施的模型，它不仅通过提供基类和服务来快速实现这个模型，而且还提供了启动模板直接开始这个模型。</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="8"><img class="has cke_widget_element" src="https://raw.githubusercontent.com/aspnetboilerplate/aspnetboilerplate/master/doc/WebSite/images/abp-nlayer-architecture.png" alt="" data-cke-saved-src="https://raw.githubusercontent.com/aspnetboilerplate/aspnetboilerplate/master/doc/WebSite/images/abp-nlayer-architecture.png" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://raw.githubusercontent.com/aspnetboilerplate/aspnetboilerplate/master/doc/WebSite/images/abp-nlayer-architecture.png&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<h2 id="%E5%AE%A2%E6%88%B7%E7%AB%AF%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F(Client%20Applications)">客户端应用程序(Client Applications)</h2>
<p>远程客户端通过HTTP&nbsp;APIs（API&nbsp;Controllers,OData Controllers，GraphQL终端）等将应用程序作为服务。远程客户端可以是SPA、移动APP、或第三方消费者等。该应用程序主要包括本地化和导航功能。</p>
<h2 id="%E8%A1%A8%E7%8E%B0%E5%B1%82(Presentation%20Layer)">表现层(Presentation Layer)</h2>
<p>ASP.NET [Core] MVC可以认为是表现层。它可以是物理层(通过HTTP&nbsp;APIs使用应用程序)或是逻辑层(直接注入和使用应用服务)。无论是哪一种情况，一般包括本地化(Location)、导航(Navigation)、对象映射(Object Mapping)、缓存(Caching)、配置管理(Configuration Manager)、审计日志(Audit Logging)等等。还包括授权(Authorization)、会话(Session)、功能(Features，对于多租户应用程序)以及异常处理(Exception Handling)。</p>
<h2 id="%E5%88%86%E5%B8%83%E5%BC%8F%E6%9C%8D%E5%8A%A1%E5%B1%82(Distributed%20Service%20Layer)">分布式服务层(Distributed Service Layer)</h2>
<p>该层主要通过远程APIs(如REST、OData、GraphQL等)服务于应用服务/领域功能。该层只是将HTTP请求转换为领域交互，或可使用应用服务来委托操作，而并不包含业务逻辑。通常包括授权(Authorization)、缓存(Caching)、审计日志(Audit Logging)、对象映射(Object Mapping)、异常处理(Exception Handling)、会话(Session)等。</p>
<h2 id="%E5%BA%94%E7%94%A8%E5%B1%82(Application%20Layer)">应用层(Application Layer)</h2>
<p>应用层主要包括使用领域层和领域对象(领域服务、实体...)来执行应用程序功能请求的应用服务。应用层使用DTO(数据传输对象)从表现层或分布式服务层获取或返回数据。包括授权(Authorization)、缓存(Caching)、审计日志(Audit Logging)、对象映射(Object Mapping)、会话(Session)等。</p>
<h2 id="%E9%A2%86%E5%9F%9F%E5%B1%82">领域层</h2>
<p>这是实现领域逻辑主要的层，包括执行业务/领域逻辑的实体(Entities)、值对象(Value Objects)、和领域服务(Domain Services)。它还包括规约(Specifications)和触发领域事件(trigger Domain Events)，并定义了用于从数据源(通常是DBMS)读取和持久化实体的仓储接口(Repository Interfaces)。</p>
<h2 id="%E5%9F%BA%E7%A1%80%E8%AE%BE%E6%96%BD%E5%B1%82">基础设施层</h2>
<p>基础设施层用于辅助其它层：包括实现仓储接口(Repository Interfaces，如EF&nbsp;Core)实际操作数据库。还可能包括与供应商(vendor)的集成，以便发送电子邮件等。基础设施层是最下、也是不严格的一层，实际上是通过实现它们的抽象概念来支持其他层。</p>
<h1 id="%E4%BD%BF%E7%94%A8ABP%E9%A1%B9%E7%9B%AE%E6%A8%A1%E7%89%88"><span style="color: #ff9900;">3.使用ABP项目模版快速生成应用程序</span></h1>
<p>1.打开网址<a href="https://aspnetboilerplate.com/Templates" data-cke-saved-href="https://aspnetboilerplate.com/Templates">【Startup Templates】</a></p>
<p>2.依次选择ASP.NET Core 2.x&nbsp; &gt;&gt;&nbsp; .NET CORE(Cross Plateform)&nbsp; &nbsp;&gt;&gt;&nbsp; &nbsp;Multi Page Web Application，输入项目名称:XXX.FirstABP、验证码，点击创建项目按钮。</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="7"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122094502808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" alt="" width="1147" height="861" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122094502808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122094502808.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;1147&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;861&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​3.跳转自动下载源代码。</span></span></span></p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="6"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122095211530.png" alt="" width="651" height="94" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122095211530.png" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122095211530.png&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;651&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;94&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>4.解压并用Visual Studio 2017打开，启动程序后VS会自动还原项目所需要的包，wait for a minute......使用ABP项目模版生成的解决方案如下：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="5"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122095550852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" alt="" width="500" height="429" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122095550852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122095550852.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;500&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;429&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>5.设置【XXX.FirstABP.Web.MVC】为启动项目，打开appsetting.json文件修改连接字符串，如下：</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="4"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122100642949.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" alt="" width="1042" height="302" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122100642949.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122100642949.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;1042&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;302&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>6.打开【程序包管理控制台】，默认项目选择【XXX.FirstABP.EntityFrameworkCore】，在命令行依次输入:Add-Migration "FirstABP"、Update-Database，wait for a minute...</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="3"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122101036370.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" alt="" width="1020" height="238" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122101036370.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122101036370.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;1020&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;238&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>7.执行步骤6的操作后，默认生成了ABP的数据。</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="2"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122101216561.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" alt="" width="378" height="863" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122101216561.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122101216561.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;378&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;863&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>8.回到Visual Studio 2017，按F5运行程序...有惊喜哟，登录界面出现了，输入admin/123qwe，点击登录。</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="1"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122101450211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" alt="" width="557" height="518" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122101450211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122101450211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;557&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;518&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<p>9.如图，进入主界面。至此，利用ABP项目模板快速生成了应用程序，主要有租户管理、用户管理、角色管理等功能模块。</p>
<p><span class="cke_widget_wrapper cke_widget_inline cke_widget_image cke_image_nocaption cke_widget_selected" data-cke-widget-wrapper="1" data-cke-filter="off" data-cke-display-name="图像" data-cke-widget-id="0"><img class="has cke_widget_element" src="https://img-blog.csdnimg.cn/20181122102854707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" alt="" width="1100" height="589" data-cke-saved-src="https://img-blog.csdnimg.cn/20181122102854707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70" data-cke-widget-data="{&amp;quot;hasCaption&amp;quot;:false,&amp;quot;src&amp;quot;:&amp;quot;https://img-blog.csdnimg.cn/20181122102854707.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2x5bmNoZWU=,size_16,color_FFFFFF,t_70&amp;quot;,&amp;quot;alt&amp;quot;:&amp;quot;&amp;quot;,&amp;quot;width&amp;quot;:&amp;quot;1100&amp;quot;,&amp;quot;height&amp;quot;:&amp;quot;589&amp;quot;,&amp;quot;lock&amp;quot;:true,&amp;quot;align&amp;quot;:&amp;quot;none&amp;quot;,&amp;quot;classes&amp;quot;:{&amp;quot;has&amp;quot;:1}}" data-cke-widget-upcasted="1" data-cke-widget-keep-attr="0" data-widget="image" /><span class="cke_reset cke_widget_drag_handler_container"><img class="cke_reset cke_widget_drag_handler" title="点击并拖拽以移动" src="data:image/gif;base64,R0lGODlhAQABAPABAP///wAAACH5BAEKAAAALAAAAAABAAEAAAICRAEAOw==" alt="" width="15" height="15" data-cke-widget-drag-handler="1" /><span class="cke_image_resizer" title="点击并拖拽以改变尺寸">​</span></span></span></p>
<h1 id="">&nbsp;</h1>
<p>&nbsp;</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;2018年11月20日，深圳市共创力企业管理咨询有限公司杨学明老师受西安中石油股份有限公司的邀请， 为中石油系统研发系统各产品线总裁提供了为期半天的内训服务，主题为《打造高效的创新研发体系总裁班》。<br />      杨学明老师从为什么需要IPD,IPD的基本概念、IPD的流程架构、IPD在华为、IPD在中国等议题与总裁们进行了分享和研讨, 大部人的学员在课后表示受益匪浅，这是一次非常重新的创新思维转变的课程，组织方对此次课程的收益给予了高度评价,多位领导表示将与深圳共创力咨询密切合作,共同推动产品创新转型和企业变革。</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;<img src="https://img2018.cnblogs.com/blog/22578/201811/22578-20181122150805019-234012315.jpg" alt="" /></p>
<p><span style="color: #000000;"><strong><span style="font-size: 18pt;">装饰器</span></strong></span></p>
<p><span style="color: #000000;"><strong><span style="font-size: 18pt;">　　</span></strong><span style="font-size: 18pt;"><span style="font-size: 18px;">python装饰器就是 用于扩展原本函数功能的一种函数，这种函数返回值也是个函数。不改变原本函数代码的基础上 添加 新的功能&nbsp;</span></span></span></p>
<p><span style="color: #000000;"><span style="font-size: 18pt;"><span style="font-size: 18px;">　　&nbsp; &nbsp;<img src="https://img2018.cnblogs.com/blog/1522925/201811/1522925-20181122144935800-1113994552.png" alt="" /><br /></span></span></span></p>
<p><span style="color: #000000;"><span style="font-size: 18pt;"><span style="font-size: 18px;">　　&nbsp; &nbsp;我们原函数定义为 alter()。返回值赋给原函数 ，效果为执行 输出 语句 &ldquo;这里是原函数&rdquo;</span></span></span></p>
<p><span style="color: #000000;"><span style="font-size: 18pt;"><span style="font-size: 18px;">　　&nbsp; &nbsp;定义装饰器函数 add(f1) 嵌套一个函数alter2()。add(f1)函数效果为空 ，里面的 函数 alter2()效果为执行 输出语句 &ldquo;装饰器函数&rdquo; 返回值赋给原函数</span></span></span></p>
<p><span style="font-size: 18pt;"><span style="font-size: 18px;">　　&nbsp; &nbsp;&nbsp;</span></span></p>
<p>　　　　<span style="font-size: 18px;">执行。我们可以理解为 把原函数 赋值给add()的参数f1,然后执行add(alter),这时候我们执行的 是函数add(),并没有执行里面函数 alter2()，所以这时候我们可　以这样写：</span></p>
<p><span style="font-size: 18px;">　　方法一</span></p>
<p><span style="font-size: 18px;">　　　　f = add(alter)&nbsp; &nbsp; &nbsp;&nbsp;#这时候我们执行到了add(alter) 函数。没有执行 alter()</span></p>
<p><span style="font-size: 18px;">　　　　f()&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;#这时候执行了alter2()函数</span></p>
<p><span style="font-size: 18px;">　　　　这里是把函数 add(alter)赋值给f，在执行</span></p>
<p><span style="font-size: 18px;">　　　　这时候原函数会执行 2 次</span></p>
<p><span style="font-size: 18px;">　　　　<img src="https://img2018.cnblogs.com/blog/1522925/201811/1522925-20181122150832571-1458599816.png" alt="" /></span></p>
<p><span style="font-size: 18px;">　　　　这时候优化方法为 二</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 18px;">　　方法二</span></p>
<p><span style="font-size: 18px;">　　　　我们可以直接把 add(alter)赋值给alter:</span></p>
<pre><strong><span style="font-size: 18px;">　　  alter = add(alter)</span></strong><br /><span style="font-size: 18px;"><strong>　　  alter()</strong><br /><br /></span></pre>
<p><span style="font-size: 18px;">　　　　这时候是执行不看结果的 ，我们这里可以 把原函数 alter()&nbsp; 函数赋值 给 f1() 参数&nbsp; 所以。我这里在函数alter2()函数中调用 f1()</span></p>
<p><span style="font-size: 18px;">这时候：</span></p>
<p><span style="font-size: 18px;">　　　　<img src="https://img2018.cnblogs.com/blog/1522925/201811/1522925-20181122150251085-1521719534.png" alt="" /></span></p>
<p><span style="font-size: 18px;">　　　　</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 18px;">　　　　在上述代码中。比较混乱。我们这里优化一下。</span></p>
<p><span style="font-size: 18px;">　　　　在python中 。我们写好装饰器后，在给原函数优化的时候，只需要在原函数之前加上 @add ,这是 python 中的优化写法&nbsp;</span></p>
<p><span style="font-size: 18px;">　　　　</span></p>
<p>转发标签：&nbsp;&nbsp;&nbsp;&nbsp; &lt;jsp:forward /&gt;</p>
<p>参数标签：&nbsp; &lt;jsp:pararm/&gt;</p>
<p>包含标签：&nbsp; &lt;jsp:include/&gt;</p>
<p>&nbsp;原理： 包含与被包含的页面先各自翻译成java源文件，然后再运行时合并在一起。</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; （先翻译再合并），动态包含</p>
<p>静态包含&nbsp; vs&nbsp; 动态包含的区别？</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1） 语法不同</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 静态包含语法： &lt;%@inclue file="被包含的页面"%&gt;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 动态包含语法：　&lt;jsp:include page="被包含的页面"&gt;</p>
<p>&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2）参数传递不同</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 静态包含不能向被包含页面传递参数</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 动态包含可以向被包含页面传递参数</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 3）原理不同</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 静态包含： 先合并再翻译</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 动态包含： 先翻译再合并</p>
<hr />
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">@ page language</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">java</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> import</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">java.util.*</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> pageEncoding</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">utf-8</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>

<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span> 
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>动作标签<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>  
  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
  
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
    <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #f5f5f5; color: #000000;">转发 </span><span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
    <span style="background-color: #ffff00; color: #000000;">&lt;%</span>
        <span style="background-color: #f5f5f5; color: #000000;">//</span><span style="background-color: #f5f5f5; color: #000000;">request.getRequestDispatcher(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">/09.action2.jsp?name=eric</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">).forward(request,response);
     </span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
    <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #f5f5f5; color: #000000;"> 参数 </span><span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
    <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">--</span>
    <span style="background-color: #f5f5f5; color: #000000;">&lt;</span><span style="background-color: #f5f5f5; color: #000000;">jsp:forward page</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">/action2.jsp</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&gt;</span>
        <span style="background-color: #f5f5f5; color: #000000;">&lt;</span><span style="background-color: #f5f5f5; color: #000000;">jsp:param value</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">admin</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> name</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">name</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">/&gt;</span>
        <span style="background-color: #f5f5f5; color: #000000;">&lt;</span><span style="background-color: #f5f5f5; color: #000000;">jsp:param value</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">123456</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> name</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">password</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">/&gt;</span>
    <span style="background-color: #f5f5f5; color: #000000;">&lt;/</span><span style="background-color: #f5f5f5; color: #000000;">jsp:forward</span><span style="background-color: #f5f5f5; color: #000000;">&gt;</span>
      <span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
      
      <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #f5f5f5; color: #000000;">包含 </span><span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
      <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">--</span>
   <span style="background-color: #f5f5f5; color: #000000;">&lt;</span><span style="background-color: #f5f5f5; color: #000000;">jsp:include page</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">/common/header.jsp</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">&gt;</span>
           <span style="background-color: #f5f5f5; color: #000000;">&lt;</span><span style="background-color: #f5f5f5; color: #000000;">jsp:param value</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">lucy</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> name</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">name</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">/&gt;</span>
       <span style="background-color: #f5f5f5; color: #000000;">&lt;/</span><span style="background-color: #f5f5f5; color: #000000;">jsp:include</span><span style="background-color: #f5f5f5; color: #000000;">&gt;</span>
        <span style="background-color: #f5f5f5; color: #000000;">--</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
        <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">@include file</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">common/header.jsp</span><span style="background-color: #f5f5f5; color: #800000;">"</span> <span style="background-color: #ffff00; color: #000000;">%&gt;</span><span style="color: #000000;">
      主页的内容
     
  </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<hr />
<div class="cnblogs_code">
<pre><span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">@ page language</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">java</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> import</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">java.util.*</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;"> pageEncoding</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">utf-8</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>

<span style="color: #0000ff;">&lt;!</span><span style="color: #ff00ff;">DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span> 
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>动作标签<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">title</span><span style="color: #0000ff;">&gt;</span>  
  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">head</span><span style="color: #0000ff;">&gt;</span>
  
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
    <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">request.getParameter(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">name</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">)</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">br</span><span style="color: #0000ff;">/&gt;</span>
    <span style="background-color: #ffff00; color: #000000;">&lt;%</span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;">request.getParameter(</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #800000;">password</span><span style="background-color: #f5f5f5; color: #800000;">"</span><span style="background-color: #f5f5f5; color: #000000;">)</span><span style="background-color: #ffff00; color: #000000;">%&gt;</span>
  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">body</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">html</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>主控机 10.22.0.185 centos7</p>
<p>被控机 10.22.0.186 centos7</p>
<p>&nbsp;</p>
<p>一、主控机安装ansible&nbsp;</p>
<p>　　yum install -y ansible</p>
<p>&nbsp;</p>
<p>二、主控机生产秘钥</p>
<p>　　ssh-keygen -t rsa</p>
<p>&nbsp;</p>
<p>三、主控机编写ansible文件（这个才是重点）</p>
<p>　　3.1 取消每次敲命令输入密码参数&nbsp;</p>
<p>　　　　echo "export ANSIBLE_HOST_KEY_CHECKING=False" &gt;&gt;/etc/profile</p>
<p>　　　　source /etc/profile</p>
<p>&nbsp;</p>
<p>　　3.2 添加 /etc/ansible/key.yaml文件</p>
<div class="cnblogs_code">
<pre>---
-<span style="color: #000000;"> hosts: all
  tasks:
    </span>-<span style="color: #000000;"> name: Non secret authentication
      authorized_key: user</span>=root key=<span style="color: #800000;">"</span><span style="color: #800000;">{{ lookup('file', '~/.ssh/id_rsa.pub') }}</span><span style="color: #800000;">"</span>  state=present</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp; 　　3.3 /etc/ansible/hosts文件如下，将密码一同写入</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">[ssh]
</span><span style="color: #800080;">192.168</span>.<span style="color: #800080;">228</span>.[<span style="color: #800080;">126</span>:<span style="color: #800080;">170</span><span style="color: #000000;">]
[ssh:vars]
ansible_ssh_pass</span>=<span style="color: #800000;">"</span><span style="color: #800000;">123456</span><span style="color: #800000;">" #这个key是ansible默认的<br /></span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp; 四、执行命令</p>
<p>　　# ansible-playbook&nbsp; /etc/ansible/key.yml</p>
<p>&nbsp;</p>
<p>五、测试是否成功</p>
<p>　　ssh 10.22.0.186</p>
<p>&nbsp;</p>
<p>inventory内置参数，如下：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">ansible_ssh_host # 要连接的主机名
ansible_ssh_port # 端口号默认是22
ansible_ssh_user # ssh连接时默认使用的用户名
ansible_ssh_pass # ssh连接时的密码
ansible_sudo_pass # 使用sudo连接用户是的密码
ansible_ssh_private_key_file # 秘钥文件如果不想使用ssh</span>-<span style="color: #000000;">agent管理时可以使用此选项
ansible_shell_type # shell的类型默认sh
ansible_connection # SSH 连接的类型： local , ssh , paramiko在 ansible </span><span style="color: #800080;">1.2</span><span style="color: #000000;"> 之前默认是 paramiko ，后来智能选择，优先使用基于 ControlPersist 的 ssh （支持的前提）
ansible_python _ interpreter #用来指定 python 解释器的路径，同样可以指定ruby 、perl 的路径</span></pre>
</div>
<p>&nbsp;</p>
<p>1.CheckBLL</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;</p>
<p>namespace VacationOA.BLL<br />{<br />    using MODEL;<br />    using DAL;<br />    public class CheckBLL<br />    {<br />        TCheckDAL dal = new TCheckDAL();<br />        /// &lt;summary&gt;<br />        /// 添加审核清单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="tcheck"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int AddTcheck(TCheck tcheck)<br />        {<br />            return dal.AddTcheck(tcheck);<br />        }<br />        /// &lt;summary&gt;<br />        /// 根据假条id查询是否有关于这个假条审核通过的审核单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="id"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int GetCheckbyid(int id)<br />        {<br />            return dal.GetCheckbyid(id);</p>
<p>        } <br />         /// &lt;summary&gt;<br />          /// 根据id获取对应请假单的审核历史<br />          /// &lt;/summary&gt;<br />          /// &lt;returns&gt;&lt;/returns&gt;<br />        public List&lt;TCheck&gt; GetChecks(int id)<br />        {<br />            return dal.GetChecks(id);<br />        }<br />    }<br />}</p>
<p>2.LeaveBLL</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;</p>
<p>namespace VacationOA.BLL<br />{<br />    using MODEL;<br />    using DAL;<br />  public  class LeaveBLL<br />    {<br />        LeaveDAL dal = new LeaveDAL();<br />        /// &lt;summary&gt;<br />        /// 添加请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int AddLeave(Leave l)<br />        {<br />            return dal.AddLeave(l);<br />        }<br />        /// &lt;summary&gt;<br />        /// 修改请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int updateleave(Leave l)<br />        {<br />            return dal.updateleave(l);<br />        }<br />        /// &lt;summary&gt;<br />        /// 获取请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public List&lt;Leave&gt; GetLeaves()<br />        {<br />            return dal.GetLeaves();<br />        }<br />        /// &lt;summary&gt;<br />        /// 修改请假单的状态，审核时间，说明，<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int updateleaveState(int id, DateTime checktime, string explain, string state)<br />        {<br />            return dal.updateleaveState(id, checktime, explain, state);<br />        }<br />        /// &lt;summary&gt;<br />        /// 获取请假单 我的审核列表<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public List&lt;Leave&gt; GetLeavesCheck()<br />        {<br />            return dal.GetLeavesCheck();<br />        }<br />    }<br />}</p>
<p>3.StaffBLL</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;</p>
<p>namespace VacationOA.BLL<br />{<br />    using MODEL;<br />    using DAL;<br />    public class StaffBLL<br />    {<br />        StaffDAL dal = new StaffDAL();<br />        public Staff LoginStaff(string name, string department)<br />        {<br />            return dal.LoginStaff(name, department);<br />        }<br />    }<br />}</p>
<h2>POI结构与常用类</h2>
<p>Apache POI是Apache软件基金会的开源项目，POI提供API给Java程序对Microsoft Office格式档案读和写的功能。 .NET的开发人员则可以利用NPOI (POI for .NET) 来存取 Microsoft Office文档的功能。</p>
<p><strong>包名称说明</strong></p>
<ul>
<li>HSSF提供读写Microsoft Excel XLS格式档案的功能。</li>
<li>XSSF提供读写Microsoft Excel OOXML XLSX格式档案的功能。</li>
<li>HWPF提供读写Microsoft Word DOC格式档案的功能。</li>
<li>HSLF提供读写Microsoft PowerPoint格式档案的功能。</li>
<li>HDGF提供读Microsoft Visio格式档案的功能。</li>
<li>HPBF提供读Microsoft Publisher格式档案的功能。</li>
<li>HSMF提供读Microsoft Outlook格式档案的功能。</li>
</ul>
<p>&nbsp;</p>
<h2>测试例子</h2>
<p>测试模板：</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/blog/755765/201811/755765-20181122151123472-1369684886.png" alt="" width="398" height="154" /></p>
<p>测试代码：</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">@Test
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span> docxExportTest() <span style="color: #0000ff;">throws</span><span style="color: #000000;"> IOException {
        InputStream is </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        FileOutputStream fos </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            </span><span style="color: #008000;">//</span><span style="color: #008000;">获取docx解析对象</span>
            is = <span style="color: #0000ff;">new</span> FileInputStream("F:\\document\\咨询服务合同.docx"<span style="color: #000000;">);
            XWPFDocument document </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XWPFDocument(is);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">组装参数</span>
            File seal = <span style="color: #0000ff;">new</span> File("F:\\imgtest\\1.jpg"<span style="color: #000000;">);
            Map</span>&lt;String, Object&gt; sealMap = <span style="color: #0000ff;">new</span> HashMap&lt;String, Object&gt;<span style="color: #000000;">();
            sealMap.put(</span>"width", 50<span style="color: #000000;">);
            sealMap.put(</span>"height", 50<span style="color: #000000;">);
            sealMap.put(</span>"type", "jpg"<span style="color: #000000;">);
            sealMap.put(</span>"content", <span style="color: #0000ff;">new</span><span style="color: #000000;"> FileInputStream(seal));

            Map</span>&lt;String, Object&gt; contentMap = <span style="color: #0000ff;">new</span> HashMap&lt;&gt;<span style="color: #000000;">();
            contentMap.put(</span>"part_a", "张三"<span style="color: #000000;">);
            contentMap.put(</span>"address_a", "青岛市市南区动漫产业园E座"<span style="color: #000000;">);
            contentMap.put(</span>"legal_person_a", "李四"<span style="color: #000000;">);
            contentMap.put(</span>"seal"<span style="color: #000000;">, sealMap);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">解析替换段落文本对象</span>
<span style="color: #000000;">            XWPFUtil.changeParagraph(document, contentMap);

            </span><span style="color: #008000;">//</span><span style="color: #008000;">生成新的word文档</span>
            SimpleDateFormat sdf = <span style="color: #0000ff;">new</span> SimpleDateFormat("yyyy-MM-dd"<span style="color: #000000;">);
            String fileName </span>= "咨询服务合同" + sdf.format(<span style="color: #0000ff;">new</span> Date()) + ".docx"<span style="color: #000000;">;
            File file </span>= <span style="color: #0000ff;">new</span> File("F://" +<span style="color: #000000;"> fileName);
            fos </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> FileOutputStream(file);
            document.write(fos);

        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {
            e.printStackTrace();
        } </span><span style="color: #0000ff;">finally</span><span style="color: #000000;"> {
            </span><span style="color: #0000ff;">if</span> (is != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                is.close();
            }
            </span><span style="color: #0000ff;">if</span> (fos != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                fos.close();
            }
        }
    }</span></pre>
</div>
<p>工具类：</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('bab1aa99-2269-4ab7-a352-92003cc7aed2')"><img id="code_img_closed_bab1aa99-2269-4ab7-a352-92003cc7aed2" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_bab1aa99-2269-4ab7-a352-92003cc7aed2" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('bab1aa99-2269-4ab7-a352-92003cc7aed2',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_bab1aa99-2269-4ab7-a352-92003cc7aed2" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.m2plat.puhui.utils;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.alibaba.fastjson.JSON;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.apache.commons.io.IOUtils;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.apache.poi.xwpf.usermodel.XWPFDocument;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.apache.poi.xwpf.usermodel.XWPFParagraph;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.apache.poi.xwpf.usermodel.XWPFRun;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.apache.xmlbeans.XmlException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.apache.xmlbeans.XmlToken;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.openxmlformats.schemas.drawingml.x2006.main.CTNonVisualDrawingProps;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.openxmlformats.schemas.drawingml.x2006.main.CTPositiveSize2D;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.openxmlformats.schemas.drawingml.x2006.wordprocessingDrawing.CTInline;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.Logger;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.LoggerFactory;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.springframework.core.io.ClassPathResource;

</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.FileInputStream;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.InputStream;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.OutputStream;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.List;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.util.Map;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * Created by xiangzh on 2018/11/1.
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> XWPFUtils {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> Logger logger = LoggerFactory.getLogger(XWPFUtils.<span style="color: #0000ff;">class</span><span style="color: #000000;">);

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 根据模板生成word文档
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> os
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> tempPath
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> contentMap
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> writeTemp(OutputStream os, String tempPath, Map&lt;String, Object&gt;<span style="color: #000000;"> contentMap){
        logger.info(</span>"---根据模板生成word文档"<span style="color: #000000;">);
        logger.info(</span>"---模板地址：{}"<span style="color: #000000;">,tempPath);
        logger.info(</span>"---替换内容：{}"<span style="color: #000000;">, JSON.toJSONString(contentMap));
        ClassPathResource resource </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ClassPathResource(tempPath);
        </span><span style="color: #0000ff;">if</span>(resource == <span style="color: #0000ff;">null</span> || !<span style="color: #000000;">resource.exists()){
            logger.error(</span>"---模板文件不存在，tempPath：{}"<span style="color: #000000;">,tempPath);
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
        }

        InputStream is </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;">{
            is </span>=<span style="color: #000000;"> resource.getInputStream();
            XWPFDocument document </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> XWPFDocument(is);
            XWPFUtils.changeParagraph(document, contentMap);
            </span><span style="color: #008000;">//</span><span style="color: #008000;">生成新的word文档</span>
<span style="color: #000000;">            document.write(os);
        }</span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException e){
            logger.error(</span>"---输出word文档失败,原因：{}"<span style="color: #000000;">,e.getMessage());
        }</span><span style="color: #0000ff;">finally</span><span style="color: #000000;"> {
            IOUtils.closeQuietly(is);
        }
    }


    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 替换段落文本
     *
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> document docx解析对象
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> textMap  需要替换的信息集合
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> changeParagraph(XWPFDocument document, Map&lt;String, Object&gt;<span style="color: #000000;"> textMap) {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">获取段落集合</span>
        List&lt;XWPFParagraph&gt; paragraphs =<span style="color: #000000;"> document.getParagraphs();

        </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (XWPFParagraph paragraph : paragraphs) {
            List</span>&lt;XWPFRun&gt; runs =<span style="color: #000000;"> paragraph.getRuns();
            </span><span style="color: #0000ff;">for</span><span style="color: #000000;"> (XWPFRun run : runs) {
                String text </span>= run.getText(0<span style="color: #000000;">);
                </span><span style="color: #008000;">//</span><span style="color: #008000;">判断文本是否需要进行替换</span>
                <span style="color: #0000ff;">if</span><span style="color: #000000;"> (checkText(text)) {
                    </span><span style="color: #0000ff;">for</span> (Map.Entry&lt;String, Object&gt;<span style="color: #000000;"> entry : textMap.entrySet()) {
                        </span><span style="color: #008000;">//</span><span style="color: #008000;">匹配模板与替换值 格式${key}</span>
                        String key = "${" + entry.getKey() + "}"<span style="color: #000000;">;
                        Object value </span>=<span style="color: #000000;"> entry.getValue();

                        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (text.contains(key)) {
                            </span><span style="color: #0000ff;">if</span> (value <span style="color: #0000ff;">instanceof</span> String) { <span style="color: #008000;">//</span><span style="color: #008000;">文字替换</span>
                                text =<span style="color: #000000;"> text.replace(key, (String) value);
                            } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (value <span style="color: #0000ff;">instanceof</span> Map) { <span style="color: #008000;">//</span><span style="color: #008000;">图片替换</span>
                                text = text.replace(key, ""<span style="color: #000000;">);
                                Map picMap </span>=<span style="color: #000000;"> (Map) value;
                                </span><span style="color: #0000ff;">int</span> width = Integer.parseInt(picMap.get("width"<span style="color: #000000;">).toString());
                                </span><span style="color: #0000ff;">int</span> height = Integer.parseInt(picMap.get("height"<span style="color: #000000;">).toString());
                                </span><span style="color: #0000ff;">int</span> picType = getPictureType(picMap.get("type"<span style="color: #000000;">).toString());
                                FileInputStream fis </span>= (FileInputStream) picMap.get("content"<span style="color: #000000;">);
                                </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
                                    String blipId </span>=<span style="color: #000000;"> document.addPictureData(fis, picType);
                                    </span><span style="color: #0000ff;">int</span> id =<span style="color: #000000;"> document.getNextPicNameNumber(picType);
                                    XWPFUtils.createPicture(id, blipId, width, height, run);
                                } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (Exception e) {
                                    e.printStackTrace();
                                }
                            }
                        }
                    }
                    </span><span style="color: #008000;">//</span><span style="color: #008000;">替换模板原来位置</span>
                    run.setText(text, 0<span style="color: #000000;">);
                }
            }
        }
    }

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> id
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> blipId
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> width 宽
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> height 高
     //* </span><span style="color: #808080;">@param</span><span style="color: #008000;"> paragraph  段落
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span> createPicture(<span style="color: #0000ff;">int</span> id, String blipId, <span style="color: #0000ff;">int</span> width, <span style="color: #0000ff;">int</span><span style="color: #000000;"> height,XWPFRun xwpfRun) {
        </span><span style="color: #0000ff;">final</span> <span style="color: #0000ff;">int</span> EMU = 9525<span style="color: #000000;">;
        width </span>*=<span style="color: #000000;"> EMU;
        height </span>*=<span style="color: #000000;"> EMU;
        CTInline inline </span>=<span style="color: #000000;"> xwpfRun.getCTR().addNewDrawing().addNewInline();
        </span><span style="color: #008000;">//</span><span style="color: #008000;">CTInline inline = paragraph.createRun().getCTR().addNewDrawing().addNewInline(); </span><span style="color: #008000;">//</span><span style="color: #008000;">在遍历run列表的时候，创建新的run有可能会导致报错</span>
        String picXml = ""
                + "&lt;a:graphic xmlns:a=\"http://schemas.openxmlformats.org/drawingml/2006/main\"&gt;"
                + "   &lt;a:graphicData uri=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"&gt;"
                + "      &lt;pic:pic xmlns:pic=\"http://schemas.openxmlformats.org/drawingml/2006/picture\"&gt;"
                + "         &lt;pic:nvPicPr&gt;" + "            &lt;pic:cNvPr id=\""
                +<span style="color: #000000;"> id
                </span>+ "\" name=\"Generated\"/&gt;"
                + "            &lt;pic:cNvPicPr/&gt;"
                + "         &lt;/pic:nvPicPr&gt;"
                + "         &lt;pic:blipFill&gt;"
                + "            &lt;a:blip r:embed=\""
                +<span style="color: #000000;"> blipId
                </span>+ "\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\"/&gt;"
                + "            &lt;a:stretch&gt;"
                + "               &lt;a:fillRect/&gt;"
                + "            &lt;/a:stretch&gt;"
                + "         &lt;/pic:blipFill&gt;"
                + "         &lt;pic:spPr&gt;"
                + "            &lt;a:xfrm&gt;"
                + "               &lt;a:off x=\"0\" y=\"0\"/&gt;"
                + "               &lt;a:ext cx=\""
                +<span style="color: #000000;"> width
                </span>+ "\" cy=\""
                +<span style="color: #000000;"> height
                </span>+ "\"/&gt;"
                + "            &lt;/a:xfrm&gt;"
                + "            &lt;a:prstGeom prst=\"rect\"&gt;"
                + "               &lt;a:avLst/&gt;"
                + "            &lt;/a:prstGeom&gt;"
                + "         &lt;/pic:spPr&gt;"
                + "      &lt;/pic:pic&gt;"
                + "   &lt;/a:graphicData&gt;" + "&lt;/a:graphic&gt;"<span style="color: #000000;">;

        inline.addNewGraphic().addNewGraphicData();
        XmlToken xmlToken </span>= <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            xmlToken </span>=<span style="color: #000000;"> XmlToken.Factory.parse(picXml);
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (XmlException xe) {
            xe.printStackTrace();
        }
        inline.set(xmlToken);

        inline.setDistT(</span>0<span style="color: #000000;">);
        inline.setDistB(</span>0<span style="color: #000000;">);
        inline.setDistL(</span>0<span style="color: #000000;">);
        inline.setDistR(</span>0<span style="color: #000000;">);

        CTPositiveSize2D extent </span>=<span style="color: #000000;"> inline.addNewExtent();
        extent.setCx(width);
        extent.setCy(height);

        CTNonVisualDrawingProps docPr </span>=<span style="color: #000000;"> inline.addNewDocPr();
        docPr.setId(id);
        docPr.setName(</span>"docx_img_ " +<span style="color: #000000;"> id);
        docPr.setDescr(</span>"docx Picture"<span style="color: #000000;">);
    }

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 判断文本中是否包含$
     *
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> text 文本
     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> 包含返回true, 不包含返回false
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> checkText(String text) {
        </span><span style="color: #0000ff;">if</span> (text == <span style="color: #0000ff;">null</span> || ""<span style="color: #000000;">.equals(text)) {
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">return</span> text.contains("$"<span style="color: #000000;">);
    }

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * 根据图片类型，取得对应的图片类型代码
     *
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> picType
     * </span><span style="color: #808080;">@return</span><span style="color: #008000;"> int
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> getPictureType(String picType) {
        </span><span style="color: #0000ff;">int</span> res =<span style="color: #000000;"> XWPFDocument.PICTURE_TYPE_PICT;
        </span><span style="color: #0000ff;">if</span> (picType != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            </span><span style="color: #0000ff;">if</span> (picType.equalsIgnoreCase("png"<span style="color: #000000;">)) {
                res </span>=<span style="color: #000000;"> XWPFDocument.PICTURE_TYPE_PNG;
            } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (picType.equalsIgnoreCase("dib"<span style="color: #000000;">)) {
                res </span>=<span style="color: #000000;"> XWPFDocument.PICTURE_TYPE_DIB;
            } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (picType.equalsIgnoreCase("emf"<span style="color: #000000;">)) {
                res </span>=<span style="color: #000000;"> XWPFDocument.PICTURE_TYPE_EMF;
            } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (picType.equalsIgnoreCase("jpg") || picType.equalsIgnoreCase("jpeg"<span style="color: #000000;">)) {
                res </span>=<span style="color: #000000;"> XWPFDocument.PICTURE_TYPE_JPEG;
            } </span><span style="color: #0000ff;">else</span> <span style="color: #0000ff;">if</span> (picType.equalsIgnoreCase("wmf"<span style="color: #000000;">)) {
                res </span>=<span style="color: #000000;"> XWPFDocument.PICTURE_TYPE_WMF;
            }
        }
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> res;
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>测试结果：</p>
<p><img src="https://img2018.cnblogs.com/blog/755765/201811/755765-20181122151445711-287862815.png" alt="" width="504" height="191" /></p>
<p>&nbsp;</p>
<h2>注意事项</h2>
<p>1.实际开发过程中，模板通常存放在项目工程中，获取模板的代码如下：</p>
<div class="cnblogs_code">
<pre>String tempPath = "static/exportTemplates/咨询服务合同.docx"<span style="color: #000000;">;
ClassPathResource resource </span>= <span style="color: #0000ff;">new</span><span style="color: #000000;"> ClassPathResource(tempPath);
InputStream is </span>=<span style="color: #000000;"> resource.getInputStream();
XWPFDocument document </span>= <span style="color: #0000ff;">new</span> XWPFDocument(is);</pre>
</div>
<p>2.导出文件时如果报错：Failed to read zip entry source，是因为打包编译将文件解压缩导致出问题，解决办法为在pom文件中配置nonFilteredFileExtension：</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">plugin</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>maven-resources-plugin<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">artifactId</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>2.6<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">version</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">delimiters</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">delimiter</span><span style="color: #0000ff;">&gt;</span>@<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">delimiter</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">delimiter</span><span style="color: #0000ff;">&gt;</span>${*}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">delimiter</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">delimiters</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">useDefaultDelimiters</span><span style="color: #0000ff;">&gt;</span>false<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">useDefaultDelimiters</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">encoding</span><span style="color: #0000ff;">&gt;</span>UTF-8<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">encoding</span><span style="color: #0000ff;">&gt;</span><span style="color: #008000;">&lt;!--</span><span style="color: #008000;"> 指定编码格式，否则在DOS下运行mvn命令时当发生文件资源copy时将使用系统默认使用GBK编码 </span><span style="color: #008000;">--&gt;</span>
                    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtensions</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>bar<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>zip<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>txt<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>pdf<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>ttf<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>xlsx<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>xls<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>docx<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                        <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>doc<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtension</span><span style="color: #0000ff;">&gt;</span>
                    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">nonFilteredFileExtensions</span><span style="color: #0000ff;">&gt;</span>
                <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">configuration</span><span style="color: #0000ff;">&gt;</span>
            <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">plugin</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>参考：</p>
<p class="postTitle"><a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/huajiezh/p/5467821.html">POI使用详解</a></p>
<p class="title-article"><a href="https://blog.csdn.net/u012178169/article/details/79963992" target="_blank">POI通过XWPFDocument方式操作word2007</a></p>
<p class="title-article"><a href="https://blog.csdn.net/eye9093/article/details/77368703" target="_blank">POI操作word模板并生成新的word.docx</a></p>
<p class="title-article"><a href="https://blog.csdn.net/n8790185/article/details/80053838" target="_blank">war在服务器上读取文件报：java.io.IOException: Failed to read zip entry source</a></p>
<p class="title"><a href="https://www.jianshu.com/p/8bb3c63d3fa2" target="_blank">SpringBoot打成jar包后，读取resources目录下的文件</a></p>
<div class="article-title-box">
<p class="title-article"><a href="https://blog.csdn.net/lixiaohai_918/article/details/82015000" target="_blank">在Springboot中从项目中读取文件并下载时 ResourceUtils.getFile返回路径出错并解决</a></p>
</div>
<div class="article-info-box">&nbsp;</div>
<div class="cnblogs_code">
<pre><span style="color: #000000;">create or replace procedure CMS_TO_ESB_INTEGRAL is
</span>--<span style="color: #000000;">调用ESB积分错误是重发接口 
  http_req    utl_http.req;
  http_resp   utl_http.resp;
  request_env clob;
  l_replyline varchar2(</span>2000<span style="color: #000000;">);
  response_xml varchar2(</span>2000<span style="color: #000000;">);
  r_ret_status  varchar2(</span>20<span style="color: #000000;">);

  errorException exception;
  errorCode number;
  errorMsg  varchar2(</span>1000<span style="color: #000000;">);

  l_body_len number;
  l_offset number;
  l_max_buffer_len number :</span>= 255<span style="color: #000000;">;
  l_buffer varchar2(</span>500<span style="color: #000000;">);

begin
--查询业务数据  可不要
 FOR REMIN_LIST IN(
       select a.again_id,a.mobile,a.point_operation,to_char(a.create_date,</span>'yyyy-MM-dd hh24:mi:ss'<span style="color: #000000;">) createTime,
              a.points,a.order_no,a.again_num
            FROM  表名 a
           where a.isenabled </span>= 3 and a.again_num &lt; 5<span style="color: #000000;">
       )
   LOOP<br />--请求报文
 request_env :</span>= '&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"  xmlns:v1="http://www.sxqc.com/osb/Sale/DSBonus/Ds/Schema/v1.0-Get"&gt;
                  &lt;soapenv:Header/&gt;
                  &lt;soapenv:Body&gt;
                   &lt;v1:Request&gt;
                     &lt;v1:RequestCollections&gt; 
                         &lt;v1:RequestCollection&gt;
                              &lt;v1:MbrMobile&gt;'|| REMIN_LIST.mobile  ||'&lt;/v1:MbrMobile&gt;
                              &lt;v1:PointOperation&gt;'|| REMIN_LIST.point_operation ||'&lt;/v1:PointOperation&gt;
                              &lt;v1:CreateTime&gt;'|| REMIN_LIST.createTime ||'&lt;/v1:CreateTime&gt;
                              &lt;v1:Points&gt;'|| REMIN_LIST.points ||'&lt;/v1:Points&gt;
                              &lt;v1:OrderNo&gt;'|| REMIN_LIST.order_no ||'&lt;/v1:OrderNo&gt;
                         &lt;/v1:RequestCollection&gt;
                      &lt;/v1:RequestCollections&gt;
                    &lt;/v1:Request&gt;
                 &lt;/soapenv:Body&gt;
                 &lt;/soapenv:Envelope&gt;';
<span style="color: #000000;">
      http_req :</span>= utl_http.begin_request('http:/.......yncProxy?wsdl'<span style="color: #000000;">,
                                         </span>'POST'<span style="color: #000000;">,
                                         utl_http.HTTP_VERSION_1_1);

      utl_http.set_authentication(http_req, </span>'账号', '密码'<span style="color: #000000;">);
      utl_http.set_persistent_conn_support(http_req, TRUE);
      utl_http.set_header(http_req, </span>'Content-Type', 'text/xml;charset=utf-8'<span style="color: #000000;">);
      utl_http.set_header(http_req, </span>'SOAPAction', ''<span style="color: #000000;">);
      utl_http.set_body_charset(http_req, </span>'utf-8'<span style="color: #000000;">);
      utl_http.set_header(http_req, </span>'Content-Length'<span style="color: #000000;">,dbms_lob.getlength(request_env));
      l_body_len :</span>=<span style="color: #000000;"> dbms_lob.getlength(request_env);
<br />--打印请求报文信息
      l_offset :</span>= 1<span style="color: #000000;">;
      l_buffer :</span>=<span style="color: #000000;"> NULL;
      WHILE l_offset </span>&lt;<span style="color: #000000;"> l_body_len loop
        dbms_lob.read(lob_loc </span>=&gt;<span style="color: #000000;"> request_env
                      ,amount </span>=&gt;<span style="color: #000000;"> l_max_buffer_len
                      ,offset </span>=&gt;<span style="color: #000000;"> l_offset
                      ,buffer </span>=&gt;<span style="color: #000000;"> l_buffer);
        l_offset :</span>= l_offset +<span style="color: #000000;"> l_max_buffer_len;
        utl_http.write_text(http_req, l_buffer);
        dbms_output.put_line(l_buffer);
      END LOOP;

      http_resp :</span>=<span style="color: #000000;"> utl_http.get_response(http_req);
      utl_http.read_text(http_resp, l_replyline);
      utl_http.end_response(http_resp);

      response_xml :</span>=<span style="color: #000000;"> l_replyline;
      response_xml :</span>= replace(response_xml,'soapenv:',''<span style="color: #000000;">);
      response_xml :</span>= replace(response_xml,'soap:',''<span style="color: #000000;">);
      response_xml :</span>= replace(response_xml,'ns2:',''<span style="color: #000000;">);
<br />--解析返回报文
      SELECT RET_STATUS INTO r_ret_status
        FROM XMLTABLE(</span>'$B/Envelope/Body/Response'<span style="color: #000000;"> PASSING
                       XMLTYPE(response_xml) AS B COLUMNS
                       RET_STATUS VARCHAR2(</span>50) PATH '/Response/L_RET_STATUS',<br />　　　　　　　　　　　　　　RET_MESSAGE VARCHAR2(50) PATH '/locationResp/L_RET_MESSAGE'<span style="color: #000000;">);
--处理业务
      IF r_ret_status </span>= 'E'<span style="color: #000000;"> THEN
           UPDATE 表名 SET AGAIN_NUM </span>= REMIN_LIST.again_num+1 WHERE AGAIN_ID =<span style="color: #000000;"> REMIN_LIST.again_Id;
      ELSE
           DELETE FROM 表名 WHERE AGAIN_ID </span>=<span style="color: #000000;"> REMIN_LIST.again_Id;
      END IF; 
      response_xml :</span>=<span style="color: #000000;"> l_replyline;
     COMMIT; 
  END LOOP;

EXCEPTION
  when errorException then
    utl_http.end_response(http_resp);
    errorCode    :</span>=<span style="color: #000000;"> SQLCODE;
    errorMsg     :</span>= SUBSTR(SQLERRM, 1, 200<span style="color: #000000;">);
    r_ret_status :</span>= 'E'<span style="color: #000000;">;
    response_xml :</span>= 'l_ret_status=' || r_ret_status || ',errorCode=' ||<span style="color: #000000;">
                    errorCode </span>|| ',errorMsg=' ||<span style="color: #000000;"> errorMsg;
  when others then
    utl_http.end_response(http_resp);
    errorCode    :</span>=<span style="color: #000000;"> SQLCODE;
    errorMsg     :</span>= SUBSTR(SQLERRM, 1, 200<span style="color: #000000;">);
    r_ret_status :</span>= 'E'<span style="color: #000000;">;
    response_xml :</span>= 'l_ret_status=' || r_ret_status || ',errorCode=' ||<span style="color: #000000;">
                    errorCode </span>|| ',errorMsg=' ||<span style="color: #000000;"> errorMsg;

end CMS_TO_ESB_INTEGRAL;</span></pre>
</div>
<p>&nbsp;&nbsp;</p>
<p>&nbsp;</p>
<p>　　在创建用户接口原型之前，应该先创建窗口结构图，窗口结构用于描述窗口之间的关系，于UML没有直接的关系，本章介绍窗口结构的设计过程，先介绍窗口结构的设计方法，然后设计总体窗口结构图，最后设计下一层的窗口结构图。</p>
<p>　　<strong>1、设计方法</strong></p>
<p><strong>　　</strong>窗口结构是窗口之间的切换流程，通过窗口结构，可以直观地看到通过用例的路径流程。窗口结构非常重要，一个软件系统在实用性上能满足用户的需要还是远远不够的，如果窗口结构设计不合理，也不会受用户欢迎。我们可以参考前面的接口类图来设计窗口结构，在<a href="http://www.cnblogs.com/hnlshzx/p/3485918.html">&ldquo;软件工程之系统建模篇【设计接口类模型】&rdquo;</a>中，已识别出系统的接口类，并画出接口类图，在设计窗口结构时，可以将接口类图中的依赖关系映射为窗口之间的切换关系。</p>
<p>　　2<strong>、总体窗口结构图</strong></p>
<p><strong>　　</strong>系统总体窗口结构图的设计分析为，在进入系统主窗口之前，要经过用户登录窗口，随后弹出的系统主窗口中的系统主菜单包括7个菜单项，通过选择菜单项，将分别出现7个下拉菜单。主窗口结构图如下所示</p>
<p><img src="https://img2018.cnblogs.com/blog/1515898/201811/1515898-20181122151009776-1443957176.png" alt="" /></p>
<p>3<strong>、发文办理窗口结构图</strong></p>
<p><strong>　　</strong>我们对系统总窗口结构进一步分析，画出下一层的窗口结构，我们以发文办理做参考，前面文章介绍已经识别出发文办理的接口类，对应的窗口结构图也能够参照接口类的划分来组织，下图为发文办理窗口结构图</p>
<p><img src="https://img2018.cnblogs.com/blog/1515898/201811/1515898-20181122151045403-173872806.png" alt="" /></p>
<p>其他子模块也可以参照以上结构画出，在此不再举例。下一章我们将介绍用户接口原型的设计。</p>
<p>&nbsp;</p>
<p>&nbsp; 在程序中经常会有这样场景：要求用户输入信息，然后打印成固定的格式</p>
<p>&nbsp; &nbsp; 比如要求用户输入用户名和年龄，然后打印如下格式：</p>
<p>&nbsp; &nbsp; My name is martin，my age is 18.</p>
<p>&nbsp; &nbsp; 很明显，用逗号进行字符串拼接，只能把用户输入的名字和年龄放到末尾，无法放到指定的xxx位置，而且数字也必须经过str(数字)的转换才能与字符串进行拼接。</p>
<p>&nbsp; &nbsp; 这就用到了占位符，如：%s、%d</p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">举例:
接收用户输入，打印成指定格式
name</span>=input(<span style="color: #800000;">'</span><span style="color: #800000;">your name: </span><span style="color: #800000;">'</span><span style="color: #000000;">)
age</span>=input(<span style="color: #800000;">'</span><span style="color: #800000;">your age: </span><span style="color: #800000;">'</span>) <span style="color: #008000;">#</span><span style="color: #008000;">用户输入18,会存成字符串18,无法传给%d,下面必须用%s</span>
<span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">My name is %s,my age is %s</span><span style="color: #800000;">'</span> %<span style="color: #000000;">(name,age))

</span>1,%<span style="color: #000000;">s字符串占位符：可以接收字符串，也可接收数字,如:
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">My name is %s,my age is %s</span><span style="color: #800000;">'</span> %(<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span>,18<span style="color: #000000;">))
</span>2,%<span style="color: #000000;">d数字占位符：只能接收数字
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">My name is %s,my age is %d</span><span style="color: #800000;">'</span> %(<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span>,18<span style="color: #000000;">))
</span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">My name is %s,my age is %d</span><span style="color: #800000;">'</span> %(<span style="color: #800000;">'</span><span style="color: #800000;">egon</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">18</span><span style="color: #800000;">'</span>)) <span style="color: #008000;">#</span><span style="color: #008000;">报错</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<h2>Jenkins介绍</h2>
<p>&nbsp;</p>
<p><span>&nbsp;Jenkins是一个开源软件项目，是基于Java开发的一种持续集成工具，用于监控持续重复的工作，旨在提供一个开放易用的软件平台，使软件的持续集成变成可能。</span></p>
<p><span>Jenkins功能包括:</span></p>
<p><span>1、持续的软件版本发布/测试项目。</span></p>
<p><span>2、监控外部调用执行的工作。</span></p>
<p><span>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;--摘自360百科</span></p>
<p><span>1. jenkins就是基于Java开发的一种持续集成的工具</span></p>
<p><span>2. 可以将运维用到的各个脚本整合起来，并且可以通过页面方式集中管理，而且可以也可以实现和gitlab、github交互，也可以实现自动编译、部署程序</span></p>
<p>&nbsp;</p>
<h2><span style="font-family: 宋体;">持续集成</span></h2>
<p>&nbsp;</p>
<p>持续集成是一种软件开发实践，即团队开发成员经常集成他们的工作，通过每个成员每天至少集成一次，也就意味着每天可能会发生多次集成。每次集成都通过自动化的构建(包括编译，发布，自动化测试)来验证，从而尽早地发现集成错误。</p>
<p>&nbsp;</p>
<p>持续集成</p>
<p>持续集成：Continuous Intergration （<span style="font-family: Calibri;">CI</span>）</p>
<p>持续交付：Continuous Delivery（<span style="font-family: Calibri;">CD</span>）</p>
<p>持续部署：Continuous Deployment（<span style="font-family: Calibri;">CD</span>）</p>
<p>&nbsp;</p>
<p>持续集成流程</p>
<p>1. 提交（<span style="font-family: Calibri;">git</span>）</p>
<p>2. 测试</p>
<p>3. 构建（<span style="font-family: Calibri;">jenkins</span>）</p>
<p>4. 测试</p>
<p>5. 部署（<span style="font-family: Calibri;">ansible</span>，<span style="font-family: Calibri;">shell</span>，<span style="font-family: Calibri;">puppet</span>）</p>
<p>6. 回滚（<span style="font-family: Calibri;">ansible</span>）</p>
<p>&nbsp;</p>
<h2>Jenkins的安装</h2>
<p>&nbsp;</p>
<p>&nbsp;jenkins是基于java开发的所以需要安装java环境</p>
<p>jenkins提供了一个友好的web界面操控，安装完成之后我们可以在web端进行管理</p>
<p>大家可以在如下的网站下载所需要的jenkins版本</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122172037850-1341422281.png" alt="" /></p>
<p>&nbsp;</p>
<p>第一步：关闭防火墙</p>
<div class="cnblogs_code">
<pre>[root@ken ~<span style="color: #000000;">]# systemctl stop firewalld
[root@ken </span>~]# setenforce <span style="color: #800080;">0</span></pre>
</div>
<p>&nbsp;</p>
<p>第二步：安装java环境</p>
<div class="cnblogs_code">
<pre>[root@ken ~]# yum install java -y</pre>
</div>
<p>&nbsp;</p>
<p>第三步：上传安装包及解压安装</p>
<div class="cnblogs_code">
<pre>[root@ken ~]# ls |<span style="color: #000000;"> grep jenkins
jenkins</span>-<span style="color: #800080;">2.138</span>.<span style="color: #800080;">3</span>-<span style="color: #800080;">1.1</span>.noarch.rpm<br />[root@ken ~]# rpm -ivh jenkins-2.138.3-1.1.noarch.rpm&nbsp;</pre>
</div>
<p>&nbsp;</p>
<p>第四步：启动jenkins</p>
<p>jenkins默认监听的是8080端口</p>
<div class="cnblogs_code">
<pre>[root@ken ~<span style="color: #000000;">]# systemctl restart jenkins
[root@ken </span>~]# ss -tnl | grep <span style="color: #800080;">8080</span><span style="color: #000000;">
LISTEN     </span><span style="color: #800080;">0</span>      <span style="color: #800080;">50</span>          :::<span style="color: #800080;">8080</span>                    :::*                  </pre>
</div>
<p>&nbsp;</p>
<p>第五步：浏览器访问</p>
<p>可以看到如下的界面</p>
<p><span>注意：安装jenkins会卡在安装界面</span><br /><span>	原因：当前主机尝试连接jenkins官方站点，但是无法连接上</span><br /><span>	解决：断开当前主机的网络连接</span></p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122165915110-760146147.png" alt="" /></p>
<p>&nbsp;</p>
<p>第六步：linux中找到上述密码并复制进上述框中</p>
<div class="cnblogs_code">
<pre>[root@ken ~]# cat /<span style="color: #0000ff;">var</span>/lib/jenkins/secrets/<span style="color: #000000;">initialAdminPassword
f10ee04f771042638d1c152355efc8c8</span></pre>
</div>
<p>把上面这个密码输入上述框中点击继续即可</p>
<p>选择跳过插件安装即可</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122170233417-1178710907.png" alt="" /></p>
<p>在如下界面创建用户和密码，点击保存并完成</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122170345578-598226152.png" alt="" /></p>
<p>出现如下界面直接点保存并完成</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122170457187-167233026.png" alt="" /></p>
<p>&nbsp;点下下面出现的开始使用Jenkins</p>
<p>&nbsp;<img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122170520403-347497511.png" alt="" /></p>
<p>看到如下界面即表示安装配置完成</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122170613010-1640694024.png" alt="" /></p>
<p>&nbsp;</p>
<h2>Jenkins获取插件并安装</h2>
<p>&nbsp;</p>
<p>&nbsp;第一步：查看插件信息</p>
<p>点击系统管理&gt;插件管理</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122172632401-1810903991.png" alt="" /></p>
<p>点击插件管理</p>
<p>可以看到已安装处为空</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122172719346-1857954528.png" alt="" /></p>
<p>下载插件之前可以在系统管理&gt;关于jenkins查看自己的jenkins版本信息</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122173319581-1804217609.png" alt="" /></p>
<p>&nbsp;</p>
<p>第二步：下载插件</p>
<p>访问如下网站，选择你的jenkins版本</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122173505457-250990269.png" alt="" /></p>
<p>选择latest</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122173554048-1933904849.png" alt="" /></p>
<p>选择你需要安装的插件即可</p>
<p>插件都是以hpi结尾的</p>
<p>&nbsp;</p>
<p>第三步：把下载的插件传入到你的linux系统中</p>
<p>需要把插件传到jenkins的插件目录中即下面的目录下</p>
<p>这里我准备了一个插件安装包&nbsp;plugins-2.138.3.tar.gz&nbsp;</p>
<div class="cnblogs_code">
<pre>[root@ken ~]# ls /<span style="color: #0000ff;">var</span>/lib/jenkins/plugins/</pre>
</div>
<div class="cnblogs_code">
<p>[root@ken ~]# tar xf plugins-2.138.3.tar.gz <br />[root@ken ~]# cp plugins/* /var/lib/jenkins/plugins/ -a</p>




















</div>
<p>&nbsp;</p>
<p>第四步：重启jenkins</p>
<div class="cnblogs_code">
<pre>[root@ken ~]# systemctl restart jenkins</pre>
</div>
<p>&nbsp;</p>
<p>第五步：浏览器端查看</p>
<p>需要刷新一下浏览器，可能还需要你重新输入账号和密码</p>
<p>可以看到在已安装里面已经有很多的插件了</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122174939713-1045191078.png" alt="" /></p>
<p>&nbsp;</p>
<h2>Jenkins版本更新</h2>
<p>&nbsp;</p>
<p>第一步：下载安装更新的软件包</p>
<p>还是访问这个网站</p>
<p>选择你需要升级到的版本</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122182136155-201983760.png" alt="" /></p>
<p>选择latest</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122182238437-1713053188.png" alt="" /></p>
<p>选择war结尾的包下载</p>
<p><img src="https://img2018.cnblogs.com/blog/1499615/201811/1499615-20181122182303266-1023001692.png" alt="" /></p>
<p>&nbsp;</p>
<p>第二步：把选本的war包删掉</p>
<div class="cnblogs_code">
<pre>[root@ken plugins]# rpm -ql jenkins |<span style="color: #000000;"> grep war
</span>/usr/lib/jenkins/jenkins.war</pre>
</div>
<p>&nbsp;</p>
<p>第三步：替换成你下载的包</p>
<p>略</p>
<p>第四步：重启jenkins即可</p>
<div class="cnblogs_code">
<pre>[root@ken ~]# systemctl restart jenkins</pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 楷体; font-size: 15px;">将 Form 的 AutoScaleMode 属性设置为 Dpi：</span></p>
<p><span style="font-family: 楷体;"><img src="https://img2018.cnblogs.com/blog/1513785/201811/1513785-20181122151010206-773531085.png" alt="" width="282" height="204" /></span></p>
<p><span style="font-family: 楷体; font-size: 15px;">在 Program.cs 中添加以下代码：</span></p>
<div class="cnblogs_code">
<pre><span style="font-family: 楷体;"><span style="color: #0000ff;">class</span><span style="color: #000000;"> Program
{
    [STAThread]
    </span><span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> Main()
    {
        </span><span style="color: #0000ff;">if</span> (Environment.OSVersion.Version.Major &gt;= <span style="color: #800080;">6</span><span style="color: #000000;">)
            SetProcessDPIAware();

        Application.EnableVisualStyles();
        Application.SetCompatibleTextRenderingDefault(</span><span style="color: #0000ff;">false</span><span style="color: #000000;">);
        Application.Run(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> Form1());
    }

    [System.Runtime.InteropServices.DllImport(</span><span style="color: #800000;">"</span><span style="color: #800000;">user32.dll</span><span style="color: #800000;">"</span><span style="color: #000000;">)]
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">extern</span> <span style="color: #0000ff;">bool</span><span style="color: #000000;"> SetProcessDPIAware();
}</span></span></pre>
</div>
<p>今天在做appium+python+模拟器自动化测试的时候，发现了一个问题，就是WEBVIEW中的点击失效，有时成功，有时失败。</p>
<p>然后就设置加长等待时间，还是这样，有时成功，有时失败。然后百度一下，发现了在WEBVIEW中点击不到有很多人碰到过。</p>
<p>没有参照他们的OS方法，参考了用坐标来定位元素的方法。</p>
<p>下面有例子详细介绍。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>本文转自：https://www.cnblogs.com/yoyoketang/p/7778077.html</p>
<p># 前言：<br />有时候定位元素的时候，你使出了十八班武艺还是定位不到，怎么办呢？（面试经常会问）<br />那就拿出绝招：点元素所在位置的坐标</p>
<h1 id="tap用法">tap用法</h1>
<p>1.tap是模拟手指点击，一般页面上元素<br />的语法有两个参数，第一个是positions，是list类型最多五个点，duration是持续时间，单位毫秒</p>
<pre><code class="hljs less"><span class="hljs-selector-tag">tap(self, positions, duration=None):

    <span class="hljs-selector-tag">Taps <span class="hljs-selector-tag">on <span class="hljs-selector-tag">an <span class="hljs-selector-tag">particular <span class="hljs-selector-tag">place <span class="hljs-selector-tag">with <span class="hljs-selector-tag">up <span class="hljs-selector-tag">to <span class="hljs-selector-tag">five <span class="hljs-selector-tag">fingers, <span class="hljs-selector-tag">holding <span class="hljs-selector-tag">for <span class="hljs-selector-tag">a <span class="hljs-selector-tag">certain <span class="hljs-selector-tag">time
    
    模拟手指点击（最多五个手指），可设置按住时间长度（毫秒）
    
    <span class="hljs-selector-pseudo">:Args:
    
    <span class="hljs-selector-tag">- <span class="hljs-selector-tag">positions <span class="hljs-selector-tag">- <span class="hljs-selector-tag">list类型，里面对象是元组，最多五个。如：<span class="hljs-selector-attr">[(100, 20), (100, 60)]
    
    <span class="hljs-selector-tag">- <span class="hljs-selector-tag">duration <span class="hljs-selector-tag">- 持续时间，单位毫秒，如：<span class="hljs-selector-tag">500
    
    <span class="hljs-selector-pseudo">:Usage:
    
    <span class="hljs-selector-tag">driver<span class="hljs-selector-class">.tap([(<span class="hljs-number">100, <span class="hljs-number">20), (<span class="hljs-number">100, <span class="hljs-number">60), (<span class="hljs-number">100, <span class="hljs-number">100)], <span class="hljs-number">500)</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<h1 id="坐标定位">坐标定位</h1>
<p>1.如下图定位"去看看"这个按钮的坐标，可以看到右侧bonds属性：[374,831][654,906]</p>
<p><img src="https://images2017.cnblogs.com/blog/1070438/201711/1070438-20171103143556748-1500143884.png" alt="" /></p>
<p>2.点右上角"搜索"按钮，查看bonds属性：[615,52][690,146]</p>
<p><img src="https://images2017.cnblogs.com/blog/1070438/201711/1070438-20171103143609013-1508094385.png" alt="" /></p>
<h1 id="参考案例">参考案例</h1>
<pre class="python"><code class="hljs"><span class="hljs-comment"># coding:utf-8
<span class="hljs-keyword">from appium <span class="hljs-keyword">import webdriver
<span class="hljs-keyword">from time <span class="hljs-keyword">import sleep
desired_caps = {
                <span class="hljs-string">'platformName': <span class="hljs-string">'Android',
                <span class="hljs-string">'deviceName': <span class="hljs-string">'127.0.0.1:62001',
                <span class="hljs-string">'platformVersion': <span class="hljs-string">'4.4.2',
                <span class="hljs-string">'appPackage': <span class="hljs-string">'com.baidu.yuedu',
                <span class="hljs-string">'appActivity': <span class="hljs-string">'com.baidu.yuedu.splash.SplashActivity'
                }
driver = webdriver.Remote(<span class="hljs-string">'http://127.0.0.1:4723/wd/hub', desired_caps)

sleep(<span class="hljs-number">5)
<span class="hljs-comment"># 点弹出框去看看
driver.tap([(<span class="hljs-number">374, <span class="hljs-number">831), (<span class="hljs-number">654, <span class="hljs-number">906)], <span class="hljs-number">500)

<span class="hljs-comment"># 返回上一页
driver.back()
sleep(<span class="hljs-number">2)

<span class="hljs-comment"># 点右上角搜素按钮
<span style="color: #ff0000;">driver.tap([(<span class="hljs-number">615, <span class="hljs-number">52), (<span class="hljs-number">690, <span class="hljs-number">146)], <span class="hljs-number">500)   ###这里是书写格式。
</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></code></pre>
<h1 id="弊端">弊端</h1>
<p>通过坐标定位是元素定位的下下下策，实在没办法才用这个，另外如果换了手机分辨率，这个坐标就不能写死了，得算出所在屏幕的比例。</p>
<p>&nbsp;</p>
<p><br /><span style="color: #000000;"><strong>
D方法</strong>：应该是用的比较多的方法了，用于实例化自定义数据模型类，是ThinkPHP框架对Model类实例化的一种封装，并实现了单例模式，支持跨项目和分组调用，调用格式如下：</span></p>
<div class="cnblogs_code">
<pre>D(<span style="color: #800000;">'</span><span style="color: #800000;">[项目://][分组/]模型</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">模型层名称</span><span style="color: #800000;">'</span>)</pre>
</div>
<p><span style="color: #000000;">方法的返回值是实例化的模型对象。</span><br /><span style="color: #000000;">
D方法可以自动检测模型类，如果存在自定义的模型类，则实例化自定义模型类，如果不存在，则会实例化Model基类，同时对于已实例化过的模型，不会重复去实例化。</span></p>
<p><br /><span style="color: #000000;">
D方法最常用的用法就是实例化当前项目的某个自定义模型，例如：</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">//</span><span style="color: #008000;"> 实例化User模型</span>
$User = D(<span style="color: #800000;">'</span><span style="color: #800000;">User</span><span style="color: #800000;">'</span>);</pre>
</div>
<p><span style="color: #000000;"><br />
会导入当前项目下面的Lib/Model/UserModel.class.php文件，然后实例化UserModel类，所以，实际上的代码可能和下面的等效：<br /></span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>import(<span style="color: #800000;">'</span><span style="color: #800000;">@.Model.UserModel</span><span style="color: #800000;">'</span><span style="color: #000000;">);
$User </span>= <span style="color: #0000ff;">new</span> UserModel();</pre>
</div>
<p><span style="color: #000000;"><br />
但是如果使用D方法的话，如果这个UserModel类不存在，则会自动调用</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">new</span> Model(<span style="color: #800000;">'</span><span style="color: #800000;">User</span><span style="color: #800000;">'</span>);</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #000000;">并且第二次调用的时候无需再次实例化，可以减少一定的对象实例化开销。</span></p>
<p><span style="color: #000000;"><br />
D方法可以支持跨分组和项目实例化模型，例如：<br />
</span></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">//</span><span style="color: #008000;">实例化Admin项目的User模型</span>
D(<span style="color: #800000;">'</span><span style="color: #800000;">Admin://User</span><span style="color: #800000;">'</span><span style="color: #000000;">)
 </span><span style="color: #008000;">//</span><span style="color: #008000;">实例化Admin分组的User模型</span>
D(<span style="color: #800000;">'</span><span style="color: #800000;">Admin/User</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<p><span style="color: #000000;">注意：要实现跨项目调用模型的话，必须确保两个项目的目录结构是并列的。</span></p>
<p><span style="color: #000000;"><br />
3.1版本开始，由于增加了分层模型的支持，所以D方法也可以实例化其他的模型，例如：<br />
</span></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">//</span><span style="color: #008000;"> 实例化UserService类</span>
$User = D(<span style="color: #800000;">'</span><span style="color: #800000;">User</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">Service</span><span style="color: #800000;">'</span><span style="color: #000000;">);
 </span><span style="color: #008000;">//</span><span style="color: #008000;"> 实例化UserLogic类</span>
$User = D(<span style="color: #800000;">'</span><span style="color: #800000;">User</span><span style="color: #800000;">'</span>,<span style="color: #800000;">'</span><span style="color: #800000;">Logic</span><span style="color: #800000;">'</span><span style="color: #000000;">);
</span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;D('User','Service');&nbsp; 会导入Lib/Service/UserService.class.php，并实例化，等效于下面的代码：</p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre>import(<span style="color: #800000;">'</span><span style="color: #800000;">@.Service.UserService</span><span style="color: #800000;">'</span><span style="color: #000000;">);
$User </span>= <span style="color: #0000ff;">new</span> UserSerivce();</pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #000000;"><strong>&nbsp;</strong></span></p>
<p>　　今年下半年，整个加密货币市场走势低迷，一直处于熊市之中，币价也一跌再跌，跌跌不休。矿工日子愈发艰难，矿机销售存在巨大挑战，价格也出现了大幅下降。</p>
<p>　　这几日随着数字货币的大跌，一些矿场清盘的新闻直接刷爆了朋友圈，矿圈受到冲击的新闻甚至上了热搜。矿机甩卖，论斤售价的传言令人唏嘘。其实矿圈并非如此惨淡，传言太过夸大其词。</p>
<p>　　那么现目前矿圈的真是情况到底如何呢？</p>
<p>　　<strong>倒闭矿场数量少、存量小</strong></p>
<p>　　目前我国境内矿场主要分布在新疆、内蒙、四川、云南、甘肃等省市份。矿场的数量暂时还没有相对精准的统计，并且一个矿场的大小并不是按照矿机的数量去衡量，而是根据这个矿场的负荷来衡量。</p>
<p>　　单台矿机的负荷有的是1.4千瓦，而现在2.4、2.5千瓦的都有。目前，国内较大的矿场主要集中在新疆，大的矿场甚至有几十万的负荷量。</p>
<p>　　近日听闻的这些矿场清盘的情况确实存在，但是数量很少，并且主要是一些小矿场。这也和他们建立的时间较晚，成本较高有很大的关系。受到价格的影响是一方面原因，另一方面则是矿场数量太多，竞争压力也很大。至于到底是不是很多的矿场都清盘，看全网的算力就知道了，全网算力目前并没有减少。</p>
<p style="text-align: center;">　　<img src="https://img2018.cnblogs.com/blog/815181/201811/815181-20181122151058606-103965694.png" alt="" /></p>
<p>　　但是矿场确实也存在趋冷的势头，今年Antpool着手建立的几个矿场都没有成功。</p>
<p>　　随着数字货币的大跌，矿工每日收益确实在减少，根据算力和矿机可以看到BTC的单日收益在1.22/T。整体还是处在盈利的状态，较上周1.68/T减少了三分之一左右。</p>
<p>　　&ldquo;还能坚持，只是没有之前那么滋润。大跌总比横盘强，横盘多难受，在那里半死不活的。&rdquo;俞队长认为，大跌至少可以激发市场活力。</p>
<p style="text-align: center;">　　<img src="https://img2018.cnblogs.com/blog/815181/201811/815181-20181122151107791-1390489056.png" alt="" /></p>
<p>　　大家对于近日的这些新闻的看法是过于夸张，一些媒体没有考证事情真相就大幅度报道。目的为了博得眼球和关注。市场的变化是不可预估的，对行业的影响一定存在。虽然熊市持续，但是矿工信念还在。</p>
<p>　　了解后，不难看出，矿圈并没有部分媒体报道的那么惨淡，他们的氛围非常轻松活跃，毕竟人家还在盈利呢！</p>
<p>　　作者：这个币世界太疯狂</p>
<p>　　原文链接：<a href="https://www.kg.com/article/515126977062113280" target="_blank">https://www.kg.com/article/515126977062113280</a></p>
<p>在chhtml页中添加标签</p>
<p> &lt;form method="post" enctype="multipart/form-data" id="formData"&gt;<br />            &lt;input type="hidden" name="FileName" value="" /&gt;<br />            &lt;span&gt;上传图片&lt;/span&gt;<br />            &lt;input type="file" id="fileUpload"  name="file" /&gt;&lt;span&gt;上传图片input 后给id必须给个name="file"&lt;/span&gt;<br />            &lt;img src="" id="showImage" /&gt;<br />        &lt;/form&gt;</p>
<p>&lt;script type="text/javascript"&gt;<br />        $(function () {<br />            $("#fileUpload").change(function () {</p>
<p><br />                //单文件长传所以默认取第一个<br />                var formData = new FormData($("#formData")[0]);<br />                $.ajax({<br />                    url: '/Product/UploadFile',<br />                    type: 'post',<br />                    //数据类型不处理<br />                    contentType: false,<br />                    //数据不处理<br />                    processData: false,<br />                    //不缓存<br />                    cache: false,<br />                    data:formData,<br />                    success: function (data) {<br />                        alert(data)<br />                        $("input[name=FileName]").val(data);<br />                        $("#showImage").attr("src", data);<br />                    }<br />                });<br />            });<br />        })<br />    &lt;/script&gt;</p>
<p>&nbsp;</p>
<p>后台代码</p>
<p> public string UploadFile()<br />        {<br />            HttpPostedFileBase httpfile = Request.Files[0];<br />            if (httpfile != null)<br />            {<br />                //获取路径<br />                string strPath = Server.MapPath("~/images/");<br />                //判断是否存在<br />                if (!Directory.Exists(strPath))<br />                    Directory.CreateDirectory(strPath);<br />                //获取所有路径<br />                string newPath = Path.Combine(strPath, httpfile.FileName);<br />                httpfile.SaveAs(newPath);<br />                return "/images/" + httpfile.FileName;<br />            }<br />            else<br />                return null;</p>
<p>        }</p>
<p>&nbsp;</p>
<p class="hljs cpp"><code class="cpp">i = ++i + i++ + i++ + i++;</code></p>
<p class="hljs cpp">把每个 i++或者++i看作一个部分，他们的分别再下一个 i++或者++i改变，中途赋值的话，就返回这个部分的值</p>
<p class="hljs cpp">来自：https://www.jianshu.com/p/90a716e59f9d</p>
<p>下载tar包并安装<br />curl -O https://fastdl.mongodb.org/linux/mongodb-linux-x86_64-rhel70-3.6.8.tgz</p>
<p>[root@mysqlt1 soft]# tar -zxvf mongodb-linux-x86_64-rhel62-3.6.3.tgz -C /usr/local/<br />[root@mysqlt1 soft]# cd /usr/local/<br />[root@mysqlt1 local]# ln -s /usr/local/mongodb-linux-x86_64-rhel62-3.6.3 mongodb<br />export PATH=/usr/local/mongodb/bin:$PATH<br />[root@mysqlt1 local]# export PATH=/usr/local/mongodb/bin:$PATH<br />[root@mysqlt1 local]# groupadd mongodb<br />[root@mysqlt1 local]# useradd -g mongodb mongodb<br />[root@mysqlt1 local]# chown -R mongodb:mongodb /usr/local/mongodb/<br />[root@mysqlt1 local]# mkdir -p /data/mongodb<br />[root@mysqlt1 local]# chown -R mongodb:mongodb /data/mongodb/<br />[root@mysqlt1 ~]# ll /usr/local/mongodb/bin/</p>
<p>[root@hongquan1 data]# mkdir data conf log<br />[root@hongquan1 data]# mkdir 28001 28002 28003<br />[root@hongquan1 data]# chown -R mongodb:mongodb data/ conf/ log/ 2800*<br />1 <strong>配置文件</strong><br />port=28001<br />bind_ip=192.168.20.118<br />logpath=/data/log/28001.log<br />dbpath=/data/28001/<br />logappend=true<br />pidfilepath=/data/28001/28001.pid<br />fork=true<br />oplogSize=1024<br />replSet=MyMongo</p>
<p>2 启动实例<br />/usr/local/mongodb/bin/mongod -f /data/conf/28001.conf<br />[mongodb@hongquan1 bin]$ ps -ef|grep mongodb<br />/usr/local/mongodb/bin/mongod -f /data/conf/28002.conf<br />/usr/local/mongodb/bin/mongod -f /data/conf/28003.conf</p>
<p><strong>登录</strong><br />/usr/local/mongodb/bin/mongo 192.168.20.118:28001/admin<br />&gt; db<br />admin<br />&gt; use admin<br />switched to db admin<br />&gt;config = {<br />"_id":"MyMongo",<br />members:[<br />{"_id":0,host:"192.168.20.118:28001"},<br />{"_id":1,host:"192.168.20.118:28002"},<br />{"_id":2,host:"192.168.20.118:28003"}]<br />}<br />&gt; config.members<br />&gt; config.members[2] ={"_id":2,"host":"192.168.20.118:28003",arbiterOnly:true}<br />&gt; rs.initiate(config)<br />&gt; rs.status();<br />MyMongo:PRIMARY&gt; db.isMaster()</p>
<p>/usr/local/mongodb/bin/mongo 192.168.20.118:28002/admin<br />MyMongo:SECONDARY&gt; show dbs<br />MyMongo:SECONDARY&gt; rs.slaveOk(true)<br />/usr/local/mongodb/bin/mongo 192.168.20.118:28003/admin<br />MyMongo:ARBITER&gt; rs.slaveOk(true)<br />MyMongo:ARBITER&gt; show dbs<br />local  0.000GB<br />--<br />MyMongo:PRIMARY&gt; show users;<br />db.createUser(<br />{<br />user: "dba",<br />pwd: "dba",<br />roles: [ { role: "root", db: "admin" } ]<br />}<br />)<br />MyMongo:PRIMARY&gt;db.auth('dba','dba')<br />MyMongo:SECONDARY&gt; show users;<br />{<br />	"_id" : "admin.dba",<br />	"user" : "dba",<br />	"db" : "admin",<br />	"roles" : [<br />		{<br />			"role" : "root",<br />			"db" : "admin"<br />		}<br />	]<br />}<br />MyMongo:ARBITER&gt; show users<br />--<br />MyMongo:PRIMARY&gt; use test;<br />switched to db test<br />MyMongo:PRIMARY&gt; for(var i=1;i&lt;=1000;i++) db.table1.save({id:i,"test1":"testval1"});<br />WriteResult({ "nInserted" : 1 })<br />MyMongo:PRIMARY&gt; db.table1.find().count()<br />1000<br />MyMongo:PRIMARY&gt; show collections<br />table1</p>
<p>MyMongo:SECONDARY&gt; use test;<br />switched to db test<br />MyMongo:SECONDARY&gt;  db.table1.find().count()<br />1000<br />--<br />MyMongo:PRIMARY&gt; show collections<br />system.keys<br />system.users<br />system.version<br />MyMongo:PRIMARY&gt; db.system.users.find().pretty()<br />{<br />	"_id" : "admin.dba",<br />	"user" : "dba",<br />	"db" : "admin",<br />	"credentials" : {<br />		"SCRAM-SHA-1" : {<br />			"iterationCount" : 10000,<br />			"salt" : "ZbsCePqGIpsp492RvVB3cg==",<br />			"storedKey" : "GczfCAfP0yNUUrMOjVatzZnWisw=",<br />			"serverKey" : "i0CDYveRNXcQ8F3HFthQGSyqbFM="<br />		}<br />	},<br />	"roles" : [<br />		{<br />			"role" : "root",<br />			"db" : "admin"<br />		}<br />	]<br />}<br />MyMongo:PRIMARY&gt; db.system.indexes.find();<br />MyMongo:PRIMARY&gt; db.system.version.find();<br />{ "_id" : "featureCompatibilityVersion", "version" : "3.6" }<br />{ "_id" : "authSchema", "currentVersion" : 5 }</p>
<p>==<strong>3个节点，添加2个节点</strong><br />[root@mysqlt1 data]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28004.conf<br />[root@mysqlt1 data]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28005.conf<br />此时在primary上插入数据<br />MyMongo:PRIMARY&gt; db.books.find()<br />MyMongo:SECONDARY&gt; db.books.find() //28002上查看是否存在<br />MyMongo:PRIMARY&gt; rs.add( { host: "10.15.7.114:28004"} )<br />登录28004节点并查看<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongo 10.15.7.114:28004/admin<br />MyMongo:SECONDARY&gt; db.getMongo().setSlaveOk()<br />MyMongo:SECONDARY&gt; db.books.find()//数据已经存在<br />再添加一个仲裁节点28005<br />MyMongo:PRIMARY&gt; rs.add( { host: "10.15.7.114:28005", arbiterOnly: true } )<br />MyMongo:PRIMARY&gt; rs.status()<br />MyMongo:PRIMARY&gt; db.isMaster()<br />{<br />	"hosts" : [<br />		"10.15.7.114:28001",<br />		"10.15.7.114:28002",<br />		"10.15.7.114:28004"<br />	],<br />	"arbiters" : [<br />		"10.15.7.114:28003",<br />		"10.15.7.114:28005"<br />	],<br />现在5个节点，1个primary，2个secondary，2个arbiterOnly<br />现在<span style="background-color: #339966;"><strong>测试宕机</strong></span>掉28001primary节点<br />MyMongo:PRIMARY&gt; use admin<br />MyMongo:PRIMARY&gt; db.shutdownServer();<br />//"errmsg" : "shutdown must run from localhost when running db without auth"<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongo localhost:28001/admin<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongo 127.0.0.1:28001/admin<br />[root@mysqlt1 ~]# cat /etc/hosts<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongo mysqlt1:28001/admin<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongod  --shutdown -f /data/mongodb/conf/28001.conf<br />关闭28001后，28002成为primary节点<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongo 10.15.7.114:28002/admin<br />MyMongo:PRIMARY&gt; rs.status()<br />MyMongo:PRIMARY&gt; use test;//加入测试数据<br />switched to db test<br />MyMongo:PRIMARY&gt; for(var i=1;i&lt;=1000;i++) db.table1.save({id:i,"test1":"testval1"});<br />WriteResult({ "nInserted" : 1 })<br />MyMongo:PRIMARY&gt; db.table1.find().count()<br />1000<br />现在宕机掉28002节点，28003成为primary节点，现在剩下1个primary和2个仲裁节点<br />MyMongo:PRIMARY&gt; use test;<br />switched to db test<br />MyMongo:PRIMARY&gt; db.table1.find().count()<br />1000<br />MyMongo:PRIMARY&gt; for(var i=1;i&lt;=1000;i++) db.table1.save({id:i,"test22":"testval22"}); //插入数据<br />WriteResult({ "nInserted" : 1 })<br />MyMongo:PRIMARY&gt; db.table1.count()<br />2000<br />现在启动28001,28002节点，自动加入副本集，并成为secondry节点<br />MyMongo:SECONDARY&gt; db.getMongo().setSlaveOk()<br />MyMongo:SECONDARY&gt; db.table1.find().count() //数据已经同步<br />2000<br />这里测试，5个节点，剩余3个节点，不管是secondry还是仲裁节点，即使最后剩下primary+2个仲裁，primary节点还是可以支持读写</p>
<p>==<strong><span style="background-color: #339966;">添加备份节点</span></strong><br />MyMongo:PRIMARY&gt; rs.remove("10.15.7.114:28005"); #删除原来的第二个仲裁节点<br />MyMongo:PRIMARY&gt; rs.add({host:"10.15.7.114:28005","priority":0,"hidden":true}) #设置为备份节点<br />"_id" : 4,<br />			"name" : "10.15.7.114:28005",<br />			"health" : 1,<br />			"state" : 5,<br />			"stateStr" : "STARTUP2",<br />MyMongo:STARTUP2&gt; rs.slaveOk()<br />MyMongo:STARTUP2&gt; db.table1.find().count() #不能进行读写操作<br />2018-10-15T01:42:38.593+0800 E QUERY    [thread1] Error: count failed: {<br />	"ok" : 0,<br />	"errmsg" : "node is not in primary or recovering state",<br />	"code" : 13436,<br />	"codeName" : "NotMasterOrSecondary"<br />} :</p>
<p><strong><span style="background-color: #339966;">添加延迟节点</span></strong><br />Delayed（成员用于支持专用功能）：可以指定一个时间延迟从primary节点同步数据。主要用于处理误删除数据马上同步到从节点导致的不一致问题<br />MyMongo:PRIMARY&gt; rs.add({host:"10.15.7.114:28005","priority":0,"hidden":true,"slaveDelay":60})</p>
<p>Secondary-Only:不能成为primary节点，只能作为secondary副本节点，防止一些性能不高的节点成为主节点。<br />Non-Voting：没有选举权的secondary节点，纯粹的备份数据节点</p>
<p>连续写入数据，测试选举<br />== 选举期间会丢失数据（严格意义上不叫丢失，因为这个时候本来mongo就不可用，在等待切换，程序可以把这部分数据存入消息队列，等待选举成功在写入）<br />======<br />import time<br />from pymongo import MongoClient<br />conn= MongoClient('mongodb://10.15.7.114:28001,10.15.7.114:28002,10.15.7.114:28004/?replicaSet=MyMongo')</p>
<p>for i in xrange(100):<br />    try:<br />        conn.test.tt1.insert({"name":"test" + str(i)})<br />        time.sleep(1)<br />        print conn.primary<br />        print conn.secondaries<br />    except:<br />        pass<br />======<br />测试5个节点，宕机掉3个，然后剩余2个节点<span style="text-decoration: line-through;">，将一个可用节点以单节点启动并使用，使用一段时间后，在以副本集启动，让其他4个节点加入副本集</span><br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongod  --shutdown -f /data/mongodb/conf/28004.conf<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongod  --shutdown -f /data/mongodb/conf/28001.conf<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongod  --shutdown -f /data/mongodb/conf/28003.conf<br />MyMongo:SECONDARY&gt; #还剩下2个节点，自动变为secondry<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongod  --shutdown -f /data/mongodb/conf/28002.conf<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongod  --shutdown -f /data/mongodb/conf/28005.conf<br />整个副本集全部宕机，把28002作为单节点启动并使用<br />[root@mysqlt1 conf]# vim 28002.conf <br />[root@mysqlt1 conf]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28002.conf<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongo 10.15.7.114:28002/admin<br />&gt; show dbs;<br />admin      0.000GB<br />bookstore  0.000GB<br />config     0.000GB<br />local      0.002GB<br />test       0.000GB<br />&gt; rs.status()<br />{<br />	"ok" : 0,<br />	"errmsg" : "not running with --replSet",<br />	"code" : 76,<br />	"codeName" : "NoReplicationEnabled"<br />}<br />&gt; use test;<br />switched to db test<br />&gt; db.tt2.find().count()<br />10<br />再插入10条数据<br />&gt; db.tt2.find().count()<br />20<br />[root@mysqlt1 conf]# vim 28002.conf#这里注意，不能修改之前的副本集的名称，修改了会报错<br />[root@mysqlt1 conf]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28002.conf<br />[root@mysqlt1 ~]# /usr/local/mongodb/bin/mongo 10.15.7.114:28002/admin<br />MyMongo:OTHER&gt; rs.add( { host: "10.15.7.114:28001"} )<br />{<br />	"ok" : 0,<br />	"errmsg" : "replSetReconfig should only be run on PRIMARY, but my state is REMOVED; use the \"force\" argument to override",<br />	"code" : 10107,<br />	"codeName" : "NotMaster",<br />[root@mysqlt1 conf]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28001.conf<br />[root@mysqlt1 conf]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28003.conf</p>
<p>config = {<br />"_id":"MyMongo1",<br />members:[<br />{"_id":0,host:"10.15.7.114:28001"},<br />{"_id":1,host:"10.15.7.114:28002"},<br />{"_id":2,host:"10.15.7.114:28003"}]<br />}<br />config.members<br />config.members[1].priority = 2;<br />rs.reconfig(config);<br />#MyMongo:OTHER&gt; rs.initiate(config);<br />==不修改副本集名称启动3个节点，自动加入副本集<br />MyMongo:PRIMARY&gt; use test;<br />switched to db test<br />MyMongo:PRIMARY&gt; db.tt2.find().count()<br />20<br />==登录其他secondry节点查看数据，只有副本集之前的数据，作为单节点的数据没有同步，应为写入oplog的问题？<br />==<strong><span style="background-color: #339966;">修正，这里作为单节点启动，要显示指定oplog参数(根本没有oplog这个参数）所以，意思测试不成立</span></strong>。<br />分析，因为oplog的存在的时间和空间都有限制，是循环写，所有如果点节点的存在，就不能保证所有的写入都会在oplog</p>
<p>MyMongo:SECONDARY&gt;  db.getMongo().setSlaveOk()<br />MyMongo:SECONDARY&gt; db.tt2.find().count()<br />10<br />MyMongo:SECONDARY&gt; db.tt2.find().sort({"name":1})</p>
<p>[root@mysqlt1 conf]# cat 28002.conf <br />port=28002<br />bind_ip=10.15.7.114<br />logpath=/data/mongodb/log/28002.log<br />dbpath=/data/mongodb/data/28002/<br />logappend=true<br />pidfilepath=/data/mongodb/28002.pid<br />fork=true<br />oplogSize=1024<br />replSet=MyMongo</p>
<p>MyMongo:PRIMARY&gt; rs.printReplicationInfo()<br />configured oplog size:   1024MB #oplog文件大小<br />log length start to end: 430037secs (119.45hrs)<br />oplog first event time:  Thu Oct 11 2018 03:45:19 GMT+0800 (CST)<br />oplog last event time:   Tue Oct 16 2018 03:12:36 GMT+0800 (CST)<br />now:                     Tue Oct 16 2018 03:12:40 GMT+0800 (CST)<br />MyMongo:PRIMARY&gt; db.getReplicationInfo() #用来查看oplog的状态、大小、存储的时间范围<br />{<br />	"logSizeMB" : 1024,<br />	"usedMB" : 4.97,<br />	"timeDiff" : 430086,<br />	"timeDiffHours" : 119.47,<br />===<strong><span style="background-color: #339966;">在secondry节点，重新配置副本集，加入几个仲裁节点</span></strong><br />MyMongo:SECONDARY&gt; use admin<br />MyMongo:SECONDARY&gt; config = {<br />"_id":"MyMongo",<br />members:[<br />{"_id":0,host:"10.15.7.114:28001"},<br />{"_id":1,host:"10.15.7.114:28002"},<br />{"_id":2,host:"10.15.7.114:28003", arbiterOnly: true},<br />{"_id":3,host:"10.15.7.114:28004"},<br />{"_id":4,host:"10.15.7.114:28005", arbiterOnly: true},<br />{"_id":5,host:"10.15.7.114:28006", arbiterOnly: true},<br />{"_id":6,host:"10.15.7.114:28007", arbiterOnly: true}]<br />}<br />MyMongo:SECONDARY&gt; rs.reconfig(config,{force:true});<br />测试插入数据<br />MyMongo:PRIMARY&gt; db.tt3.find().count()<br />100<br />启动另外3个节点<br />[root@mysqlt1 conf]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28001.conf<br />[root@mysqlt1 conf]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28002.conf<br />[root@mysqlt1 conf]# /usr/local/mongodb/bin/mongod -f /data/mongodb/conf/28003.conf<br />[root@mysqlt1 ~]#  /usr/local/mongodb/bin/mongo 10.15.7.114:28002/admin<br />MyMongo:SECONDARY&gt; rs.slaveOk(true)<br />MyMongo:SECONDARY&gt; use test;<br />switched to db test<br />MyMongo:SECONDARY&gt; db.tt3.find().count() #数据同步成功<br />100<br />之前的5个节点，现在变成了7个节点，删除新加的2个仲裁节点<br />rs.remove("10.15.7.114:28007");<br />rs.remove("10.15.7.114:28006");<br />MyMongo:PRIMARY&gt; db.isMaster() #变回之前的5个节点，1主，2secondry，2仲裁<br />{<br />	"hosts" : [<br />		"10.15.7.114:28001",<br />		"10.15.7.114:28002",<br />		"10.15.7.114:28004"<br />	],<br />	"arbiters" : [<br />		"10.15.7.114:28003",<br />		"10.15.7.114:28005"</p>
<p><strong>UML概述</strong></p>
<p><strong>　　</strong>UML译为统一建模语言，由面向对象方法领域三位著名学者提出，并结合优秀的软件方法和思想演变而成，1997年被国际对象组织（OMG）接受，目前被公认为最好的分析和设计面向对象软件的标准建模语言。</p>
<p><strong>UML组成</strong></p>
<p><strong>　　</strong>UML由模型元素，扩展机制、图及视图等部分构成，由模型元素或扩展机制构成图，由图构成视图。UML定义了9种不同的图，9种图分为两类：一类是静态图，包括用例图、类图、对象图、组件图和配置图，另一类是动态图，包括序列图、协作图、状态图和活动图。它包括5种不同的视图：用例视图、设计视图、过程视图、实现视图和配置视图。</p>
<p><strong>UML功能</strong></p>
<p><strong>　　</strong>UML作为一种建模语言，则用于系统开发人员之间，开发人员与用户之间的交流。主要功能包括：为软件系统的产出建立可视化模型，规约软件系统的产出，构造软件系统的产出，为软件系统的产出建立文档。</p>
<p><strong>何谓OA</strong></p>
<p><strong>　　</strong>OA是office Automation办公自动化的缩写，办公自动化是应用计算机技术、通信技术、系统科学和行为科学等先进的科学技术，不断地使人们的部分办公业务借助与各种办公设备，并由这些办公设备与办公人员构成的服务与某种目标的人机信息系统。OA有如下作用：</p>
<p>　　能极大地提高行政机构的工作效率或企事业单位的市场竞争能力</p>
<p>　　能提高管理者的决策水平</p>
<p>　　能节省运营成本</p>
<p>　　能降低劳动强度</p>
<p>　　在开发办公自动化系统的实例之前，应该选择和定义一个合适的系统结构，典型的系统结构分3层：表示服务层、商业服务层和数据库服务层，为使办公自动化系统的实例在未来可以扩展，可将3层结构进一步细化为6个逻辑层，每个逻辑层分别提供不同的服务</p>
<p>　　<img src="https://images0.cnblogs.com/blog/37666/201312/21094108-df76cccc6b3749bf8653f481426f18c7.jpg" alt="" /></p>
<p>　　表示服务层：提供用户接口技术</p>
<p>　　商业上下文服务层：提供数据编辑</p>
<p>　　商业规则服务层：实现商业规则</p>
<p>　　数据转化服务层：将商业层的请求转化为数据兼容的语言</p>
<p>　　数据访问服务层：实行某些数据库API接口</p>
<p>　　数据库服务层：保存实体数据</p>
<p><strong>系列导航</strong></p>
<p><strong>　　建模篇：</strong></p>
<p><strong>　　</strong><a title="软件工程之系统建模【开卷有益】" href="http://www.cnblogs.com/hnlshzx/p/3484828.html">1、软件工程之系统建模篇【开卷有益】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3485068.html">2、软件工程之系统建模篇【设计用例模型】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3485798.html">3、软件工程之系统建模篇【设计实体类模型】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3485918.html">4、软件工程之系统建模篇【设计接口类模型】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3486026.html">5、软件工程之系统建模篇【设计接口控制类模型】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3486894.html">6、软件工程之系统建模篇【设计用例控制类模型】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3487254.html">7、软件工程之系统建模篇【设计系统类模型】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3488476.html">8、软件工程之系统建模篇【设计窗口结构】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3494732.html">9、软件工程之系统建模篇【设计动态模型】</a></p>
<p><strong>　　</strong><a href="http://www.cnblogs.com/hnlshzx/p/3504548.html">10、软件工程之系统建模篇【设计数据模型】</a></p>
<p>　<strong><br /></strong></p>
<div class="cnblogs_code">
<pre><span style="color: #008000;">/*</span><span style="color: #008000;">定义滚动条高宽及背景 高宽分别对应横竖滚动条的尺寸</span><span style="color: #008000;">*/</span><span style="color: #000000;">  
::</span>-webkit-<span style="color: #000000;">scrollbar  
{  
    width: 5px;  
    height: 110px;  
    background</span>-<span style="color: #000000;">color: #F5F5F5;  
}  
</span><span style="color: #008000;">/*</span><span style="color: #008000;">定义滚动条轨道 内阴影+圆角</span><span style="color: #008000;">*/</span><span style="color: #000000;">  
::</span>-webkit-scrollbar-<span style="color: #000000;">track  
{  
    </span>-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,0.3<span style="color: #000000;">);  
    border</span>-<span style="color: #000000;">radius: 10px;  
    background</span>-<span style="color: #000000;">color: #F5F5F5;  
}    
</span><span style="color: #008000;">/*</span><span style="color: #008000;">定义滑块 内阴影+圆角</span><span style="color: #008000;">*/</span><span style="color: #000000;">  
::</span>-webkit-scrollbar-<span style="color: #000000;">thumb  
{  
    border</span>-<span style="color: #000000;">radius: 10px;  
    </span>-webkit-box-shadow: inset 0 0 6px rgba(0,0,0,.3<span style="color: #000000;">);  
    background</span>-<span style="color: #000000;">color: #bdbdbd;  
}  
</span><span style="color: #008000;">/*</span><span style="color: #008000;">滑块效果</span><span style="color: #008000;">*/</span><span style="color: #000000;">
::</span>-webkit-scrollbar-<span style="color: #000000;">thumb:hover
{
border</span>-<span style="color: #000000;">radius: 5px;
</span>-webkit-box-shadow: inset 0 0 5px rgba(0,0,0,0.2<span style="color: #000000;">);
background: rgba(</span>0,0,0,0.4<span style="color: #000000;">);
}</span></pre>
</div>
<p>&nbsp;</p>
<p><span style="font-family: 'comic sans ms', sans-serif; font-size: 15px;">博主之前做过移动端app嵌入网页，与Android和IOS有交互，一直没有时间分享过程。这里不多说Android交互啦～很简单，详细了解IOS与h5的交互吧。</span></p>
<p class="p1"><span style="font-family: 'comic sans ms', sans-serif; font-size: 15px;">IOS不同语法和h5的交互所建立的JSBrige是不一样的，但是大致思想是一样。这里粘出swift与h5交互创建JSBrige。</span></p>
<p class="p1">&nbsp;</p>
<p class="p1">&nbsp;<img src="https://img2018.cnblogs.com/blog/1543629/201811/1543629-20181122145959291-1354594364.png" alt="" /></p>
<p>这是js部分基础搭建桥，可以将其固定封装成单独的js文件，然后在main.js中引入，我们可以通过SwiftJSBridge.callNativeBridge传输数据。</p>
<p>假设网页端需要从ios端拿到token,便可以约定一个名为getToken的方法,{}里写着与ios约定好的JSON对象</p>
<div>
<div>window['first']=function() {</div>
<div>if(window.SwiftJSBridge){</div>
<div>SwiftJSBridge.callNativeBridge("getToken",{"data":"give me token"},function(data){</div>
<div>if(data.token){</div>
<div>//操作token</div>
<div>axios.defaults.headers.common['psstoken'] = data.token;</div>
<div>localStorage.setItem('token',data.token);</div>
<div>}</div>
<div>&nbsp;</div>
<div>return;</div>
<div>})</div>
<div>}</div>
<div>}</div>
</div>
<p class="p1"><span style="font-family: 'comic sans ms', sans-serif; font-size: 15px;">交互方面其实是简单的。但是关于ios版本不兼容插件问题会有很多麻烦之处。</span></p>
<p class="p1"><span style="font-family: 'comic sans ms', sans-serif; font-size: 15px;">ios9不兼容jquery.mobile 1.4.5以下，并且不兼容es6语法糖，所以会导致如果使用原生js写项目，在ios9版本的手机，会没有任何js的交互功能出现。改用jquery.mobile 1.4.5之后，的确可以兼容了，但是却出现了ios其他版本请求后台没有反应的情况，经过一系列排查发现jquery.mobile 1.4.5是不被ios其他版本兼容的，因此当这种兼容问题出现时，可以考虑从客户端拿版本进行判断，也可以无脑式将两种插件载入。。没想到这招可以。。爬坑艰难</span></p>
<p>---zyy小媛酱---</p>
<style><!--
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 19.0px; font: 13.0px 'Helvetica Neue'}
--></style>
<p class="p1"><span style="font-family: 'comic sans ms', sans-serif; font-size: 15px;">&nbsp;</span></p>
<style><!--
p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; line-height: 19.0px; font: 13.0px 'Helvetica Neue'}
--></style>
<p>基础概念：</p>
<p><strong>物理存储介质（The physical media）</strong></p>
<p>这里指系统的存储设备：硬盘，如：/dev/hda、/dev/sda等等，是存储系统最低层的存储单元。</p>
<p>&nbsp;</p>
<p><strong>物理卷（PV physical volume）</strong></p>
<p>物理卷就是指硬盘分区或从逻辑上与磁盘分区具有同样功能的设备(如RAID)，是LVM的基本存储逻辑块，但和基本的物理存储介质（如分区、磁盘等）比较，却包含有与LVM相关的管理参数。</p>
<p>&nbsp;</p>
<p><strong>卷组（VG Volume Group）</strong></p>
<p>LVM卷组类似于非LVM系统中的物理硬盘，其由物理卷组成。可以在卷组上创建一个或多个&ldquo;LVM分区&rdquo;（逻辑卷），LVM卷组由一个或多个物理卷组成。</p>
<p>&nbsp;</p>
<p><strong>逻辑卷（LV logical volume）</strong></p>
<p>LVM的逻辑卷类似于非LVM系统中的硬盘分区，在逻辑卷之上可以建立文件系统(比如/home或者/usr等)。</p>
<p>&nbsp;</p>
<p><strong>PE（physical extent）</strong></p>
<p>每一个物理卷被划分为称为PE(Physical Extents)的基本单元，具有唯一编号的PE是可以被LVM寻址的最小单元。PE的大小是可配置的，默认为4MB。</p>
<p>&nbsp;</p>
<p><strong>LE（logical extent）</strong></p>
<p>逻辑卷也被划分为被称为LE(Logical Extents) 的可被寻址的基本单位。在同一个卷组中，LE的大小和PE是相同的，并且一一对应。</p>
<p><img src="https://img2018.cnblogs.com/blog/1543717/201811/1543717-20181122154934493-426651119.png" alt="" /></p>
<p><img src="https://img2018.cnblogs.com/blog/1543717/201811/1543717-20181122155025381-336346936.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>fdisk命令参数介绍<br />       p、打印分区表。<br />       n、新建一个新分区。<br />       d、删除一个分区。<br />       q、退出不保存。<br />       w、把分区写进分区表，保存并退出<br />       t、转换格式</p>
<p>ext 文件系统管理工具<br /><span style="background-color: #666699;">mkfs.ext2,3,4</span><br />mkfs.ext2 没有日志功能</p>
<p>mkfs.ext4 /dev/sda2<br />ext文件系统专用管理工具：mke2fs<br />mke2fs [options] device<br />        -t[ext2|ext3|ext4]<br />        -b [1024|2048|4096] 指名文件系统块大小</p>
<p>-L 指明卷标</p>
<p>&nbsp;</p>
<p><span style="background-color: #666699;">blkid /dev/sda1 查看sda1分区文件系统类型</span></p>
<p>cat /proc/partitions 查看系统所有硬盘和上面的分区信息<br />partx 直接从硬盘读取分区信息并可以对系统关于硬盘分区信息的记录（/proc/partitions）进行更新<br /><span style="background-color: #666699;">partx -a [device] 通知内核强制重读磁盘分区表</span></p>
<p>e2lable: 卷标的查看与设定<br />         e2lable device 查看<br />         e2lable device Lable 设定</p>
<p>tune2fs 查看或修改ext文件系统<br />tune2fs -l device 查看超级块内容<br />        -j 将ext2 升级到ext3<br />        -L 修改卷标</p>
<p>losf mount_point 查看挂载点正在被哪些进程占用<br />fuser -v mount_point</p>
<p>fuser -km mount_point 终止所有正在访问挂载点的进程</p>
<p>设置开机挂载<br />编辑 /etc/fstab <br />    文件设备  挂载点  文件系统类型 </p>
<p><span style="background-color: #00ffff; font-size: 14pt;">R<span style="font-size: 16px;">AID&nbsp;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span></p>
<p>1.RAID-0</p>
<p>raid0的特性：采用剥离，数据将在几个磁盘上进行分割。数据被分成很多数据块，每一数据块会被写入不同的磁盘。从而， 每一磁盘的工作负荷都得到了降低，这有助于加速数据传输。RAID-0可让磁盘更好地响应，尤其是电子邮件、数据库和互联网应用。实施RAID-0最少需 要两块硬盘。优势：通过把I/O负载分布到多个硬盘上，可提高系统性能。实施简单。需要注意的是：RAID-0不具有数据保护功能，不适合于关键数据。 <span style="background-color: #ff0000;">读写性能提升，无容错能力 磁盘数：2，2+</span></p>
<p>&nbsp;</p>
<p><span style="background-color: #ff0000;"><span style="background-color: #ffffff;">2.RAID-1</span><br /></span></p>
<p><span style="background-color: #ff0000;"><span style="background-color: #ffffff;">raid1的特性：RAID-1通过磁盘镜像来实现，主要用来确保数据的可靠性。同样的数据将被复制存储到不同的磁盘上，如果某个磁盘出现 故障，还可以在阵列内的某个磁盘上找到相应的数据，因此可以很容易地进行恢复。镜像不但可以创建冗余数据而带来高可用性，还可以保持关键应用的正常运行。 优势：数据读取的性能有所提高，而数据写入性能与单个磁盘没有区别。100％数据冗余意味着某个出现磁盘故障时不需要对数据进行重建。需要注意的是：磁盘容量的低效率使用-在所有RAID类型中费用最高（100％）<span style="background-color: #ff0000;">读性能提升，写性能下降，有冗余能力。磁盘数：2，2+</span></span></span></p>
<p>&nbsp;</p>
<p>3.RAID-10&nbsp;</p>
<p>raid10的特性：RAID-10是RAID-1和RAID-0的结合。此配置要求至少4块硬盘，在所有RAID等级中，性能、保护功能 及容量都是最佳的。RAID-10包含成对的镜像磁盘，其数据在整个阵列上进行剥离。多数情况下，RAID-10能够承受多个磁盘出现故障的情况，因此更 能保证系统的正常运行。其数据丢失的几率最小。优势：与RAID-1（镜像）有同样的冗余特性，是数据保护的理想选择。需要注意的是：可能价格很高，与镜像磁盘阵列有关。<span style="background-color: #ff0000;">读写性能提升 有容错能力每组镜像最多坏一个 磁盘数：4，4+</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 16px; background-color: #00ffff;">LVM&amp;&amp;</span><span style="font-size: 16px; background-color: #00ffff;">快照</span></p>
<p><span style="font-size: 16px; background-color: #00ffff;">&nbsp;</span></p>
<p><span style="font-size: 12px; background-color: #ffffff;">PV管理工具：pvs：简要显示pv信息</span></p>
<p><span style="font-size: 12px; background-color: #ffffff;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pvdisplay：显示pv详细信息</span></p>
<p><span style="font-size: 12px; background-color: #ffffff;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;pvcreate /dev/xxx 创建PV</span></p>
<p><span style="font-size: 12px;">VG管理工具：vgs</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vgcreate vgname /dev/xxx 创建vg</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vgextend vgname /dev/xxx 扩展vg</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; vgreduce vgname /dev/xxx</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;先做pvremove</span></p>
<p><span style="font-size: 12px;">LV管理工具：lvs</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lvdisplay</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lvcreate -L 指大小 -n name Vg</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lvremove /dev/VG_name/lv_name</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 12px; background-color: #ffffff;">逻辑卷格式：8e&nbsp; Linux LVM</span></p>
<p><span style="font-size: 12px;">创建逻辑卷：1.创建分区，将分区格式化为LVM格式（fdisk /dev/xx --&gt; t --&gt;8e）</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 2.创建PV&nbsp; &nbsp; &nbsp;pvcreate /dev/xxx&nbsp;<br /></span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 3.创建VG&nbsp; &nbsp; &nbsp;vgcreate vgname /dev/xxx</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 4.创建LV&nbsp; &nbsp; &nbsp; lvcreate -L 1G -n mylv vgname</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 5.扩展逻辑卷 lvextend -L [size] /dev/VGname/LVname&nbsp;<br /></span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 6.缩减逻辑卷 umount /dev/vgname/lvname</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;e2fsck -f /dev/vgname/lvname</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;resize2fs /dev/vgname/lvname [size]</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;lvreduce -L [size] /dev/vgname/lvname</span></p>
<p><span style="font-size: 12px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;mount 重新挂载</span></p>
<p><span style="font-size: 12px;">之后可以将此逻辑卷当成设备使用进行格式化、挂载等操作</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 12px;"><img src="https://img2018.cnblogs.com/blog/1543717/201811/1543717-20181122185648427-731518978.png" alt="" /></span></p>
<p><img src="https://img2018.cnblogs.com/blog/1543717/201811/1543717-20181122185856035-1529801713.png" alt="" /></p>
<p>将创建的逻辑卷挂载&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1543717/201811/1543717-20181122190122061-565635540.png" alt="" /></p>
<p>&nbsp;</p>
<p><span style="background-color: #ff9900;">在线扩展逻辑卷，之后使用resize2fs 将文件系统扩展</span></p>
<p>&nbsp;&nbsp;<img src="https://img2018.cnblogs.com/blog/1543717/201811/1543717-20181122190926314-160296646.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="background-color: #00ffff;"><em><span style="font-size: 15px;">#快照</span></em></span></p>
<p><span style="background-color: #00ffff;"><em><span style="font-size: 15px;">&nbsp;</span></em></span></p>
<p>lvcreate -L [size] -p r[只读] -s snapshot_lv_name +逻辑卷</p>
<p><img src="https://img2018.cnblogs.com/blog/1543717/201811/1543717-20181123113943923-194430709.png" alt="" /></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 12px;">&nbsp; &nbsp;</span>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp; 这只是一个精简的SqlServer-RBAC五表权限，根据自身需求修改即可</p>
<p>--创建数据库-权限<br />CREATE DATABASE RBAC<br />GO<br />USE RBAC<br />GO</p>
<p>--1、权限表<br />CREATE TABLE t_permission (<br />  id INT PRIMARY KEY IDENTITY,<br />  name varchar(20) NOT NULL,<br />  [description] varchar(255)<br />)</p>
<p>--2、角色表<br />CREATE TABLE t_role (<br />  id INT PRIMARY KEY IDENTITY,<br />  name varchar(20) NOT NULL,<br />  [description] varchar(255)<br />)</p>
<p>--3、用户表<br />CREATE TABLE t_user (<br />  id INT PRIMARY KEY IDENTITY,<br />  username varchar(20) NOT NULL<br />)</p>
<p>--4、角色权限关系表<br />CREATE TABLE role_permission (<br />  id int PRIMARY KEY IDENTITY,<br />  role_id INT FOREIGN KEY REFERENCES dbo.t_role(id),<br />  permission_id INT FOREIGN KEY REFERENCES dbo.t_permission(id),<br />)</p>
<p>--5、用户角色关系表<br />CREATE TABLE user_role (<br />  id int PRIMARY KEY IDENTITY,<br />  user_id INT FOREIGN KEY REFERENCES dbo.t_user(id),<br />  role_id INT FOREIGN KEY REFERENCES dbo.t_role(id)<br />)</p>
<p><br />--测试数据<br />INSERT INTO t_permission VALUES ('小说收藏',NULL), ('小说发布',NULL), ('广告发布',NULL)<br />INSERT INTO t_role VALUES ('读者',NULL), ('作者',NULL), ('管理员',NULL)<br />INSERT INTO t_user VALUES ('reader'), ('author'), ('admin')<br />INSERT INTO role_permission VALUES ('1','1'), ('2','2'), ('3','3')<br />INSERT INTO user_role VALUES ('1','1'), ('2','2'), ('3','3')</p>
<p>--查询<br />SELECT * FROM dbo.t_permission<br />SELECT * FROM dbo.t_role<br />SELECT * FROM dbo.t_user<br />SELECT * FROM dbo.role_permission<br />SELECT * FROM dbo.user_role</p>
<p>&nbsp;</p>
<h2>Python转义字符</h2>
<p>在需要在字符中使用特殊字符时，python用反斜杠(\)转义字符。如下表：</p>
<table class="reference">
<thead>
<tr><th>转义字符</th><th>描述</th></tr>
</thead>
<tbody>
<tr>
<td>\(在行尾时)</td>
<td>续行符</td>
</tr>
<tr>
<td>\\</td>
<td>反斜杠符号</td>
</tr>
<tr>
<td>\'</td>
<td>单引号</td>
</tr>
<tr>
<td>\"</td>
<td>双引号</td>
</tr>
<tr>
<td>\a</td>
<td>响铃</td>
</tr>
<tr>
<td>\b</td>
<td>退格(Backspace)</td>
</tr>
<tr>
<td>\e</td>
<td>转义</td>
</tr>
<tr>
<td>\000</td>
<td>空</td>
</tr>
<tr>
<td>\n</td>
<td>换行</td>
</tr>
<tr>
<td>\v</td>
<td>纵向制表符</td>
</tr>
<tr>
<td>\t</td>
<td>横向制表符</td>
</tr>
<tr>
<td>\r</td>
<td>回车</td>
</tr>
<tr>
<td>\f</td>
<td>换页</td>
</tr>
<tr>
<td>\oyy</td>
<td>八进制数，yy代表的字符，例如：\o12代表换行</td>
</tr>
<tr>
<td>\xyy</td>
<td>十六进制数，yy代表的字符，例如：\x0a代表换行</td>
</tr>
<tr>
<td>\other</td>
<td>其它的字符以普通格式输出</td>
</tr>
</tbody>
</table>
<hr />
<h2>Python字符串运算符</h2>
<p>下表实例变量 a 值为字符串 "Hello"，b 变量值为 "Python"：</p>
<table class="reference">
<tbody>
<tr><th width="10%">操作符</th><th width="60%">描述</th><th>实例</th></tr>
<tr>
<td>+</td>
<td>字符串连接</td>
<td>
<div class="hl-main"><span class="hl-code">&gt;&gt;&gt;<span class="hl-identifier">a<span class="hl-code"> + <span class="hl-identifier">b<span class="hl-code"> <span class="hl-quotes">'<span class="hl-string">HelloPython<span class="hl-quotes">'</span></span></span></span></span></span></span></span></div>
</td>
</tr>
<tr>
<td>*</td>
<td>重复输出字符串</td>
<td>
<div class="hl-main"><span class="hl-code">&gt;&gt;&gt;<span class="hl-identifier">a<span class="hl-code"> * <span class="hl-number">2<span class="hl-code"> <span class="hl-quotes">'<span class="hl-string">HelloHello<span class="hl-quotes">'</span></span></span></span></span></span></span></span></div>
</td>
</tr>
<tr>
<td>[]</td>
<td>通过索引获取字符串中字符</td>
<td>
<div class="hl-main"><span class="hl-code">&gt;&gt;&gt;<span class="hl-identifier">a<span class="hl-brackets">[<span class="hl-number">1<span class="hl-brackets">]<span class="hl-code"> <span class="hl-quotes">'<span class="hl-string">e<span class="hl-quotes">'</span></span></span></span></span></span></span></span></span></div>
</td>
</tr>
<tr>
<td>[ : ]</td>
<td>截取字符串中的一部分</td>
<td>
<div class="hl-main"><span class="hl-code">&gt;&gt;&gt;<span class="hl-identifier">a<span class="hl-brackets">[<span class="hl-number">1<span class="hl-code">:<span class="hl-number">4<span class="hl-brackets">]<span class="hl-code"> <span class="hl-quotes">'<span class="hl-string">ell<span class="hl-quotes">'</span></span></span></span></span></span></span></span></span></span></span></div>
</td>
</tr>
<tr>
<td>in</td>
<td>成员运算符 - 如果字符串中包含给定的字符返回 True</td>
<td>
<div class="hl-main"><span class="hl-code">&gt;&gt;&gt;<span class="hl-quotes">"<span class="hl-string">H<span class="hl-quotes">"<span class="hl-code"> <span class="hl-reserved">in<span class="hl-code"> <span class="hl-identifier">a<span class="hl-code"> <span class="hl-reserved">True</span></span></span></span></span></span></span></span></span></span></div>
</td>
</tr>
<tr>
<td>not in</td>
<td>成员运算符 - 如果字符串中不包含给定的字符返回 True</td>
<td>
<div class="hl-main"><span class="hl-code">&gt;&gt;&gt;<span class="hl-quotes">"<span class="hl-string">M<span class="hl-quotes">"<span class="hl-code"> <span class="hl-reserved">not<span class="hl-code"> <span class="hl-reserved">in<span class="hl-code"> <span class="hl-identifier">a<span class="hl-code"> <span class="hl-reserved">True</span></span></span></span></span></span></span></span></span></span></span></span></div>
</td>
</tr>
<tr>
<td>r/R</td>
<td>原始字符串 - 原始字符串：所有的字符串都是直接按照字面的意思来使用，没有转义特殊或不能打印的字符。 原始字符串除在字符串的第一个引号前加上字母"r"（可以大小写）以外，与普通字符串有着几乎完全相同的语法。</td>
<td>
<div class="hl-main"><span class="hl-code">&gt;&gt;&gt;<span class="hl-reserved">print<span class="hl-code"> <span class="hl-identifier">r<span class="hl-quotes">'<span class="hl-special">\n<span class="hl-quotes">'<span class="hl-code"> \<span class="hl-identifier">n<span class="hl-code"> &gt;&gt;&gt; <span class="hl-reserved">print<span class="hl-code"> <span class="hl-identifier">R<span class="hl-quotes">'<span class="hl-special">\n<span class="hl-quotes">'<span class="hl-code"> \<span class="hl-identifier">n</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></div>
</td>
</tr>
<tr>
<td>%</td>
<td>格式字符串</td>
<td>请看下一章节</td>
</tr>
</tbody>
</table>
<pre>&lt;!DOCTYPE html&gt;<br />&lt;html&gt;<br />&lt;head&gt;<br />    &lt;meta charset="utf-8"&gt;<br />    &lt;meta name="description" content="jquery地图插件"&gt;<br />    &lt;meta name="keywords" content="jquery,jquery插件,jsmap,jsmap地图"&gt;<br />    &lt;title&gt;jsMap&lt;/title&gt;<br />    &lt;style&gt;<br />        *{margin:0;padding:0;outline:0}<br />        html{font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",Helvetica,"PingFang SC","Microsoft YaHei",Arial,sans-serif;-webkit-text-size-adjust:100%}<br />        body{background:#f5f5f5}<br />        main{display:block}<br />        ul{list-style:none}<br />        a{text-decoration:none;color:#2285ee}<br />        #container{position:relative;overflow:hidden;margin:0 auto;width:1010px;height:auto;background:#fff;box-shadow:#d6d6d6 0 0 15px}<br />    &lt;/style&gt;<br />&lt;/head&gt;<br />&lt;body&gt;<br />&lt;div id="container"&gt;<br />    &lt;h1&gt;jsMap 地图插件&lt;/h1&gt;<br />    &lt;div id="map"&gt;&lt;/div&gt;<br />&lt;/div&gt;<br />&lt;/body&gt;<br />&lt;script src="/js/map/jquery-1.9.0.min.js"&gt;&lt;/script&gt;<br />&lt;script src="/js/map/jsMap-2.0.0.min.js"&gt;&lt;/script&gt;<br />&lt;script&gt;<br />    $(function () {<br />        jsMap.json( "/js/map/map.json" ).done(function ( response ) {<br />            //jsMap.config( "#demo-01", response );   基础区块<br /><br />            jsMap.config( "#map", response, {<br />                //定义区块的颜色和宽度<br />                /*stroke: {<br />                    width: 2,<br />                    color: "#000"<br />                }*/<br /><br />                //disabled: [ "heilongjiang", "jilin", "liaoning" ],  禁用区域<br /><br />                //定义区块的填充色  悬浮色  点击色<br />                /*fill: {<br />                    basicColor: "#259200",<br />                    hoverColor: "#57cb00",<br />                    clickColor: "#2e6f18"<br />                }，*/<br /><br />                //显示区域文字和点击时的文字颜色<br />                /*areaName: {<br />                    show: true,<br />                    clickColor: "#fff"<br />                }*/<br /><br />                //自定义悬浮提示框<br />                /*tip: function ( id, name ) {<br />                    return '&lt;div style="background:#fff;padding:20px;"&gt;&lt;p&gt;id: ' + id + '&lt;/p&gt;&lt;p&gt;name: ' + name + '&lt;/p&gt;&lt;/div&gt;';<br />                },*/<br /><br />                //自定义指定区域的填充色 / 悬浮色 / 点击色<br />                fill: {<br />                    basicColor: {<br />                        heilongjiang: "#ff5900",<br />                        jilin: "#19bb00",<br />                        liaoning: "#6800ff",<br />                        jiangxi:"#8a3434"<br />                    },<br />                    hoverColor: {<br />                        heilongjiang: "#ff8c4e",<br />                        jilin: "#1fe000",<br />                        liaoning: "#954dff"<br />                    },<br />                    clickColor: {<br />                        heilongjiang: "#c94600",<br />                        jilin: "#159a00",<br />                        liaoning: "#5200c9"<br />                    },<br />                },<br />                //悬浮回调函数<br />                /*hoverCallback: function ( id, name ) {<br />                    console.log( id + " --- " + name );<br />                    alert( "666 --- 999");<br />                }*/<br /><br />                // multiple: true  点击选择多个区域<br />            });<br /><br />        })<br />    })<br />&lt;/script&gt;<br />&lt;/html&gt;<br /><br />//在线实例  http://jsmap.applinzi.com/</pre>
<p>dayofweek在hive2.2.0开始支持，低版本的hive原生未提供dayofweek函数(获取一个日期是星期几的方法)，所以只有我们自己编写udf函数提供，udf就不说了，在这里给出了一个使用hive原生函数获取星期几的技巧。<br /><br />pmod(datediff('${date}', '1920-01-01') - 3, 7) <br /><br />'${date}'表示给的日期。<br /><br />输出的结果为0-6的数，分别表示 日，一，二 ... 六。<br /><br />2016-01-01&nbsp;5<br />2016-01-02 6<br />2016-01-03 0<br /><br />如果想让周一到周六对应数字1-7只需要将查询出来的数据进行判断就行了，如下：<br /><br />IF(pmod(datediff('${date}', '1920-01-01') - 3, 7)='0', 7, pmod(datediff('${date}', '1920-01-01') - 3, 7))<br /><br />2016-01-01&nbsp;5<br />2016-01-02 6<br />2016-01-03 7<br /><br /></p>
<p>原因：</p>
<p>&nbsp; &nbsp; &nbsp; 由于某个分区满了，切磁盘无法扩大分区空间，但是项目依赖该分区，需要继续像该分区存储文件，此时其他分区还有很大的空间，使用挂载的方式，在有空间的分区创建新目录，将新目录挂载到源目录下即可。</p>
<p>执行mount操作报错如下</p>
<div class="cnblogs_Highlighter">
<pre class="brush:cpp;gutter:true;">[root@hostname home]# mount /home/wget/download /home/ftp/wget/download
mount: you must specify the filesystem type
</pre>
</div>
<p>最终执行命名</p>
<div class="cnblogs_Highlighter">
<pre class="brush:cpp;gutter:true;">[root@hostname download]# mount --bind /home/wget/download /home/ftp/wget/download
</pre>
</div>
<p>查看挂载成功</p>
<div class="cnblogs_Highlighter">
<pre class="brush:cpp;gutter:true;">[root@hostname download]# mount -l
/home/wget/download on /home/ftp/wget/download type none (rw,bind)
</pre>
</div>
<p>　　</p>
<p>1.&nbsp;综合使用&nbsp;loop,[bx]，编写完整汇编程序，实现向内存&nbsp;b800:07b8&nbsp;开始的连续&nbsp;16&nbsp;个字单元重复填充字数据&nbsp;0403H。</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121141239155-1435274750.png" alt="" /></p>
<p>该程序运行成功之后：</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121141429565-1408368755.png" alt="" /></p>
<p>将0403h--&gt;0401h之后实验结果为：&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121141522358-1593438641.png" alt="" /></p>
<p>实验内容二：</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121141656596-1221264338.png" alt="" /></p>
<p>编译连接运行无异常：</p>
<p>&nbsp; &nbsp;<img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121155223162-144145645.png" alt="" />&nbsp;</p>
<p>&nbsp;p命令调试（与t命令不同会跳过子程序）：</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121154731261-259811599.png" alt="" /></p>
<p>g命令与d命令调试（显示200-23f已成功修改）：&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121155023934-722427098.png" alt="" /></p>
<p>实验内容三：</p>
<p>下面的程序的功能是将&rdquo;mov ax,4c00h"之前的指令复制到内存0:200处，补全程序，上机调试，跟踪运行结果&nbsp;</p>
<p>assume cs:code<br data-filtered="filtered" />code segment<br data-filtered="filtered" />&nbsp; &nbsp; mov ax,___cs____<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;mov ds,ax<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;mov ax,0020h<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;mov es,ax<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;mov bx,0<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;mov cx,___17h____<br data-filtered="filtered" />&nbsp; s:mov al,[bx]<br data-filtered="filtered" />&nbsp; &nbsp; mov es:[bx],al<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;inc bx<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;loop s<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;mov ax,4c00h<br data-filtered="filtered" />&nbsp;&nbsp; &nbsp;int 21h<br data-filtered="filtered" />code ends<br data-filtered="filtered" />end</p>
<p>需要将代码段内的指令当作数据复制到目的地址当中去，cs是指向程序代码段的地址，因此第一个空填cs；</p>
<p>第二空先填入07h测试之后查看cx的值 随后减去最后两行代码（5字节）即为该值</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121192556335-1901696811.png" alt="" /></p>
<p>&nbsp;</p>
<p>cs=001c &nbsp; 则该值为17h；</p>
<p>源码：</p>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121193447987-268019401.png" alt="" /></p>
<p>编译连接运行：&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121193528406-1100433668.png" alt="" /></p>
<p>t命令逐行调试：&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121194439089-604203620.png" alt="" /></p>
<p>可见成功复制到目的es：0 地址。</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1485950/201811/1485950-20181121194815088-1742756309.png" alt="" /></p>
<p>&nbsp;</p>
<p>　　Java Character类</p>
<p>　　使用字符时，我们通常使用的是内置数据类型char。</p>
<p>　　实例</p>
<p>　　char ch = 'a';</p>
<p>　　// Unicode for uppercase Greek omega character</p>
<p>　　char uniChar = '\u039A';</p>
<p>　　// 字符数组</p>
<p>　　char[] charArray ={ 'a', 'b', 'c', 'd', 'e' };</p>
<p>　　然而，在实际开发过程中，我们经常会遇到需要使用对象，而不是内置数据类型的情况。为了解决这个问题，Java语言为内置数据类型char提供了包装类Character类。</p>
<p>　　Character类提供了一系列方法来操纵字符。你可以使用Character的构造方法创建一个Character类对象，例如：</p>
<p>　　Character ch = new Character('a');</p>
<p>　　在某些情况下，Java编译器会自动创建一个Character对象。</p>
<p>　　例如，将一个char类型的参数传递给需要一个Character类型参数的方法时，那么编译器会自动地将char类型参数转换为Character对象。 这种特征称为装箱，反过来称为拆箱。</p>
<p>　　实例</p>
<p>　　// Here following primitive char 'a'</p>
<p>　　// is boxed into the Character object ch</p>
<p>　　Character ch = 'a';</p>
<p>　　// Here primitive 'x' is boxed for method test,</p>
<p>　　// return is unboxed to char 'c'</p>
<p>　　char c = test('x');</p>
<p>　　转义序列</p>
<p>　　前面有反斜杠(\)的字符代表转义字符，它对编译器来说是有特殊含义的。</p>
<p>　　下面列表展示了Java的转义序列：</p>
<p>　　转义序列描述</p>
<p>　　\t在文中该处插入一个tab键</p>
<p>　　\b在文中该处插入一个后退键</p>
<p>　　\n在文中该处换行</p>
<p>　　\r在文中该处插入回车</p>
<p>　　\f在文中该处插入换页符</p>
<p>　　\'在文中该处插入单引号</p>
<p>　　\"在文中该处插入双引号</p>
<p>　　\\在文中该处插入反斜杠</p>
<p>　　实例</p>
<p>　　当打印语句遇到一个转义序列时，编译器可以正确地对其进行解释。</p>
<p>　　public class Test {</p>
<p>　　public static void main(String args[]) {</p>
<p>　　System.out.println("She said \"Hello!\" to me.");</p>
<p>　　}</p>
<p>　　}</p>
<p>　　以上实例编译运行结果如下：</p>
<p>　　She said "Hello!" to me.</p>
<p>　　Character 方法</p>
<p>　　下面是Character类的方法：</p>
<p>　　序号方法与描述</p>
<p>　　1isLetter()</p>
<p>　　是否是一个字母</p>
<p>　　2isDigit()</p>
<p>　　是否是一个数字字符</p>
<p>　　3isWhitespace()</p>
<p>　　是否一个空格</p>
<p>　　4isUpperCase()</p>
<p>　　是否是大写字母</p>
<p>　　5isLowerCase()</p>
<p>　　是否是小写字母</p>
<p>　　6toUpperCase()</p>
<p>　　指定字母的大写形式</p>
<p>　　7toLowerCase()</p>
<p>　　指定字母的小写形式</p>
<p>　　8toString()</p>
<p>　　返回字符的字符串形式，字符串的长度仅为1</p>
<p>　　对于方法的完整列表，请参考的java.lang.Character API规范。(编辑：雷林鹏 来源：网络)</p>
<div class="col-sm-10 content">
<div class="article-content">
<h1 id="-">中间件</h1>
<h2 id="-">中间件介绍</h2>
<h3 id="-">什么是中间件？</h3>
<ul>
<li>在WSGI协议中，中间件的两端分别是Web服务器和Web应用，对于Web服务器而言，中间件充当的Web应用，对于Web应用而言，中间件充当的是Wen服务器。 因此我们可以把中间件看做一个插件，这个插件可以用来修改django<strong>全局输入和输出</strong>（在Django中就是一个中间件类），我们可以将自己想要在请求生命周期中要实现的业务逻辑放在中间件中，从而介入请求和响应的处理过程。</li>
</ul>
<h3 id="-">中间件的应用</h3>
<ul>
<li>在目前接触到的项目中，中间件主要用来做<code>用户登录认证</code>和<code>权限认证</code>，在Vue前后端分离的项目中，中间件还可以用来解决跨域问题（使用的是CORS配合中间件批量解决的，后面有这个东西的源码）</li>
</ul>
<h3 id="-">啥时候用中间件咧？</h3>
<ul>
<li>中间件默认对所有经过WSGI之后的请求进行处理，因此，<strong>当对批量的请求做操作的时候，选择中间件， 当仅对较少的请求做处理的时候，选择装饰器</strong></li>
</ul>
<h2 id="django-">django中的中间件</h2>
<h3 id="django-">django内置中间件</h3>
<p>常见的有</p>
<ol>
<li>SessionMiddleware
<ul>
<li>用来开启session支持，这个中间件在process_request和process_response中实现了对session数据的增删改查操作</li>
</ul>
</li>
<li>CsrfViewMiddleware
<ul>
<li>添加跨站点请求伪造的保护，通过向POST表单添加一个隐藏的表单字段，并检查请求中是否有正确的值</li>
</ul>
</li>
<li>AuthenticationMiddleware
<ul>
<li>当我们使用了django内置的<code>认证组件（或者django restframe work）</code>时，向每个接收到的HttpRequest对象添加user属性</li>
</ul>
</li>
</ol>
<h2 id="django-csrf-csrfviewmiddleware-">django项目中csrf攻击的解决与CsrfViewMiddleware中间件</h2>
<h3 id="csrftoken">csrftoken</h3>
<ul>
<li>
<p>当在配置中注册了该CsrfViewMiddleware中间件的时候，客户端发起的POST请求就必须提供一个token字符串，在CsrfViewMiddleware中间件的process_view方法中对该token数据进行验证，一旦验证失败，就会返回一个403的响应</p>
<ul>
<li>这串数据存放在在模板中使用<code>{% csrftoken %}</code>生成的一个隐藏的input标签中。</li>
</ul>
</li>
<li>
<p>如果在前端我们发送Ajax请求的话，还需要注意客户端发送的Content-type类型，当content-type为application/json的时候，我们需要将token数据放在请求头中，当为application/x-www-form-urlencode的时候，直接放在请求体中即可（因为csrfmiddleware中间件会通过请求头和请求体两种方式去获取token数据）</p>
<ul>
<li>当服务端接收到这个请求的时候，在经过csrfmiddleware中间件的时候，就会取出请求头或者请求体中存放的tken数据与服务端生成的数据是否相同，如果相同，那么csrf验证就会通过，如果验证失败，就会返回一个响应状态码为403的response</li>
</ul>
</li>
</ul>
<h3 id="-process_view-">为什么是process_view？</h3>
<ul>
<li>对呀，为什么是在process_view中处理token验证而不是在process_request中呢？
<ul>
<li>翻看了一下CsrfViewMiddleware中间件的源码，发现其实django还提供了两个装饰器，分别是<code>csrf_exempt</code>、<code>csrf_protect</code>，当我们使用<code>csrf_exempt</code>装饰一个视图函数的时候，这个视图函数就可以免去csrftoken的验证环节，而<code>csrf_protect</code>则恰恰相反。</li>
<li>要想判断一个视图函数是否被这两个装饰器装饰了，就不能使用process_request了，因为从process_requst中我们没法获取到<code>视图函数对象</code>，在process_view中，通过参数中的<code>callback</code>我们可以获取到对应的<code>视图函数对象</code>，在<code>CsrfViewMiddleware</code>源码中，是通过反射<code>getattr</code>来实现<code>csrf_exempt</code>的。<code>csrf_exempt</code>装饰器会给内层函数绑定一个<code>csrf_exempt</code>属性，且值为<code>True</code>，中间件的<code>process_view</code>中通过反射判断是否对该视图函数进行csrftoken验证，如果返回True，那么process_view就会直接返回一个<code>None</code>来跳过验证</li>
</ul>
</li>
</ul>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">def</span><span style="color: #000000;"> csrf_exempt(view_func):
    </span><span style="color: #800000;">"""</span><span style="color: #800000;">Mark a view function as being exempt from the CSRF view protection.</span><span style="color: #800000;">"""</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> view_func.csrf_exempt = True would also work, but decorators are nicer</span>
    <span style="color: #008000;">#</span><span style="color: #008000;"> if they don't have side effects, so return a new function.</span>
    <span style="color: #0000ff;">def</span> wrapped_view(*args, **<span style="color: #000000;">kwargs):
        </span><span style="color: #0000ff;">return</span> view_func(*args, **<span style="color: #000000;">kwargs)
    wrapped_view.csrf_exempt </span>=<span style="color: #000000;"> True
    </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> wraps(view_func)(wrapped_view)

</span><span style="color: #008000;">#</span><span style="color: #008000;"> -------------------- 分割线 -----------------------</span>
    <span style="color: #0000ff;">def</span><span style="color: #000000;"> process_view(self, request, callback, callback_args, callback_kwargs):
        </span><span style="color: #0000ff;">if</span> getattr(request, <span style="color: #800000;">'</span><span style="color: #800000;">csrf_processing_done</span><span style="color: #800000;">'</span><span style="color: #000000;">, False):
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> None

        </span><span style="color: #008000;">#</span><span style="color: #008000;"> Wait until request.META["CSRF_COOKIE"] has been manipulated before</span>
        <span style="color: #008000;">#</span><span style="color: #008000;"> bailing out, so that get_token still works</span>
        <span style="color: #0000ff;">if</span> getattr(callback, <span style="color: #800000;">'</span><span style="color: #800000;">csrf_exempt</span><span style="color: #800000;">'</span><span style="color: #000000;">, False):
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> None

        </span><span style="color: #008000;">#</span><span style="color: #008000;"> 其他无关的忽略</span></pre>
</div>
<p>&nbsp;</p>
<h2 id="-">配置和使用中间件</h2>
<h3 id="setting-py">setting.py</h3>
<div class="cnblogs_code">
<pre>MIDDLEWARE =<span style="color: #000000;"> [
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.middleware.security.SecurityMiddleware</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.sessions.middleware.SessionMiddleware</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.middleware.common.CommonMiddleware</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.middleware.csrf.CsrfViewMiddleware</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.auth.middleware.AuthenticationMiddleware</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.messages.middleware.MessageMiddleware</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.middleware.clickjacking.XFrameOptionsMiddleware</span><span style="color: #800000;">'</span><span style="color: #000000;">,
]</span></pre>
</div>
<h4 id="-settings-">关于settings中间件的配置顺序</h4>
<ul>
<li>settings文件中middleware配置顺序非常重要，因为一个中间件可能依赖于另外一个，比如一些我们定义的用于用户认证或者权限认证的中间件，在他们的process_request方法中可能会用到session。因此这些中间件必须在SessionMiddleware之后运行</li>
<li>综上，我们自定义的中间件尽量放在列表的后面</li>
</ul>
<h3 id="-">中间件的工作过程</h3>
<ol>
<li>客户端发起请求</li>
<li>请求首先到达实现了WSGI协议的Web服务器，然后Web服务器处理请求，并转发请求</li>
<li>由于定义了中间件，对于Web服务器而言，中间件就相当于Web应用，所以请求会交给中间件处理。<ol>
<li>请求首先被中间件的process_request方法处理</li>
<li>然后被中间件的process_view方法处理</li>
<li>接着才会执行请求对应的视图函数，视图函数进一步处理请求，并返回一个响应</li>
<li>然后按照中间件列表中相反的顺序，执行中间件的process_template_resposne方法</li>
<li>最后按照中间件列表中相反的顺序，执行中间件的process_response方法</li>
</ol></li>
<li>response到达Web服务器，经过Web服务器处理之后，最终发送给用户浏览器</li>
</ol>
<h4 id="-">创建中间件</h4>
<ul>
<li>中间件本质上就是一个类，在Django的新版本中，创建的类需要继承自<code>MiddlewareMixin</code>类</li>
<li>在不同的版本中，继承的类名可能会发生变化，因此我们在创建中间件类的时候，应该直接将<code>MiddlewareMixin</code>类的整个内容拷贝。（版本变动找不到MiddlewareMixin的时候，可以通过已有的中间件去寻找）</li>
</ul>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">class</span><span style="color: #000000;"> MiddlewareMixin(object):
    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__init__</span>(self, get_response=<span style="color: #000000;">None):
        self.get_response </span>=<span style="color: #000000;"> get_response
        super(MiddlewareMixin, self).</span><span style="color: #800080;">__init__</span><span style="color: #000000;">()

    </span><span style="color: #0000ff;">def</span> <span style="color: #800080;">__call__</span><span style="color: #000000;">(self, request):
        response </span>=<span style="color: #000000;"> None
        </span><span style="color: #0000ff;">if</span> hasattr(self, <span style="color: #800000;">'</span><span style="color: #800000;">process_request</span><span style="color: #800000;">'</span><span style="color: #000000;">):
            response </span>=<span style="color: #000000;"> self.process_request(request)
        </span><span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span><span style="color: #000000;"> response:
            response </span>=<span style="color: #000000;"> self.get_response(request)
        </span><span style="color: #0000ff;">if</span> hasattr(self, <span style="color: #800000;">'</span><span style="color: #800000;">process_response</span><span style="color: #800000;">'</span><span style="color: #000000;">):
            response </span>=<span style="color: #000000;"> self.process_response(request, response)
        </span><span style="color: #0000ff;">return</span> response</pre>
</div>
<h6 id="-">中间件类中可以定义哪些方法</h6>
<ul>
<li>在中间件类中可以定义5中方法：<ol>
<li>process_request(self, request)
<ul>
<li>返回值<ol>
<li>None：执行下一个中间件的process_request</li>
<li>HttpResponse：直接返回，依次执行当前中间件之前中间件的process_response方法</li>
</ol></li>
</ul>
</li>
<li>process_response(self, request, response)
<ul>
<li>返回值
<ul>
<li>必须返回一个HttpResonse对象或者streamingHttpResponse对象</li>
</ul>
</li>
</ul>
</li>
<li>process_view(self, request. view_func, view_args, view_kwargs)
<ul>
<li>返回值<ol>
<li>None：执行下一个中间件的process_view方法</li>
<li>HttpResposne</li>
</ol></li>
</ul>
</li>
<li>process_template_resposne
<ul>
<li>返回值
<ul>
<li>必须返回一个实现了render方法的响应对象</li>
</ul>
</li>
</ul>
</li>
<li>process_exception
<ul>
<li>返回值<ol>
<li>None，触发默认的异常处理机制</li>
<li>HttpResponse对象，接着调用template_respone和resposne</li>
</ol></li>
</ul>
</li>
</ol></li>
</ul>
<h6 id="-">创建中间件类</h6>
<ul>
<li>
<p><code>process_request(self, request)</code></p>
</li>
<li>
<p><code>process_response(self, request, response)</code></p>
</li>
<li>
<p><span style="background-color: #ffff00;"><strong>注意</strong></span></p>
<ul>
<li>这里的request与response对应此次链接的客户端请求和服务端响应，因此我们可以通过request的属性来控制中间件的作用范围</li>
<li><strong>process_request</strong>的返回值问题
<ul>
<li>如果没有返回值(return None)，将继续执行下一个中间件的<code>process_request</code>方法或视图函数</li>
<li>如果有返回值，执行自己的process_response和列表中位于当前中间件之前的<code>process_response</code>方法</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="lang-python"># setting.py</code></pre>
<div class="cnblogs_code">
<pre>INSTALLED_APPS =<span style="color: #000000;"> [
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.admin</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.auth</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.contenttypes</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.sessions</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.messages</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">django.contrib.staticfiles</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">app.apps.AppConfig</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">md.mymd.M1</span><span style="color: #800000;">'</span><span style="color: #000000;">,
    </span><span style="color: #800000;">'</span><span style="color: #800000;">md.mymd.M2</span><span style="color: #800000;">'</span><span style="color: #000000;">
]</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">class</span><span style="color: #000000;"> M1(MiddlewareMixin):
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> process_request(self, request):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">in M1 process_request</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> process_response(self, request, response):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">in M1 process_response</span><span style="color: #800000;">'</span><span style="color: #000000;">)


</span><span style="color: #0000ff;">class</span><span style="color: #000000;"> M2(MiddlewareMixin):
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> process_request(self, request):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">in M2 process_request</span><span style="color: #800000;">'</span><span style="color: #000000;">)

    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> process_response(self, request, response):
        </span><span style="color: #0000ff;">print</span>(<span style="color: #800000;">'</span><span style="color: #800000;">in M2 process_response</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<pre><code class="lang-python"># views.py</code></pre>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">def</span><span style="color: #000000;"> index(request):
    </span><span style="color: #0000ff;">return</span> HttpResponse(<span style="color: #800000;">'</span><span style="color: #800000;">test middleware</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
<h6 id="-request-path_info-">使用request.path_info限制中间件的作用范围</h6>
<ul>
<li>用户登陆成功之后，我们要给该用户设置session，如果下次，当进入登陆界面的时候，向服务端发送的Get请求，</li>
</ul>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">class</span><span style="color: #000000;"> MyMd1(MiddlewareMixin):
    </span><span style="color: #0000ff;">def</span><span style="color: #000000;"> process_request(self, request):
        </span><span style="color: #0000ff;">from</span> django.conf <span style="color: #0000ff;">import</span><span style="color: #000000;"> settings
        </span><span style="color: #0000ff;">from</span> django.shortcuts <span style="color: #0000ff;">import</span><span style="color: #000000;"> redirect

        </span><span style="color: #0000ff;">if</span> request.path_info == <span style="color: #800000;">'</span><span style="color: #800000;">/login/</span><span style="color: #800000;">'</span><span style="color: #000000;">:
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> None

        </span><span style="color: #0000ff;">if</span> <span style="color: #0000ff;">not</span> request.session.get(settings.LOGINAUTH, default=<span style="color: #000000;">False):
            </span><span style="color: #0000ff;">return</span> redirect(to=<span style="color: #800000;">'</span><span style="color: #800000;">/login/</span><span style="color: #800000;">'</span>)</pre>
</div>
<p>&nbsp;</p>
</div>
</div>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.annotation.JsonInclude.Include;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.core.JsonGenerator.Feature;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.core.type.TypeReference;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.databind.DeserializationConfig;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.databind.DeserializationFeature;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.databind.JavaType;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.databind.ObjectMapper;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.databind.SerializationConfig;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> com.fasterxml.jackson.databind.SerializationFeature;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> java.io.IOException;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.apache.commons.lang.StringUtils;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.Logger;
</span><span style="color: #0000ff;">import</span><span style="color: #000000;"> org.slf4j.LoggerFactory;

</span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> SerializeUtils {
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> Logger logger = LoggerFactory.getLogger(SerializeUtils.<span style="color: #0000ff;">class</span><span style="color: #000000;">);
    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> ObjectMapper mapper = <span style="color: #0000ff;">new</span><span style="color: #000000;"> ObjectMapper();

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> SerializeUtils() {
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> String toJson(Object object, <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> ignoreNull) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> toJson(object);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> String toJson(Object object) {
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> mapper.writeValueAsString(object);
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException var2) {
            logger.error(var2.getMessage(), var2);
            </span><span style="color: #0000ff;">return</span> ""<span style="color: #000000;">;
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> &lt;X&gt; X fromJson(String jsonStr, Class&lt;X&gt;<span style="color: #000000;"> x) {
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            </span><span style="color: #0000ff;">return</span> StringUtils.isBlank(jsonStr) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : mapper.readValue(jsonStr, x);
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException var3) {
            logger.error(var3.getMessage(), var3);
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> &lt;X&gt; X fromJson(String jsonStr, TypeReference&lt;X&gt;<span style="color: #000000;"> valueTypeRef) {
        </span><span style="color: #0000ff;">try</span><span style="color: #000000;"> {
            </span><span style="color: #0000ff;">return</span> StringUtils.isBlank(jsonStr) ? <span style="color: #0000ff;">null</span><span style="color: #000000;"> : mapper.readValue(jsonStr, valueTypeRef);
        } </span><span style="color: #0000ff;">catch</span><span style="color: #000000;"> (IOException var3) {
            logger.error(var3.getMessage(), var3);
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
        }
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">boolean</span> canSerialize(Class&lt;?&gt;<span style="color: #000000;"> type) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> mapper.canSerialize(type);
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> canDeserialize(JavaType type) {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> mapper.canDeserialize(type);
    }

    </span><span style="color: #0000ff;">static</span><span style="color: #000000;"> {
        SerializationConfig serializationConfig </span>=<span style="color: #000000;"> mapper.getSerializationConfig();
        serializationConfig </span>=<span style="color: #000000;"> serializationConfig.with(Feature.WRITE_BIGDECIMAL_AS_PLAIN).without(SerializationFeature.WRITE_NULL_MAP_VALUES);
        mapper.setConfig(serializationConfig);
        mapper.setSerializationInclusion(Include.NON_NULL);
        DeserializationConfig deserializationConfig </span>=<span style="color: #000000;"> mapper.getDeserializationConfig();
        deserializationConfig </span>=<span style="color: #000000;"> deserializationConfig.with(DeserializationFeature.USE_BIG_DECIMAL_FOR_FLOATS).without(DeserializationFeature.FAIL_ON_UNKNOWN_PROPERTIES);
        mapper.setConfig(deserializationConfig);
    }
}</span></pre>
</div>
<p>&nbsp;</p>
<p class="dek">https://www.oreilly.com/ideas/applying-the-kappa-architecture-in-the-telco-industry</p>
<p class="dek">&nbsp;</p>
<p class="dek">Kappa architecture and Bayesian models yield quick, accurate analytics in cloud monitoring systems.</p>
<div class="byline">By <span class="author"><a href="https://www.oreilly.com/people/dbb54-nicolas-seyvet">Nicolas Seyvet</a><span class="author"><a href="https://www.oreilly.com/people/53d59-ignaciomanuel-mulasviela">Ignacio Mulas Viela</a> </span></span></div>
<p>May 19, 2016</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>Ever-growing volumes of data, shorter time constraints, and an increasing need for accuracy are defining the new analytics environment. In the telecom industry, traditional user and network data co&shy;exists with machine-&shy;to-&shy;machine (M2M) traffic, media data, social activities, and so on. In terms of volume, this can be referred to as an &ldquo;explosion&rdquo; of data. This is a great business opportunity for telco operators and a key angle to take full advantage of current infrastructure investments (4G, LTE).</p>
<p>In this blog post, we will describe an approach to quickly ingest and analyze large volumes of streaming data, the <em>Kappa architecture</em>, as well as how to build a Bayesian online-&shy;learning model to detect novelties in a complex environment. Note that novelty does not necessarily imply an undesired situation;&nbsp; it indicates a change from previously known behaviours.</p>
<p>We apply both Kappa and the Bayesian model to a use case using a data stream originating from a telco cloud monitoring system. The stream is composed of telemetry and log events. It is high&shy; volume, as many physical servers and virtual machines are monitored simultaneously.</p>
<div class="block-product   right">
<h4 class="kicker ">Session</h4>
<div class="title">
<h2><a href="http://conferences.oreilly.com/strata/hadoop-big-data-eu/public/schedule/detail/49506/public/schedule/detail/49506">Kappa Architecture in the telecom industry</a></h2>
</div>
<div class="meta">
<h3><a class="secondary" href="http://conferences.oreilly.com/strata/hadoop-big-data-eu/public/schedule/detail/49506/public/schedule/detail/49506">Strata + Hadoop World in London 2016</a></h3>
</div>
</div>
<p>The proposed method quickly detects anomalies with high accuracy while adapting (learning) over time to new system normals, making it a desirable tool for considerably reducing maintenance costs associated with operability of large computing infrastructures.</p>
<h2>What is &ldquo;Kappa architecture&rdquo;?</h2>
<p>In a 2014 <a href="https://www.oreilly.com/ideas/questioning-the-lambda-architecture">blog post</a>, Jay Kreps accurately coined the term <em>Kappa architecture</em> by pointing out the pitfalls of the Lambda architecture and proposing a potential software evolution. To understand the differences between the two, let's first observe what the Lambda architecture looks like:</p>
<p><img class="iimagesfigure1_lambda-architecturepng" src="https://d3ansictanv2wj.cloudfront.net/figure1_lambda-architecture-80a729457cd23f1c24bfd9132537fd4b.png" alt="Lambda architecture" /> <span class="label">Figure 1. Lambda architecture. Figure courtesy of Ignacio Mulas Viela and Nicolas Seyvet.</span></p>
<p>As shown in Figure 1, the Lambda architecture is composed of three layers: a batch layer, a real&shy;-time (or streaming) layer, and a serving layer. Both the batch and real&shy;-time layers receive a copy of the event, in parallel. The serving layer then aggregates and merges computation results from both layers into a complete answer.</p>
<p>The batch layer (aka, historical layer) has two major tasks: managing historical data and re&shy;computing results such as machine learning models. Computations are based on iterating over the entire historical data set. Since the data set can be large, this produces accurate results at the cost of high latency due to high computation time.</p>
<p>The real&shy;-time layer( speed layer, streaming layer) provides low-&shy;latency results in near real-&shy;time fashion. It performs updates using incremental algorithms, thus significantly reducing computation costs, often at the expense of accuracy.</p>
<p>The Kappa architecture simplifies the Lambda architecture by removing the batch layer and replacing it with a streaming layer. To understand how this is possible, one must first understand that a batch is a data set with a start and an end (bounded), while a stream has no start or end and is infinite (unbounded). Because a batch is a bounded stream, one can conclude that batch processing is a subset of stream processing.&nbsp; Hence, the Lambda batch layer results can also be obtained by using a streaming engine. This simplification reduces the architecture to a single streaming engine capable of ingesting the needed volumes of data to handle both batch and real-time processing. Overall system complexity significantly decreases with Kappa architecture. See Figure 2:</p>
<p><img class="iimagesfigure2_kappa-architecturepng" src="https://d3ansictanv2wj.cloudfront.net/figure2_kappa-architecture-51de195715f9d2417b0814c3e537c355.png" alt="Kappa architecture" /> <span class="label">Figure 2. Kappa architecture. Figure courtesy of Ignacio Mulas Viela and Nicolas Seyvet.</span></p>
<p>Intrinsically, there are four main principles in the Kappa architecture:</p>
<div class="block-product   right">
<div class="cta">O'Reilly Data Newsletter</div>
<div class="title">
<h2><a href="https://www.oreilly.com/ideas/applying-the-kappa-architecture-in-the-telco-industry">Get the O'Reilly Data Newsletter</a></h2>
</div>
<div class="meta">
<p class="dek">Receive weekly insight from industry insiders&mdash;plus exclusive content, offers, and more on the topic of data.</p>
<div class="mktoForm-email -large medium -small smallContainer"><form class="mktoForm subscribe mktoHasWidth mktoLayoutAbove" data-formid="1114" data-forminstance="rightRail" data-formtopic="Data">
<div class="mktoFormRow mktoEmailRow">
<div class="mktoFieldDescriptor mktoFormCol">
<div class="mktoOffset">&nbsp;</div>
<div class="mktoFieldWrap mktoRequiredField"><label class="mktoLabel mktoHasWidth" for="Email">Your Email</label><input id="Email" class="mktoField mktoEmailField mktoHasWidth mktoRequired" type="email" name="Email" maxlength="255" /></div>
</div>
</div>
<div class="mktoFormRow mktoCountryRow">
<div class="mktoFieldDescriptor mktoFormCol">
<div class="mktoOffset">&nbsp;</div>
<div class="mktoFieldWrap mktoRequiredField"><label class="mktoLabel mktoHasWidth" for="Country">Country</label></div>
</div>
</div>
</form></div>
</div>
</div>
<div class="mktoFormRow mktoCountryRow">&nbsp;</div>
<div class="mktoFormRow mktoConsentRow">&nbsp;</div>
<div class="mktoButtonRow">&nbsp;</div>
<div class="block-product   right">
<div class="meta">
<div class="mktoForm-email -large medium -small smallContainer"><form class="mktoForm subscribe mktoHasWidth mktoLayoutAbove" data-formid="1114" data-forminstance="rightRail" data-formtopic="Data"></form><a class="mktoPrivacyLink" href="https://www.oreilly.com/privacy.html">Please read our Privacy Policy.</a></div>
</div>
</div>
<ol>
<li><strong>Everything is a stream:</strong> Batch operations become a subset of streaming operations. Hence, everything can be treated as a stream.</li>
<li><strong>Immutable data sources:</strong> Raw data (data source) is persisted and views are derived, but a state can always be recomputed as the initial record is never changed.</li>
<li><strong>Single analytics framework:</strong> Keep it short and simple (KISS) principle. A single analytics engine is required. Code, maintenance, and upgrades are considerably reduced.</li>
<li><strong>Replay functionality:</strong> Computations and results can evolve by replaying the historical data from a stream.</li>
</ol>
<p>In order to respect principle four, the data pipeline must guarantee that events stay in order from generation to ingestion. This is critical to guarantee consistency of results, as this guarantees deterministic computation results. Running the same data twice through a computation must produce the same result.</p>
<p>These four principles do, however, put constraints on building the analytics pipeline.</p>
<h2>Building the analytics pipeline</h2>
<p>Let ́s start concretizing how we can build such a data pipeline and identify the sorts of components required.</p>
<p>The first component is a scalable, distributed messaging system with events ordering and at-least-once delivery guarantees. <a href="http://kafka.apache.org/">Kafka</a> can connect the output of one process to the input of another via a publish&shy;-subscribe mechanism. Using it, we can build something similar to the Unix pipe systems where the output produced by one command is the input to the next.</p>
<p>The second component is a scalable stream analytics engine. Inspired by the <a href="http://research.google.com/pubs/pub43864.html">Google Dataflow paper</a>, <a href="https://flink.apache.org/">Flink</a>, at its core, is a streaming dataflow engine that provides data distribution, communication, and fault tolerance for distributed computations over data streams. One of its most interesting API features allows usage of the event timestamp to build time windows for computations.</p>
<p>The third and fourth components are a real-&shy;time analytics store, <a href="https://www.elastic.co/">Elasticsearch</a>, and a powerful visualisation tool, <a href="https://www.elastic.co/products/kibana">Kibana</a>. Those two components are not critical, but they&rsquo;re useful to store and display raw data and results.</p>
<p>Mapping the Kappa architecture to its implementation, Figure 3 illustrates the resulting data pipeline:</p>
<p><img class="iimagesfigure3_implementation-archpng" src="https://d3ansictanv2wj.cloudfront.net/figure3_implementation-arch-1fa64ff774cf7beee94884c496c258ad.png" alt="Kappa architecture reflected in a data pipeline" /> <span class="label">Figure 3. Kappa architecture reflected in a data pipeline. Figure courtesy of Ignacio Mulas Viela and Nicolas Seyvet.</span></p>
<p>This pipeline creates a composable environment where outputs of different jobs can be re&shy;used as inputs to another. Each job can thus be reduced to a simple, well-defined role. The composability allows for fast development of new features. In addition, data ordering and delivery are guaranteed, making results consistent. Finally, event timestamps can be used to build time windows for computations.</p>
<div class="block-product    right">
<h4 class="kicker ">EBOOK</h4>
<div class="thumb orientation-vertical"><a href="https://shop.oreilly.com/product/0636920033196.do"><img class="orientation-vertical" src="https://akamaicovers.oreilly.com/images/9781491900048/cat.gif" alt="" /></a></div>
<div class="title">
<h2><a href="https://shop.oreilly.com/product/0636920033196.do">Hadoop Application Architectures</a></h2>
</div>
<div class="meta">
<div class="byline">By <span class="author"><a href="https://shop.oreilly.com/product/0636920033196.do">Jonathan Seidman</a><span class="author"><a href="https://shop.oreilly.com/product/0636920033196.do">Gwen Shapira</a><span class="author"><a href="https://shop.oreilly.com/product/0636920033196.do">Ted Malaska</a><span class="author"><a href="https://shop.oreilly.com/product/0636920033196.do">Mark Grover</a></span></span></span></span></div>
<a class="more" href="https://shop.oreilly.com/product/0636920033196.do"> Shop now </a></div>
</div>
<p>Applying the above to our telco use case, each physical host and virtual machine (VM) telemetry and log event is collected and sent to Kafka. We use <a href="https://collectd.org/">collectd</a> on the hosts, and <a href="https://wiki.openstack.org/wiki/Telemetry">ceilometer</a> on the VMs for telemetry, and <a href="https://github.com/elastic/logstash-forwarder">logstash-forwarder</a> for logs. Kafka then delivers this data to different Flink jobs that transform and process the data. This monitoring gives us both the physical and virtual resource views of the system.</p>
<p>With the data pipeline in place, let&rsquo;s look at how a Bayesian model can be used to detect novelties in a telco cloud.</p>
<h2>Incorporating a Bayesian model to do advanced analytics</h2>
<p>To detect novelties, we use a Bayesian model. In this context, novelties are defined as unpredicted situations that differ from previous observations. The main idea behind Bayesian statistics is to compare statistical distributions and determine how similar or different they are. The goal here is to:</p>
<ul>
<li>determine the distribution of parameters to detect an anomaly,</li>
<li>compare new samples for each parameter against calculated distributions and determine if the obtained value is expected or not,</li>
<li>and combine all parameters to determine if there is an anomaly.</li>
</ul>
<p>Let&rsquo;s dive into the math to explain how we can perform this operation in our analytics framework. Considering the anomaly A, a new sample z, &theta; observed parameters, P(&theta;) the probability distribution of the parameter, A(z|&theta;) the probability that z is an anomaly, X the samples, the Bayesian Principal Anomaly can be written as:</p>
<p><em>A (z | X) = &int;A(&theta;)P(&theta;|X) </em></p>
<p>A principal anomaly as defined above is valid also for multi&shy;variate distributions. The approach taken evaluates the anomaly for each variable separately, and then combines them into a total anomaly value.</p>
<p>An anomaly detector considers only a small part of the variables, and typically only a single variable with a simple distribution like Poisson or Gauss, can be called a <em>micro&shy;model</em>. A micromodel with gaussian distribution will look like this:</p>
<p><img class="iimagesfigure4_gaussian-detectionpng" src="https://d3ansictanv2wj.cloudfront.net/figure4_gaussian-detection-9e7239a674c2e38f14f445a3bc749286.png" alt="Micromodel with gaussian distribution" /> <span class="label">Figure 4. Micromodel with gaussian distribution. Figure courtesy of Ignacio Mulas Viela and Nicolas Seyvet.</span></p>
<p>An array of micro&shy;models can then be formed, with one micro&shy;model per variable (or small set of variables). Such an array can be called a <em>component</em>. The anomaly values from the individual detectors then have to be combined into one anomaly value for the whole component. The combination depends on the use case. Since accuracy is important (avoid false positives) and parameters can be assumed to be fairly independent from one another, then the principal anomaly for the component can be calculated as the maximum of the micro&shy;model anomalies, but scaled down to meet the correct false alarm rate (i.e., weighted influence of components to improve the accuracy of the principal anomaly detection).</p>
<p>However, there may be many different &ldquo;normal&rdquo; situations. For example, the normal system behavior may vary within weekdays or time of day. Then, it may be necessary to model this with several components, where each component learns the distribution of one cluster. When a new sample arrives, it is tested by each component. If it is considered anomalous by all components, it is considered as anomalous. If any component finds the sample normal, then it is normal.</p>
<div class="block-product   right">
<h4 class="kicker ">Learning Path</h4>
<div class="thumb "><a href="https://www.safaribooksonline.com/library/view/learning-path-architect/9781491958124/?utm_source=oreilly&amp;utm_medium=newsite&amp;utm_campaign=architect-and-build-big-data-applications-right-rail-cta"><img src="https://d3ansictanv2wj.cloudfront.net/tunnel-71ecfb1c6dd5ff733bdb4e928afa5301.jpg" alt="" /></a></div>
<div class="title">
<h2><a href="https://www.safaribooksonline.com/library/view/learning-path-architect/9781491958124/?utm_source=oreilly&amp;utm_medium=newsite&amp;utm_campaign=architect-and-build-big-data-applications-right-rail-cta">Architect and Build Big Data Applications</a></h2>
</div>
<div class="meta">
<p class="dek">Learn the entire process of designing and building data applications.</p>
<a class="more" href="https://www.safaribooksonline.com/library/view/learning-path-architect/9781491958124/?utm_source=oreilly&amp;utm_medium=newsite&amp;utm_campaign=architect-and-build-big-data-applications-right-rail-cta"> Start learning </a></div>
</div>
<p>Applying this to our use case, we used this detector to spot errors or deviations from normal operations in a telco cloud. Each parameter &theta; is any of the captured metrics or logs resulting in many micromodels. By keeping a history of past models, and computing a principal anomaly for the component, we can find statistically relevant novelties. These novelties could come from configuration errors, a new error in the infrastructure, or simply a new state of the overall system (i.e., a new set of virtual machines).</p>
<p>Using the number of generated logs (or log frequency) appears to be the most significant feature to detect novelties. By modeling the statistical function of generated logs over time (or log frequency), the model can spot errors or novelties accurately. For example, let&rsquo;s consider the case where a database becomes unavailable. At that time, any applications depending on it start logging recurring errors, (e.g., &ldquo;Database X is unreachable...&rdquo;). This raises the log frequency, which triggers a novelty in our model and detector.</p>
<p>The overall data pipeline, combining the transformations mentioned before, will look like this:</p>
<p><img class="iimagesfigure5_data-pipeline-bayesian-detectorpng" src="https://d3ansictanv2wj.cloudfront.net/figure5_data-pipeline-bayesian-detector-6f7869a644a16b23269593dcdc13e37f.png" alt="Data pipeline with combination of analytics and Bayesian anomaly detector" /> <span class="label">Figure 5. Data pipeline with combination of analytics and Bayesian anomaly detector. Figure courtesy of Ignacio Mulas Viela and Nicolas Seyvet.</span></p>
<p>This data pipeline receives the raw data, extracts statistical information (such as log frequencies per machine), applies the Bayesian anomaly detector over the interesting features (statistical and raw), and outputs novelties whenever they are found.</p>
<h2>Conclusion</h2>
<p>In this blog post, we have presented an approach using the Kappa architecture and a self-training (online) Bayesian model to yield quick, accurate analytics.</p>
<p>The Kappa architecture allows us to develop a new generation of analytics systems. Remember, this architecture has four main principles: data is immutable, everything is a steam, a single stream engine is used, and data can be replayed. It simplifies both the software systems and the development and maintenance of machine learning models. Those principles can easily be applied to most use cases.</p>
<p>The Bayesian model quickly detects novelties in our cloud. This type of online learning has the advantage of adapting over time to new situations, but one of its main challenges is a lack of ready&shy;-to-&shy;use algorithms. However, the analytics landscape is evolving fast and we are confident that a richer environment can be expected in the near future.</p>
<p><em>Ignacio Mulas Viela and Nicolas Seyvet will speak in greater detail on this topic as well as on a telco data set from a running cloud during their session </em><a href="http://conferences.oreilly.com/strata/hadoop-big-data-eu/public/schedule/detail/49506"><em>Kappa architecture in the telecom industry</em></a><em> at </em><a href="http://conferences.oreilly.com/strata/hadoop-big-data-eu"><em>Strata + Hadoop World London 2016</em></a><em>, May 31 to June 3, 2016.</em></p>
<p>考场并不知道动态dp这东西。</p>
<p>考虑$f[i][0]$表示$i$这个位置必须不选</p>
<p>　　$f[i][1]$表示$i$这个位置必须选</p>
<p>显然可以每次$O(n)$来重新dp一次。</p>
<p>但是我们发现，每次的要求只修改两个位置到LCA的$f$值和$LCA$到根的$f$值。</p>
<p>考虑每次用矩阵转移，将矩阵弄在边上，将矩阵重载为$min和+$</p>
<p>然后修改一个点就是一个点到根的路径上的矩阵合并起来，用倍增维护。</p>
<p>然后同时到LCA的时候不好处理，讨论一下就行了。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">  1</span> #include &lt;bits/stdc++.h&gt;
<span style="color: #008080;">  2</span> <span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
</span><span style="color: #008080;">  3</span> <span style="color: #0000ff;">#define</span> M 100010
<span style="color: #008080;">  4</span> <span style="color: #0000ff;">#define</span> LL long long
<span style="color: #008080;">  5</span> <span style="color: #0000ff;">#define</span> inf 1000000000000ll
<span style="color: #008080;">  6</span> inline <span style="color: #0000ff;">int</span><span style="color: #000000;"> read() {
</span><span style="color: #008080;">  7</span>     <span style="color: #0000ff;">char</span> ch = getchar(); <span style="color: #0000ff;">int</span> x = <span style="color: #800080;">0</span>, f = <span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;">  8</span>     <span style="color: #0000ff;">while</span>(ch &lt; <span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span> || ch &gt; <span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">) {
</span><span style="color: #008080;">  9</span>         <span style="color: #0000ff;">if</span>(ch == <span style="color: #800000;">'</span><span style="color: #800000;">-</span><span style="color: #800000;">'</span>) f = -<span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 10</span>         ch =<span style="color: #000000;"> getchar();
</span><span style="color: #008080;"> 11</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 12</span>     <span style="color: #0000ff;">while</span>(<span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span> &lt;= ch &amp;&amp; ch &lt;= <span style="color: #800000;">'</span><span style="color: #800000;">9</span><span style="color: #800000;">'</span><span style="color: #000000;">) {
</span><span style="color: #008080;"> 13</span>         x = x * <span style="color: #800080;">10</span> + ch - <span style="color: #800000;">'</span><span style="color: #800000;">0</span><span style="color: #800000;">'</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 14</span>         ch =<span style="color: #000000;"> getchar();
</span><span style="color: #008080;"> 15</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 16</span>     <span style="color: #0000ff;">return</span> x *<span style="color: #000000;"> f;
</span><span style="color: #008080;"> 17</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 18</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> p[M];
</span><span style="color: #008080;"> 19</span> <span style="color: #0000ff;">struct</span><span style="color: #000000;"> Edge{
</span><span style="color: #008080;"> 20</span>     <span style="color: #0000ff;">int</span><span style="color: #000000;"> u, v, Next;
</span><span style="color: #008080;"> 21</span> } G[M * <span style="color: #800080;">2</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 22</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> head[M], tot;
</span><span style="color: #008080;"> 23</span> inline <span style="color: #0000ff;">void</span> add(<span style="color: #0000ff;">int</span> u, <span style="color: #0000ff;">int</span><span style="color: #000000;"> v) {
</span><span style="color: #008080;"> 24</span>     G[++ tot] =<span style="color: #000000;"> (Edge){u, v, head[u]};
</span><span style="color: #008080;"> 25</span>     head[u] =<span style="color: #000000;"> tot;
</span><span style="color: #008080;"> 26</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 27</span> <span style="color: #0000ff;">struct</span><span style="color: #000000;"> Node{
</span><span style="color: #008080;"> 28</span>     LL a[<span style="color: #800080;">2</span>][<span style="color: #800080;">2</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 29</span> <span style="color: #000000;">    Node() {
</span><span style="color: #008080;"> 30</span>         a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span>] = a[<span style="color: #800080;">1</span>][<span style="color: #800080;">0</span>] = a[<span style="color: #800080;">1</span>][<span style="color: #800080;">1</span>] = a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>] =<span style="color: #000000;"> inf;
</span><span style="color: #008080;"> 31</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 32</span>     inline Node <span style="color: #0000ff;">operator</span> * (<span style="color: #0000ff;">const</span> Node&amp; rhs) <span style="color: #0000ff;">const</span><span style="color: #000000;"> {
</span><span style="color: #008080;"> 33</span> <span style="color: #000000;">        Node ret;
</span><span style="color: #008080;"> 34</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt;= <span style="color: #800080;">1</span>; ++<span style="color: #000000;"> i) {
</span><span style="color: #008080;"> 35</span>             <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j = <span style="color: #800080;">0</span>; j &lt;= <span style="color: #800080;">1</span>; ++<span style="color: #000000;"> j) {
</span><span style="color: #008080;"> 36</span>                 <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> k = <span style="color: #800080;">0</span>; k &lt;= <span style="color: #800080;">1</span>; ++<span style="color: #000000;"> k) {
</span><span style="color: #008080;"> 37</span>                     ret.a[i][j] = min(ret.a[i][j], a[i][k] +<span style="color: #000000;"> rhs.a[k][j]);
</span><span style="color: #008080;"> 38</span> <span style="color: #000000;">                }
</span><span style="color: #008080;"> 39</span> <span style="color: #000000;">            }
</span><span style="color: #008080;"> 40</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 41</span>         <span style="color: #0000ff;">return</span><span style="color: #000000;"> ret;
</span><span style="color: #008080;"> 42</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 43</span>     inline <span style="color: #0000ff;">void</span><span style="color: #000000;"> print() {
</span><span style="color: #008080;"> 44</span>         printf(<span style="color: #800000;">"</span><span style="color: #800000;">%lld %lld\n</span><span style="color: #800000;">"</span>, a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>], a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span><span style="color: #000000;">]);
</span><span style="color: #008080;"> 45</span>         printf(<span style="color: #800000;">"</span><span style="color: #800000;">%lld %lld\n</span><span style="color: #800000;">"</span>, a[<span style="color: #800080;">1</span>][<span style="color: #800080;">0</span>], a[<span style="color: #800080;">1</span>][<span style="color: #800080;">1</span><span style="color: #000000;">]);
</span><span style="color: #008080;"> 46</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 47</span> } g[M][<span style="color: #800080;">19</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 48</span> LL f[M][<span style="color: #800080;">2</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 49</span> <span style="color: #0000ff;">int</span> h[M], ft[M][<span style="color: #800080;">19</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 50</span> inline <span style="color: #0000ff;">void</span> dfs(<span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span><span style="color: #000000;"> fa) {
</span><span style="color: #008080;"> 51</span>     h[x] = h[fa] + <span style="color: #800080;">1</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 52</span>     ft[x][<span style="color: #800080;">0</span>] =<span style="color: #000000;"> fa;
</span><span style="color: #008080;"> 53</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= <span style="color: #800080;">18</span>; ++<span style="color: #000000;"> i) {
</span><span style="color: #008080;"> 54</span>         ft[x][i] = ft[ft[x][i - <span style="color: #800080;">1</span>]][i - <span style="color: #800080;">1</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 55</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 56</span>     f[x][<span style="color: #800080;">1</span>] =<span style="color: #000000;"> p[x];
</span><span style="color: #008080;"> 57</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = head[x]; i != -<span style="color: #800080;">1</span>; i =<span style="color: #000000;"> G[i].Next) {
</span><span style="color: #008080;"> 58</span>         <span style="color: #0000ff;">if</span>(G[i].v == fa) <span style="color: #0000ff;">continue</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 59</span> <span style="color: #000000;">        dfs(G[i].v, x);
</span><span style="color: #008080;"> 60</span>         f[x][<span style="color: #800080;">0</span>] += f[G[i].v][<span style="color: #800080;">1</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 61</span>         f[x][<span style="color: #800080;">1</span>] += min(f[G[i].v][<span style="color: #800080;">0</span>], f[G[i].v][<span style="color: #800080;">1</span><span style="color: #000000;">]);
</span><span style="color: #008080;"> 62</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 63</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 64</span> inline <span style="color: #0000ff;">void</span> dfs1(<span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span><span style="color: #000000;"> fa) {
</span><span style="color: #008080;"> 65</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = head[x]; i != -<span style="color: #800080;">1</span>; i =<span style="color: #000000;"> G[i].Next) {
</span><span style="color: #008080;"> 66</span>         <span style="color: #0000ff;">if</span>(G[i].v == fa) <span style="color: #0000ff;">continue</span><span style="color: #000000;">;
</span><span style="color: #008080;"> 67</span> <span style="color: #000000;">        dfs1(G[i].v, x);
</span><span style="color: #008080;"> 68</span>         g[G[i].v][<span style="color: #800080;">0</span>].a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>] =<span style="color: #000000;"> inf;
</span><span style="color: #008080;"> 69</span>         g[G[i].v][<span style="color: #800080;">0</span>].a[<span style="color: #800080;">1</span>][<span style="color: #800080;">0</span>] = f[x][<span style="color: #800080;">0</span>] - f[G[i].v][<span style="color: #800080;">1</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 70</span>         g[G[i].v][<span style="color: #800080;">0</span>].a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span>] = f[x][<span style="color: #800080;">1</span>] - min(f[G[i].v][<span style="color: #800080;">0</span>], f[G[i].v][<span style="color: #800080;">1</span><span style="color: #000000;">]);
</span><span style="color: #008080;"> 71</span>         g[G[i].v][<span style="color: #800080;">0</span>].a[<span style="color: #800080;">1</span>][<span style="color: #800080;">1</span>] = f[x][<span style="color: #800080;">1</span>] - min(f[G[i].v][<span style="color: #800080;">0</span>], f[G[i].v][<span style="color: #800080;">1</span><span style="color: #000000;">]);
</span><span style="color: #008080;"> 72</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 73</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 74</span> inline <span style="color: #0000ff;">int</span> lca(<span style="color: #0000ff;">int</span> x, <span style="color: #0000ff;">int</span><span style="color: #000000;"> y) {
</span><span style="color: #008080;"> 75</span>     <span style="color: #0000ff;">if</span>(h[x] &lt;<span style="color: #000000;"> h[y]) swap(x, y);
</span><span style="color: #008080;"> 76</span>     <span style="color: #0000ff;">int</span> t = h[x] -<span style="color: #000000;"> h[y];
</span><span style="color: #008080;"> 77</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">0</span>; i &lt;= <span style="color: #800080;">18</span>; ++<span style="color: #000000;"> i) {
</span><span style="color: #008080;"> 78</span>         <span style="color: #0000ff;">if</span>((<span style="color: #800080;">1</span> &lt;&lt; i) &amp;<span style="color: #000000;"> t) {
</span><span style="color: #008080;"> 79</span>             x =<span style="color: #000000;"> ft[x][i];
</span><span style="color: #008080;"> 80</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 81</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 82</span>     <span style="color: #0000ff;">if</span>(x == y) <span style="color: #0000ff;">return</span><span style="color: #000000;"> x;
</span><span style="color: #008080;"> 83</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">18</span>; i &gt;= <span style="color: #800080;">0</span>; --<span style="color: #000000;"> i) {
</span><span style="color: #008080;"> 84</span>         <span style="color: #0000ff;">if</span>(ft[x][i] !=<span style="color: #000000;"> ft[y][i]) {
</span><span style="color: #008080;"> 85</span>             x =<span style="color: #000000;"> ft[x][i];
</span><span style="color: #008080;"> 86</span>             y =<span style="color: #000000;"> ft[y][i];
</span><span style="color: #008080;"> 87</span> <span style="color: #000000;">        }
</span><span style="color: #008080;"> 88</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 89</span>     <span style="color: #0000ff;">return</span> ft[x][<span style="color: #800080;">0</span><span style="color: #000000;">];
</span><span style="color: #008080;"> 90</span> <span style="color: #000000;">}
</span><span style="color: #008080;"> 91</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> main() {
</span><span style="color: #008080;"> 92</span>     <span style="color: #0000ff;">int</span> n = read(), m =<span style="color: #000000;"> read();
</span><span style="color: #008080;"> 93</span>     <span style="color: #0000ff;">char</span> s[<span style="color: #800080;">10</span>]; scanf(<span style="color: #800000;">"</span><span style="color: #800000;">%s</span><span style="color: #800000;">"</span><span style="color: #000000;">, s);
</span><span style="color: #008080;"> 94</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= n; ++<span style="color: #000000;"> i) {
</span><span style="color: #008080;"> 95</span>         p[i] =<span style="color: #000000;"> read();
</span><span style="color: #008080;"> 96</span> <span style="color: #000000;">    }
</span><span style="color: #008080;"> 97</span>     memset(head, -<span style="color: #800080;">1</span>, <span style="color: #0000ff;">sizeof</span><span style="color: #000000;">(head));
</span><span style="color: #008080;"> 98</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt; n; ++<span style="color: #000000;"> i) {
</span><span style="color: #008080;"> 99</span>         <span style="color: #0000ff;">int</span> u = read(), v =<span style="color: #000000;"> read();
</span><span style="color: #008080;">100</span> <span style="color: #000000;">        add(u, v), add(v, u);
</span><span style="color: #008080;">101</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">102</span>     dfs(<span style="color: #800080;">1</span>, <span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">103</span>     dfs1(<span style="color: #800080;">1</span>, <span style="color: #800080;">0</span><span style="color: #000000;">);
</span><span style="color: #008080;">104</span>     <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">1</span>; i &lt;= <span style="color: #800080;">18</span>; ++<span style="color: #000000;"> i) {
</span><span style="color: #008080;">105</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> j = <span style="color: #800080;">1</span>; j &lt;= n; ++<span style="color: #000000;"> j) {
</span><span style="color: #008080;">106</span>             <span style="color: #0000ff;">if</span>(ft[j][i] != <span style="color: #800080;">0</span><span style="color: #000000;">) {
</span><span style="color: #008080;">107</span>                 g[j][i] = g[j][i - <span style="color: #800080;">1</span>] * g[ft[j][i - <span style="color: #800080;">1</span>]][i - <span style="color: #800080;">1</span><span style="color: #000000;">];
</span><span style="color: #008080;">108</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">109</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">110</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">111</span>     <span style="color: #0000ff;">while</span>(m --<span style="color: #000000;">) {
</span><span style="color: #008080;">112</span>         <span style="color: #0000ff;">int</span> x = read(), a = read(), y = read(), b =<span style="color: #000000;"> read();
</span><span style="color: #008080;">113</span>         <span style="color: #0000ff;">if</span>(h[x] &lt;<span style="color: #000000;"> h[y]) {
</span><span style="color: #008080;">114</span> <span style="color: #000000;">            swap(x, y), swap(a, b);
</span><span style="color: #008080;">115</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">116</span>         <span style="color: #0000ff;">int</span> LCA =<span style="color: #000000;"> lca(x, y);
</span><span style="color: #008080;">117</span> <span style="color: #000000;">        Node A, B;
</span><span style="color: #008080;">118</span>         A.a[<span style="color: #800080;">0</span>][a] =<span style="color: #000000;"> f[x][a];
</span><span style="color: #008080;">119</span>         B.a[<span style="color: #800080;">0</span>][b] =<span style="color: #000000;"> f[y][b];
</span><span style="color: #008080;">120</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">18</span>; i &gt;= <span style="color: #800080;">0</span>; --<span style="color: #000000;"> i) {
</span><span style="color: #008080;">121</span>             <span style="color: #0000ff;">if</span>(h[ft[x][i]] &gt;<span style="color: #000000;"> h[LCA]) {
</span><span style="color: #008080;">122</span>                 A = A *<span style="color: #000000;"> g[x][i];
</span><span style="color: #008080;">123</span>                 x =<span style="color: #000000;"> ft[x][i];
</span><span style="color: #008080;">124</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">125</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">126</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">18</span>; i &gt;= <span style="color: #800080;">0</span>; --<span style="color: #000000;"> i) {
</span><span style="color: #008080;">127</span>             <span style="color: #0000ff;">if</span>(h[ft[y][i]] &gt;<span style="color: #000000;"> h[LCA]) {
</span><span style="color: #008080;">128</span>                 B = B *<span style="color: #000000;"> g[y][i];
</span><span style="color: #008080;">129</span>                 y =<span style="color: #000000;"> ft[y][i];
</span><span style="color: #008080;">130</span> <span style="color: #000000;">            }
</span><span style="color: #008080;">131</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">132</span>         
<span style="color: #008080;">133</span>         <span style="color: #0000ff;">if</span>(y ==<span style="color: #000000;"> LCA) {
</span><span style="color: #008080;">134</span>             A = A * g[x][<span style="color: #800080;">0</span><span style="color: #000000;">];
</span><span style="color: #008080;">135</span>             A.a[<span style="color: #800080;">0</span>][b ^ <span style="color: #800080;">1</span>] =<span style="color: #000000;"> inf;
</span><span style="color: #008080;">136</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">137</span>         <span style="color: #0000ff;">else</span><span style="color: #000000;"> {
</span><span style="color: #008080;">138</span> <span style="color: #000000;">            Node C;
</span><span style="color: #008080;">139</span>             C.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>] = f[LCA][<span style="color: #800080;">0</span>] - f[x][<span style="color: #800080;">1</span>] - f[y][<span style="color: #800080;">1</span>] + A.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span>] + B.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span><span style="color: #000000;">];
</span><span style="color: #008080;">140</span>             C.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span>] = f[LCA][<span style="color: #800080;">1</span>] - min(f[x][<span style="color: #800080;">0</span>], f[x][<span style="color: #800080;">1</span>]) - min(f[y][<span style="color: #800080;">0</span>], f[y][<span style="color: #800080;">1</span><span style="color: #000000;">]);
</span><span style="color: #008080;">141</span>             C.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span>] += min(A.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>], A.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span>]) + min(B.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>], B.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span><span style="color: #000000;">]);
</span><span style="color: #008080;">142</span>             A =<span style="color: #000000;"> C;
</span><span style="color: #008080;">143</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">144</span>         x = ft[x][<span style="color: #800080;">0</span><span style="color: #000000;">];
</span><span style="color: #008080;">145</span>         <span style="color: #0000ff;">for</span>(<span style="color: #0000ff;">int</span> i = <span style="color: #800080;">18</span>; i &gt;= <span style="color: #800080;">0</span>; --<span style="color: #000000;"> i) {
</span><span style="color: #008080;">146</span>             <span style="color: #0000ff;">if</span>(h[ft[x][i]] &gt;= <span style="color: #800080;">1</span><span style="color: #000000;">) {
</span><span style="color: #008080;">147</span>                 A = A *<span style="color: #000000;"> g[x][i];
</span><span style="color: #008080;">148</span>                 x =<span style="color: #000000;"> ft[x][i];
</span><span style="color: #008080;">149</span> <span style="color: #000000;">            } 
</span><span style="color: #008080;">150</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">151</span>         <span style="color: #0000ff;">if</span>(A.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>] == inf &amp;&amp; A.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span>] ==<span style="color: #000000;"> inf) {
</span><span style="color: #008080;">152</span>             puts(<span style="color: #800000;">"</span><span style="color: #800000;">-1</span><span style="color: #800000;">"</span><span style="color: #000000;">);
</span><span style="color: #008080;">153</span> <span style="color: #000000;">        }
</span><span style="color: #008080;">154</span>         <span style="color: #0000ff;">else</span> printf(<span style="color: #800000;">"</span><span style="color: #800000;">%lld\n</span><span style="color: #800000;">"</span>, min(A.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">0</span>], A.a[<span style="color: #800080;">0</span>][<span style="color: #800080;">1</span><span style="color: #000000;">]));
</span><span style="color: #008080;">155</span> <span style="color: #000000;">    }
</span><span style="color: #008080;">156</span> }</pre>
</div>
<p>&nbsp;</p>
<p>linux的ip命令和ifconfig类似，但前者功能更强大，并旨在取代后者。使用ip命令，只需一个命令，你就能很轻松地执行一些网络管理任务。ifconfig是net-tools中已被废弃使用的一个命令，许多年前就已经没有维护了。iproute2套件里提供了许多增强功能的命令，ip命令即是其中之一。</p>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003404uy9l1t5zayzllylm.png" alt="Net tools vs Iproute2" width="700" /></p>
<p class="article_img_desc">Net tools vs Iproute2</p>
<p>要安装ip，请<a class="ext" href="http://www.linuxgrill.com/anonymous/iproute2/NEW-OSDL/" target="_blank">点击这里</a>下载iproute2套装工具&nbsp;。不过，大多数Linux发行版已经预装了iproute2工具。</p>
<p>你也可以使用git命令来下载最新源代码来编译：</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">git<span class="pln">&nbsp;<span class="kwd">clone<span class="pln">&nbsp;https<span class="pun">:<span class="com">//kernel.googlesource.com/pub/scm/linux/kernel/git/shemminger/iproute2.git</span></span></span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003410tpix2804k660lwu4.png" alt="iproute2 git clone" /></p>
<p class="article_img_desc">iproute2 git clone</p>
<h3><a name="t0"></a>设置和删除Ip地址</h3>
<p>要给你的机器设置一个IP地址，可以使用下列ip命令：</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">sudo<span class="pln">&nbsp;<span class="kwd">ip<span class="pln">&nbsp;addr add&nbsp;<span class="lit">192.168<span class="pun">.<span class="lit">0.193<span class="pun">/<span class="lit">24<span class="pln">&nbsp;dev wlan0</span></span></span></span></span></span></span></span></span></span></span></li>
</ol>
<p>请注意IP地址要有一个后缀，比如/24。这种用法用于在无类域内路由选择（CIDR）中来显示所用的子网掩码。在这个例子中，子网掩码是255.255.255.0。</p>
<p>在你按照上述方式设置好IP地址后，需要查看是否已经生效。</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">ip<span class="pln">&nbsp;addr show wlan0</span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003411qp4xsem5491ee49t.png" alt="set ip address" /></p>
<p class="article_img_desc">set ip address</p>
<p>你也可以使用相同的方式来删除IP地址，只需用del代替add。</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">sudo<span class="pln">&nbsp;<span class="kwd">ip<span class="pln">&nbsp;addr&nbsp;<span class="kwd">del<span class="pln">&nbsp;<span class="lit">192.168<span class="pun">.<span class="lit">0.193<span class="pun">/<span class="lit">24<span class="pln">&nbsp;dev wlan0</span></span></span></span></span></span></span></span></span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003412dottfn0jnidyykd2.png" alt="delete ip address" /></p>
<p class="article_img_desc">delete ip address</p>
<h3><a name="t1"></a>列出路由表条目</h3>
<p>ip命令的路由对象的参数还可以帮助你查看网络中的路由数据，并设置你的路由表。第一个条目是默认的路由条目，你可以随意改动它。</p>
<p>在这个例子中，有几个路由条目。这个结果显示有几个设备通过不同的网络接口连接起来。它们包括WIFI、以太网和一个点对点连接。</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">ip<span class="pln">&nbsp;<span class="kwd">route<span class="pln">&nbsp;show</span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003413mnehm4uinhziu287.png" alt="ip route show" /></p>
<p class="article_img_desc">ip route show</p>
<p>假设现在你有一个IP地址，你需要知道路由包从哪里来。可以使用下面的路由选项（译注：列出了路由所使用的接口等）：</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">ip<span class="pln">&nbsp;<span class="kwd">route<span class="pln">&nbsp;<span class="kwd">get<span class="pln">&nbsp;<span class="lit">10.42<span class="pun">.<span class="lit">0.47</span></span></span></span></span></span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003414h53e34qwjfo34emm.png" alt="ip route get" /></p>
<p class="article_img_desc">ip route get</p>
<h3><a name="t2"></a>更改默认路由</h3>
<p>要更改默认路由，使用下面ip命令：</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">sudo<span class="pln">&nbsp;<span class="kwd">ip<span class="pln">&nbsp;<span class="kwd">route<span class="pln">&nbsp;add&nbsp;<span class="kwd">default<span class="pln">&nbsp;via&nbsp;<span class="lit">192.168<span class="pun">.<span class="lit">0.196</span></span></span></span></span></span></span></span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003415i8d82ulsa4c4jcd4.png" alt="default route" /></p>
<p class="article_img_desc">default route</p>
<h3><a name="t3"></a>显示网络统计数据</h3>
<p>使用ip命令还可以显示不同网络接口的统计数据。</p>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003417l1jc4h5537m050wy.png" alt="ip statistics all interfaces" /></p>
<p class="article_img_desc">ip statistics all interfaces</p>
<p>当你需要获取一个特定网络接口的信息时，在网络接口名字后面添加选项ls即可。使用多个选项-s会给你这个特定接口更详细的信息。特别是在排除网络连接故障时，这会非常有用。</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">ip<span class="pln">&nbsp;<span class="pun">-<span class="pln">s&nbsp;<span class="pun">-<span class="pln">s&nbsp;<span class="kwd">link<span class="pln">&nbsp;<span class="kwd">ls<span class="pln">&nbsp;p2p1</span></span></span></span></span></span></span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003418acoo0krhjellollu.png" alt="ip link statistics" /></p>
<p class="article_img_desc">ip link statistics</p>
<h3><a name="t4"></a>ARP条目</h3>
<p>地址解析协议（ARP）用于将一个IP地址转换成它对应的物理地址，也就是通常所说的MAC地址。使用ip命令的neigh或者neighbour选项，你可以查看接入你所在的局域网的设备的MAC地址。</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">ip<span class="pln">&nbsp;neighbour</span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003419uzm96tbvujb5bvqe.png" alt="ip neighbour" /></p>
<p class="article_img_desc">ip neighbour</p>
<h3><a name="t5"></a>监控netlink消息</h3>
<p>也可以使用ip命令查看netlink消息。monitor选项允许你查看网络设备的状态。比如，所在局域网的一台电脑根据它的状态可以被分类成REACHABLE或者STALE。使用下面的命令：</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">ip<span class="pln">&nbsp;monitor all</span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003420ap2j3jjvjk3jvvoo.png" alt="ip monitor all" /></p>
<p class="article_img_desc">ip monitor all</p>
<h3><a name="t6"></a>激活和停止网络接口</h3>
<p>你可以使用ip命令的up和down选项来激某个特定的接口，就像ifconfig的用法一样。</p>
<p>在这个例子中，当ppp0接口被激活和在它被停止和再次激活之后，你可以看到相应的路由表条目。这个接口可能是wlan0或者eth0。将ppp0更改为你可用的任意接口即可。</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">sudo<span class="pln">&nbsp;<span class="kwd">ip<span class="pln">&nbsp;<span class="kwd">link<span class="pln">&nbsp;<span class="kwd">set<span class="pln">&nbsp;ppp0 down</span></span></span></span></span></span></span></span></span></li>
<li class="L1"><span class="pln">&nbsp;</span></li>
<li class="L2"><span class="pln">$&nbsp;<span class="kwd">sudo<span class="pln">&nbsp;<span class="kwd">ip<span class="pln">&nbsp;<span class="kwd">link<span class="pln">&nbsp;<span class="kwd">set<span class="pln">&nbsp;ppp0 up</span></span></span></span></span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003421mdudvkazcgkl6g8d.png" alt="ip link set up and down" /></p>
<p class="article_img_desc">ip link set up and down</p>
<h3><a name="t7"></a>获取帮助</h3>
<p>当你陷入困境，不知道某一个特定的选项怎么用的时候，你可以使用help选项。man页面并不会提供许多关于如何使用ip选项的信息，因此这里就是获取帮助的地方。</p>
<p>比如，想知道关于route选项更多的信息：</p>
<pre name="code" class="prettyprint linenums prettyprinted"></pre>
<ol class="linenums">
<li class="L0"><span class="pln">$&nbsp;<span class="kwd">ip<span class="pln">&nbsp;<span class="kwd">route<span class="pln">&nbsp;help</span></span></span></span></span></li>
</ol>
<p class="article_img"><img src="https://dn-linuxcn.qbox.me/data/attachment/album/201406/04/003422xh9xm2wihecdjhif.png" alt="ip route help" /></p>
<p class="article_img_desc">ip route help</p>
<h3><a name="t8"></a>小结</h3>
<p class="p1">对于网络管理员们和所有的Linux使用者们，ip命令是必备工具。是时候抛弃ifconfig命令了，特别是当你写脚本时。</p>
> 提起白盒测试,很多程序员可能觉得就是个书上的概念,很多人写完代码根本没有具体的测试方案,自己觉得可行就提交了,其实这是个很危险的事情,毕竟出了bug,最后要加班的人还是你 ,因此做好白盒测试,100%的覆盖是很重要的.
> 事实上,VS中已经集成了单元测试框架.可是,要达到更广泛的测试目的,需要借助下外援了.
> 本文希望通过介绍由Google出品的Gmock和Gtest框架,帮助程序员完成单元测试.也是自己的学习记录

网上给的地址都在墙外,这里给个可以用的下载地址,[1.7.0点这里](http://www.xdowns.com/app/260698.html)
另外 附上1.8.0的[Github](https://github.com/abseil/googletest/tree/release-1.8.0),不得不说,自从有了github,码农的日子好了不少,特别是中国的码农.

整个框架并不大,只有几个文件.是的,如果测试框架都那么大,让真实的待测代码情何以堪.

+ 编译lib文件
下载完成后,使用VS2008编译,在debug模式下编译的文件 ,主要使用的是gtest.lib和gmock.lib 

>这两个文件不是一起生成的,一个在Gmock的msvc下,另一个在gtest的msvc下,分别编译生成.

### gtest
+ demo1构建

在VS2008中新建控制台程序,将gmock的include文件夹和gtest的include文件夹拷贝出来,放在一起,留在头文件库中使用.将生成的lib文件放入lib文件夹使用,这里可以自行放置.配置VS时定位到具体的位置即可;
需要特别主要的是,一定要将运行库设置为 多线程调试(MTd),因为文主是使用默认工程编译的gmock和gtest,其运行库就是MTd方式编译的.
然后在main函数的文件中 添加为如下代码:

```C++
#include <gtest/gtest.h>
int _tmain(int argc, _TCHAR* argv[])
{
	testing::InitGoogleTest(&argc, argv);
	return RUN_ALL_TESTS();
	return 0;
}
```
接下来,我们来试试水
新建一个cpp文件
测试代码 

```C++
int funcForTest1(int i)
{
	return i;
}

TEST(FooTestCase1, Demo1Failed)
{
	EXPECT_EQ(4, funcForTest1(6));
}

TEST(FooTestCase2, Demo1Success)
{
	EXPECT_EQ(6, funcForTest1(6));
}
```

这里故意做了一些区分,TEST宏的参数 含义为 [TestCaseName，TestName],EXPECT_EQ则标识相等的预期,以下是运行结果

```C++
[==========] Running 2 tests from 2 test cases.
[----------] Global test environment set-up.
[----------] 1 test from FooTestCase1
[ RUN      ] FooTestCase1.Demo1Failed
e:\godertime\practicezone\unittestgogogo\demo1\demo1\dd1.cpp(11): error: Value of: funcForTest1(6)
  Actual: 6
Expected: 4
[  FAILED  ] FooTestCase1.Demo1Failed (2 ms)
[----------] 1 test from FooTestCase1 (5 ms total)

[----------] 1 test from FooTestCase2
[ RUN      ] FooTestCase2.Demo1Success
[       OK ] FooTestCase2.Demo1Success (0 ms)
[----------] 1 test from FooTestCase2 (2 ms total)

[----------] Global test environment tear-down
[==========] 2 tests from 2 test cases ran. (19 ms total)
[  PASSED  ] 1 test.
[  FAILED  ] 1 test, listed below:
[  FAILED  ] FooTestCase1.Demo1Failed

 1 FAILED TEST

```
> 成功和失败是有颜色区分的.

测试结果表明,我们有一个测试失败了.而且标出了测试失败的位置.


+ 宏断言

一类是ASSERT系列，一类是EXPECT系列。一个直观的解释就是：
1. ASSERT_* 系列的断言，当检查点失败时，退出当前函数（注意：并非退出当前案例）。 
	常用: ASSERT_TRUE、 ASSERT_EQ、 ASSERT_STREQ
2. EXPECT_* 系列的断言，当检查点失败时，继续往下执行。
	常用: EXPECT_FALSE、 EXPECT_NE、 EXPECT_STRNE

更多[直接参考这里](http://www.cnblogs.com/coderzh/archive/2009/04/06/1430364.html)

[这篇博文很全面介绍了gtest](http://www.cnblogs.com/coderzh/archive/2009/04/06/1426755.html)

### gmock

测试一个模块的时候，可能涉及到和其他模块交互，可以将模块之间的接口mock起来，模拟交互过程。其作用就类似白盒测试中的打桩的概念。

gmock与gtest相辅相成,gtest测试真实的代码,而gmock则模拟真实的代码.在gtest测试时加入gmock代码也是受到google推荐的.
参考代码

```C++
class Cdd2
{
public:
	Cdd2() {}
	virtual ~Cdd2() {}
	virtual std::string getAttrString() = 0;
	virtual int getPosition(int parm) = 0;

};

class MockCdd2:public Cdd2
{
public:
	//0和1代表了参数的个数
	MOCK_METHOD0(getAttrString,std::string());
	MOCK_METHOD1(getPosition,int(int));

};


TEST(MockTestCase, Demo1)
{
	int n = 100;
    std::string value = "Hello World!";
    MockCdd2 mockFoo;

    //期待运行1次,且返回值为value的字符串
    EXPECT_CALL(mockFoo, getAttrString())
        .Times(1)
        .WillOnce(testing::Return(value));
    std::string returnValue = mockFoo.getAttrString();
    std::cout << "Returned Value: " << returnValue << std::endl;

    //期待运行两次,返回值分别为335 和 455
    EXPECT_CALL(mockFoo, getPosition(testing::_))
        .Times(2)
        .WillOnce(testing::Return(335))
        .WillOnce(testing::Return(455));

    int val = mockFoo.getPosition(0);  //355
    int val2 = mockFoo.getPosition(1);  //455
    std::cout << "Returned Value: " << val <<" "<< val2 << std::endl;
}
```
运行结果:

```C++
[==========] Running 1 test from 1 test case.
[----------] Global test environment set-up.
[----------] 1 test from MockTestCase
[ RUN      ] MockTestCase.Demo1
Returned Value: Hello World!
Returned Value: 335 455
[       OK ] MockTestCase.Demo1 (17 ms)
[----------] 1 test from MockTestCase (19 ms total)

[----------] Global test environment tear-down
[==========] 1 test from 1 test case ran. (28 ms total)
[  PASSED  ] 1 test.
```
说明:虽然MockCdd2 继承于 Cdd2,但是其实并没有执行Cdd2的相关函数,而是MockCdd2的期望返回值,我们通过手动设置返回值的方式,达到了测试打桩的目的.

[该文章中有项目中较为成熟的mock用法](https://www.cnblogs.com/bourneli/articles/2327734.html)

### 更多参考 

- [参考](https://www.cnblogs.com/peisy/p/4462506.html)
- [GitHub-gtest](https://github.com/abseil/googletest/blob/release-1.8.0/googletest/docs/Primer.md)
- [Github-googlemock](https://github.com/abseil/googletest/blob/release-1.8.0/googlemock/README.md)
- [ForDummies](https://github.com/abseil/googletest/blob/release-1.8.0/googlemock/docs/ForDummies.md)
<p>1.LeaveDAL</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;</p>
<p>namespace VacationOA.DAL<br />{<br />    using MODEL;<br />    using System.Data.Entity;<br />    public class LeaveDAL<br />    {<br />        VacationdbContext dbcontext = new VacationdbContext();<br />        /// &lt;summary&gt;<br />        /// 添加请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int AddLeave(Leave l)<br />        {<br />            dbcontext.Leaves.Add(l);<br />            int i = dbcontext.SaveChanges();<br />            if (i &gt; 0)<br />            {<br />                Leave leave = dbcontext.Leaves.Where(n =&gt; n.applyTime.Equals(l.applyTime) &amp;&amp; n.staffID.Equals(l.staffID)).FirstOrDefault();<br />                return leave.leaveID;<br />            }<br />            else<br />            {<br />                return 0;<br />            }</p>
<p>        }<br />        /// &lt;summary&gt;<br />        /// 修改请假单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int updateleave(Leave l)<br />        {<br />            dbcontext.Entry(l).State = System.Data.Entity.EntityState.Modified;<br />            return dbcontext.SaveChanges();<br />        }<br />        /// &lt;summary&gt;<br />        /// 获取请假单 我的请假列表<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public List&lt;Leave&gt; GetLeaves()<br />        {<br />            var list1 = from l in dbcontext.Leaves.ToList()<br />                        join s in dbcontext.Staffs.ToList()<br />                        on l.staffID equals s.staffID<br />                        orderby l.CheckTime descending,<br />                        l.applyTime descending<br />                        select new Leave<br />                        {<br />                            leaveID =l.leaveID,<br />                            state = l.state,<br />                            Department = s.Department,<br />                            staffID = s.staffID,<br />                            staffName = s.staffName,<br />                            applyTime = l.applyTime,<br />                            startTime = l.startTime,<br />                            endTime = l.endTime,<br />                            sumTime= l.sumTime,<br />                            CheckTime = l.CheckTime,<br />                            reason=l.reason,<br />                            remark=l.remark,<br />                            explain=l.explain<br />                        };</p>
<p><br />            return list1.ToList();<br />        }<br />        /// &lt;summary&gt;<br />        /// 获取请假单 我的审核列表<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public List&lt;Leave&gt; GetLeavesCheck()<br />        {<br />            var list1 = from l in dbcontext.Leaves.ToList()<br />                        join s in dbcontext.Staffs.ToList()<br />                        on l.staffID equals s.staffID<br />                        orderby  l.applyTime ascending<br />                        select new Leave<br />                        {<br />                            leaveID = l.leaveID,<br />                            state = l.state,<br />                            Department = s.Department,<br />                            staffID = s.staffID,<br />                            staffName = s.staffName,<br />                            applyTime = l.applyTime,<br />                            startTime = l.startTime,<br />                            endTime = l.endTime,<br />                            sumTime = l.sumTime,<br />                            CheckTime = l.CheckTime,<br />                            reason = l.reason,<br />                            remark = l.remark,<br />                            explain = l.explain<br />                        };<br />            List&lt;Leave&gt; list2 = list1.Where(n=&gt;n.state.Equals("待审核")).ToList();</p>
<p>            return list2;<br />        }<br />        /// &lt;summary&gt;<br />        /// 修改请假单的状态，审核时间，说明，<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="l"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int updateleaveState(int id,DateTime checktime,string explain,string state)<br />        {<br />            Leave l= dbcontext.Leaves.ToList().Where(n =&gt; n.leaveID.Equals(id)).FirstOrDefault();<br />            l.CheckTime = checktime;<br />            l.state = state;<br />            l.explain = explain;<br />            return updateleave(l);<br />        }</p>
<p><br />    }<br />}</p>
<p>2.StaffDAL</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;</p>
<p>namespace VacationOA.DAL<br />{<br />    using VacationOA.MODEL;<br />    public class StaffDAL<br />    {<br />        VacationdbContext dbcontext = new VacationdbContext();<br />        public Staff LoginStaff(string name, string department)<br />        {<br />            List&lt;Staff&gt; list1 = dbcontext.Staffs.ToList();<br />            list1 = list1.Where(n =&gt; n.staffName==name &amp;&amp; n.Department==department).ToList();<br />            return list1.FirstOrDefault();</p>
<p><br />        }<br />    }<br />}</p>
<p>3.TCheckDAL</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;</p>
<p>namespace VacationOA.DAL<br />{<br />    using MODEL;<br />  public  class TCheckDAL<br />    {<br />        VacationdbContext dbcontext = new VacationdbContext();</p>
<p>        /// &lt;summary&gt;<br />        /// 添加审核清单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="tcheck"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int AddTcheck(TCheck tcheck)<br />        {<br />            dbcontext.checks.Add(tcheck);<br />            return dbcontext.SaveChanges();<br />        }<br />        /// &lt;summary&gt;<br />        /// 根据假条id查询是否有关于这个假条审核通过的审核单<br />        /// &lt;/summary&gt;<br />        /// &lt;param name="id"&gt;&lt;/param&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public int GetCheckbyid(int id)<br />        {<br />          return  dbcontext.checks.Where(n =&gt; n.leaveID == id).Where(n =&gt; n.checkState.Equals("已通过")).ToList().Count ;<br />        }<br />        /// &lt;summary&gt;<br />        /// 根据id获取对应请假单的审核历史<br />        /// &lt;/summary&gt;<br />        /// &lt;returns&gt;&lt;/returns&gt;<br />        public List&lt;TCheck&gt; GetChecks(int id)<br />        {<br />            return dbcontext.checks.Where(n =&gt; n.leaveID.Equals(id)).ToList();<br />        }</p>
<p>    }<br />}</p>
<p>4.VacationdbContext</p>
<p>using System;<br />using System.Collections.Generic;<br />using System.Linq;<br />using System.Text;<br />using System.Threading.Tasks;</p>
<p>namespace VacationOA.DAL<br />{<br />    using MODEL;<br />    using System.Data.Entity;<br />  public  class VacationdbContext:DbContext<br />    {<br />        public VacationdbContext():base("name=VacationdbContext")<br />        {</p>
<p>        }<br />        public DbSet&lt;TCheck&gt; checks { get; set; }<br />        public DbSet&lt;Leave&gt; Leaves { get; set; }<br />        public DbSet&lt;Staff&gt; Staffs { get; set; }<br />    }<br />}</p>
<h3><strong>3<span style="font-family: 宋体;">、示例</span></strong></h3>
<h4><strong>练习（一）</strong></h4>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="338">
<p>CREATE TABLE t_stu(</p>
<p>sid INT PRIMARY KEY AUTO_INCREMENT,</p>
<p>sname VARCHAR(100) NOT NULL,</p>
<p>gender CHAR NOT NULL DEFAULT '<span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">',</span></p>
<p>card_id CHAR(18) NOT NULL UNIQUE,</p>
<p>birthday DATE,</p>
<p>address VARCHAR(200)</p>
<p>);</p>
</td>
<td valign="top" width="373">
<p><a href="http://photo.blog.sina.com.cn/showpic.html#blogid=c30a9e680102yiud&amp;url=http://album.sina.com.cn/pic/003zs2uIzy7pozYK6irff" target="_blank"><img title="尚硅谷之MySQL基础第9章DML3、示例" src="http://s16.sinaimg.cn/mw690/003zs2uIzy7pozYK6irff&amp;690" alt="尚硅谷之MySQL基础第9章DML3、示例" width="198" height="171" /></a><br /><br /></p>

</td>

</tr>
<tr>
<td colspan="2" valign="top" width="712">
<p>INSERT INTO t_stu VALUES(1,'<span style="font-family: 宋体;">张三</span><span style="font-family: Calibri;">',DEFAULT,'123456789012345678','1989-09-09',</span>NULL);</p>
<p>INSERT INTO t_stu VALUES(2,'<span style="font-family: 宋体;">李四</span><span style="font-family: Calibri;">',</span>'<span style="font-family: 宋体;">女</span><span style="font-family: Calibri;">'</span>,'123456789012345677','1988-09-09','<span style="font-family: 宋体;">尚硅谷</span><span style="font-family: Calibri;">'</span>);</p>
<p>INSERT INTO t_stu VALUES(0,'<span style="font-family: 宋体;">王五</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">','123456789012345676','1987-09-09','</span><span style="font-family: 宋体;">尚硅谷</span><span style="font-family: Calibri;">');</span></p>
<p>INSERT INTO t_stu VALUES(NULL,'<span style="font-family: 宋体;">赵六</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">','123456789012345675','1987-09-09','</span><span style="font-family: 宋体;">尚硅谷</span><span style="font-family: Calibri;">');</span></p>

</td>

</tr>
<tr>
<td colspan="2" valign="top" width="712">
<p>INSERT INTO t_stu VALUES</p>
<p>(NULL,'<span style="font-family: 宋体;">冰冰</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">女</span><span style="font-family: Calibri;">','123456789012345674','1988-09-09','</span><span style="font-family: 宋体;">尚硅谷</span><span style="font-family: Calibri;">'),</span></p>
<p>(NULL,'<span style="font-family: 宋体;">小丽</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">女</span><span style="font-family: Calibri;">','123456789012345673','1988-09-09','</span><span style="font-family: 宋体;">尚硅谷</span><span style="font-family: Calibri;">');</span></p>

</td>

</tr>
<tr>
<td colspan="2" valign="top" width="712">
<p>INSERT INTO t_stu (sname,card_id,birthday)</p>
<p>VALUES('<span style="font-family: 宋体;">小薇</span><span style="font-family: Calibri;">','123456199012045672',</span>STR_TO_DATE(SUBSTRING(card_id,7,8),'%Y%m%d'));</p>

</td>

</tr>
<tr>
<td colspan="2" valign="top" width="712">
<p>INSERT INTO t_stu (sname,card_id,birthday)VALUES</p>
<p>('<span style="font-family: 宋体;">小红</span><span style="font-family: Calibri;">','123456789012345671','1990-09-09'),</span></p>
<p>('<span style="font-family: 宋体;">小紫</span><span style="font-family: Calibri;">','123456789012345670','1990-09-09');</span></p>

</td>

</tr>

</tbody>

</table>
<h4><strong>练习（二）</strong></h4>
<table border="1" cellspacing="0">
<tbody>
<tr>
<td valign="top" width="321">
<p>CREATE TABLE t_department(</p>
<p>did INT PRIMARY KEY AUTO_INCREMENT,</p>
<p>dname VARCHAR(100) NOT NULL,</p>
<p>description VARCHAR(200),</p>
<p>manager_id INT</p>
<p>);</p>
<p>&nbsp;</p>
<p>INSERT INTO t_department(dname,description)</p>
<p>VALUES('<span style="font-family: 宋体;">教学部</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">技术培训</span><span style="font-family: Calibri;">'),</span></p>
<p>('<span style="font-family: 宋体;">咨询部</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">课程咨询服务</span><span style="font-family: Calibri;">');</span></p>

</td>
<td rowspan="4" valign="top" width="390">
<p><a href="http://photo.blog.sina.com.cn/showpic.html#blogid=c30a9e680102yiud&amp;url=http://album.sina.com.cn/pic/003zs2uIzy7poA0Y6OD7b" target="_blank"><img title="尚硅谷之MySQL基础第9章DML3、示例" src="http://s12.sinaimg.cn/mw690/003zs2uIzy7poA0Y6OD7b&amp;690" alt="尚硅谷之MySQL基础第9章DML3、示例" name="image_operate_61551542870882126" width="614" height="402" /></a><br /><br /></p>

</td>

</tr>
<tr>
<td valign="top" width="321">
<p>CREATE TABLE `t_job` (</p>
<p>&nbsp;&nbsp;`job_id` INT(11) PRIMARY KEY AUTO_INCREMENT,</p>
<p>&nbsp;&nbsp;`job_name` VARCHAR(100) DEFAULT NULL,</p>
<p>&nbsp;&nbsp;`description` VARCHAR(200) DEFAULT NULL</p>
<p>);</p>
<p>&nbsp;</p>
<p>INSERT INTO t_job VALUES</p>
<p>(NULL,'JavaSE<span style="font-family: 宋体;">讲师</span><span style="font-family: Calibri;">','Java</span><span style="font-family: 宋体;">基础</span><span style="font-family: Calibri;">'),</span></p>
<p>(NULL,'Web<span style="font-family: 宋体;">讲师</span><span style="font-family: Calibri;">','Web</span><span style="font-family: 宋体;">基础</span><span style="font-family: Calibri;">'),</span></p>
<p>(NULL,'JavaEE<span style="font-family: 宋体;">框架</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">框架讲解</span><span style="font-family: Calibri;">'),</span></p>
<p>(NULL,'<span style="font-family: 宋体;">课程顾问</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">课程咨询</span><span style="font-family: Calibri;">');</span></p>

</td>

</tr>
<tr>
<td valign="top" width="321">
<p>CREATE TABLE t_employee(</p>
<p>eid INT PRIMARY KEY AUTO_INCREMENT,</p>
<p>ename VARCHAR(100) NOT NULL,</p>
<p>gender CHAR NOT NULL DEFAULT '<span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">',</span></p>
<p>card_id CHAR(18) UNIQUE,</p>
<p>tel CHAR(11),</p>
<p>job_id INT,</p>
<p>`mid` INT,</p>
<p>birthday DATE,</p>
<p>hiredate DATE,</p>
<p>address VARCHAR(100),</p>
<p>dept_id INT,</p>
<p>FOREIGN KEY (dept_id) REFERENCES t_department(did),</p>
<p>FOREIGN KEY (job_id) REFERENCES t_job(job_id)</p>
<p>);</p>
<p>INSERT &nbsp;INTO `t_employee`(`eid`,`ename`,`gender`,`card_id`,`tel`,`job_id`,`mid`,`birthday`,`hiredate`,`address`,`dept_id`)</p>
<p>&nbsp;VALUES (1,'<span style="font-family: 宋体;">孙红雷</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">','123456789012345678','12345678901',1,NULL,'1990-01-01','2015-01-01','</span><span style="font-family: 宋体;">白庙</span><span style="font-family: Calibri;">',1),</span></p>
<p>&nbsp;(2,'<span style="font-family: 宋体;">张亮</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">','123456789012345677','12345678902',2,NULL,'1990-01-02','2015-01-02','</span><span style="font-family: 宋体;">天通苑北</span><span style="font-family: Calibri;">',1),</span></p>
<p>&nbsp;(3,'<span style="font-family: 宋体;">鹿晗</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">','123456789012345676','12345678903',3,NULL,'1990-01-03','2015-01-03','</span><span style="font-family: 宋体;">北苑</span><span style="font-family: Calibri;">',1),</span></p>
<p>&nbsp;(4,'<span style="font-family: 宋体;">邓超</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">男</span><span style="font-family: Calibri;">','123456789012345675','12345678904',2,NULL,'1990-01-04','2015-01-04','</span><span style="font-family: 宋体;">和谐家园</span><span style="font-family: Calibri;">',1),</span></p>
<p>&nbsp;(5,'<span style="font-family: 宋体;">孙俪</span><span style="font-family: Calibri;">','</span><span style="font-family: 宋体;">女</span><span style="font-family: Calibri;">','123456789012345674','12345678905',3,NULL,'1990-01-05','2015-01-05','</span><span style="font-family: 宋体;">霍营</span><span style="font-family: Calibri;">',1),</span></p>
<p>&nbsp;(6,'Angelababy','<span style="font-family: 宋体;">女</span><span style="font-family: Calibri;">','123456789012345673','12345678906',4,NULL,'1990-01-06','2015-01-06','</span><span style="font-family: 宋体;">回龙观</span><span style="font-family: Calibri;">',2);</span></p>
<p>&nbsp;</p>

</td>

</tr>
<tr>
<td valign="top" width="321">
<p>CREATE TABLE t_salary(</p>
<p>eid INT PRIMARY KEY,</p>
<p>basic_salary DECIMAL(10,2),</p>
<p>performance_salary DECIMAL(10,2),</p>
<p>commission_pct DECIMAL(10,2),</p>
<p>deduct_wages DECIMAL(10,2),</p>
<p>FOREIGN KEY (eid) REFERENCES t_employee(eid)</p>
<p>);</p>
<p>INSERT &nbsp;INTO `t_salary`(`eid`,`basic_salary`,`performance_salary`,`commission_pct`,`deduct_wages`)</p>
<p>VALUES (1,'12000.00','6000.00','0.40','0.00'),</p>
<p>(2,'9000.00','5000.00','0.20',NULL),</p>
<p>(3,'11000.00','8000.00',NULL,NULL),</p>
<p>(4,'13000.00','5000.00',NULL,NULL),</p>
<p>(5,'8000.00','8000.00','0.30',NULL),</p>
<p>(6,'15000.00','6000.00',NULL,NULL);</p>

</td>

</tr>

</tbody>

</table>
<p>&nbsp;<span style="font-family: Calibri;">本教程由尚硅谷教育大数据研究院出品，如需转载请注明来源，欢迎大家关注尚硅谷公众号（atguigu）了解更多。</span></p>
<p>自从继承了hibernate ,全都是些奇葩问题.</p>
<p>努力解决中,先发布,以备忘</p>
<p>　　近日应公司要求，需在windows服务器上架设一个交易中介软件。</p>
<p>　　过程之一：将软件压缩文件传到服务器上。</p>
<p>&nbsp;</p>
<p>　　问题：在&ldquo;运行&rdquo;对话框通过输入'mstsc' 创建远程连接以后，出现本地桌面与服务器之间无法物质粘贴的情况。</p>
<p>　　解决方案：服务器上，打开任务管理器，在进程中关闭&nbsp;rdpclip.exe 进程。再通过&ldquo;运行&rdquo;对话框，输入rdpclip.exe来开启。</p>
<p>&nbsp;</p>
<p>　　原理：rdpclip.exe 是 Windows 2000/2003 Server 资源工具包中提供的 Rdpclip 实用程序，它的功能就是在&ldquo;终端服务&rdquo;客户端（本机）和&ldquo;终端&rdquo;服务器（远程服务器）之间复制和粘贴文件，也包括粘贴文本。这个程序的文件路径是 c:\windows\system32\rdpclip.exe。</p>
<p>&nbsp;</p>
<p>　　发生问题原因：服务器卡死重启资源管理器以后因未知原因此进程丧失功能。</p>
<p>&nbsp;</p>
<p>　　普及：如果想在远程服务器上复制大型文件到本机（双向），通常的做法是用 ftp ，即在远程服务器上假设 ftp 服务，然后在本机用 ftp 软件连到服务器上，上传/下载文件。</p>
<p>参考：&nbsp;<a href="https://blog.csdn.net/qian99/article/details/78046329" target="_blank">https://blog.csdn.net/qian99/article/details/78046329</a></p>
<p><strong>readonly命令</strong>用于定义只读shell变量和shell函数。readonly命令的选项-p可以输出显示系统中所有定义的只读变量。</p>
<h3>选项</h3>
<pre>-f：定义只读函数；
-a：定义只读数组变量；
-p：显示系统中全部只读变量列表。</pre>
<h3>实例</h3>
<p>（1）readonly命令显示系统中所有的已经定义的只读变量，：</p>
<pre>[root@localhost ~]# readonly     #显示只读变量
<span class="wp_keywordlink"><a title="declare命令" href="http://man.linuxde.net/declare" target="_blank"><br /></a></span></pre>
<p>（2）对于只读变量而言，若用户对其值进行修改，则会立即报错。</p>
<pre>[root@localhost ~]# <strong>readonly test='ok'</strong>         #定义只读变量并初始化 <br /><br /></pre>
<p>&nbsp;</p>
<p><strong>declare命令</strong>用于声明和显示已存在的shell变量。当不提供变量名参数时显示所有shell变量。declare命令若不带任何参数选项，则会显示所有shell变量及其值。declare的功能与typeset命令的功能是相同的。</p>
<pre>+/-："-"可用来指定变量的属性，"+"则是取消变量所设的属性；
-f：仅显示函数；
r：将变量设置为只读；
x：指定的变量会成为环境变量，可供shell以外的程序来使用；
i：[设置值]可以是数值，字符串或运算式。</pre>
<h3>实例</h3>
<pre>declare test='man.linuxde.net'    #定义并初始化shell变量</pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><strong>unset命令</strong>用于删除已定义的shell变量（包括环境变量）和shell函数。unset命令不能够删除具有只读属性的shell变量和环境变量。</p>
<pre>-f：仅删除函数；
-v：仅删除变量。</pre>
<h3>实例</h3>
<p>使用unset命令将前面所创建的环境变量mylove及其对应的值进行删除，输入如下命令：</p>
<pre>unset -v mylove         #删除指定的环境变量</pre>
<p>&nbsp;</p>
<p><strong>env命令</strong>用于显示系统中已存在的环境变量，以及在定义的环境中执行指令。该命令只使用"-"作为参数选项时，隐藏了选项"-i"的功能。若没有设置任何选项和参数时，则直接显示当前的环境变量。</p>
<p>如果使用env命令在新环境中执行指令时，会因为没有定义环境变量"PATH"而提示错误信息"such&nbsp;<span class="wp_keywordlink"><a title="file命令" href="http://man.linuxde.net/file" target="_blank">file</a>&nbsp;or directory"。此时，用户可以重新定义一个新的"PATH"或者使用绝对路径。</span></p>
<h3>语法</h3>
<pre>env(选项)(参数)</pre>
<h3>选项</h3>
<p>&nbsp; &nbsp; -i：开始一个新的空的环境；</p>
<pre><em>-u&lt;变量名&gt;：从当前环境中删除指定的变量。<br /><br /><br /><br /><br /></em></pre>
<h3>&nbsp;export命令用于设置或显示环境变量。</h3>
<p>在shell中执行程序时，shell会提供一组环境变量。export可新增，修改或删除环境变量，供后续执行的程序使用。export的效力仅及于该次登陆操作。</p>
<h3>语法</h3>
<pre class="prettyprint prettyprinted"><span class="kwd">export<span class="pln"> <span class="pun">[-<span class="pln">fnp<span class="pun">][变量名称]=[变量设置值]</span></span></span></span></span></pre>
<p><strong>参数说明</strong>：</p>
<ul>
<li>-f 　代表[变量名称]中为函数名称。</li>
<li>-n 　删除指定的变量。变量实际上并未删除，只是不会输出到后续指令的执行环境中。</li>
<li>-p 　列出所有的shell赋予程序的环境变量。</li>
</ul>
<h3>实例</h3>
<pre class="prettyprint prettyprinted"><span class="com">export -p //列出当前的环境变量值</span></pre>
<pre class="prettyprint prettyprinted"><span class="com">export MYENV //定义环境变量</span><br /><br /></pre>
<pre class="prettyprint prettyprinted"><span class="com">export MYENV=7 //定义环境变量并赋值</span></pre>
<pre><em id="__mceDel">&nbsp;</em></pre>
<p>LB+ECS+RDS经典架构图例及注意事项</p>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/5565/201811/5565-20181122151507234-505096901.png" alt="" /></p>
<p><strong><span style="font-size: 18px;">1，父组件传递数据给子组件(子组件通过props接收数据)<br /></span><span style="font-size: 18px;">父组件</span></strong></p>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="hello"</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="app"</span><span style="color: #0000ff;">&gt;</span>
      <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">HeaderDiv </span><span style="color: #ff0000;">:logo</span><span style="color: #0000ff;">="logo"</span><span style="color: #ff0000;"> :navs</span><span style="color: #0000ff;">="navs"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">HeaderDiv</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
import HeaderDiv from </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">@/components/header-nav</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">
export </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;"> {
  data(){
    </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> {
      logo: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">HELLO WORLD</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,
      navs: [
        {li: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">主页</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">},
        {li: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">日志</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">},
        {li: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">说说</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">},
        {li: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">主页</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">},
        {li: </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">相册</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">}
      ]
    }
  },
  components:{
    HeaderDiv
  }
}
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style </span><span style="color: #ff0000;">scoped</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<p>通过v-bind:prop 这种形式来动态传递数据，即：logo="logo",后面跟着传递的数据</p>
<p><strong><span style="font-size: 18px;">子组件</span></strong></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">template </span><span style="color: #ff0000;">lang</span><span style="color: #0000ff;">="html"</span><span style="color: #0000ff;">&gt;</span>
   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">header </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="header"</span><span style="color: #0000ff;">&gt;</span>
     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="logo"</span><span style="color: #0000ff;">&gt;</span><span style="color: #000000;">
       {{logo}}
     </span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>
     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">ul </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="nav"</span><span style="color: #0000ff;">&gt;</span>
       <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">li </span><span style="color: #ff0000;">v-for</span><span style="color: #0000ff;">="nav in navs"</span><span style="color: #0000ff;">&gt;</span>{{nav.li}}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">li</span><span style="color: #0000ff;">&gt;</span>
     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">ul</span><span style="color: #0000ff;">&gt;</span>
   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">header</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
   export </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;">{
     props: {
       navs: {
         type: Array,
         </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;">: []
       },
       logo: {
         type: String,
         </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;">: </span><span style="background-color: #f5f5f5; color: #000000;">''</span><span style="background-color: #f5f5f5; color: #000000;">
       }
     }
   }
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>子组件通过props方法，接收验证数据，如果navs传递过来，就展示接收到的数据，否则显示默认值[]。同理，logo也是一样</p>
<p><span style="font-size: 18px;"><strong>2，子组件传递数据给父组件(通过自定义事件)</strong></span></p>
<p><span style="font-size: 18px;"><strong>子组件</strong></span></p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">template </span><span style="color: #ff0000;">lang</span><span style="color: #0000ff;">="html"</span><span style="color: #0000ff;">&gt;</span>
   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">section</span><span style="color: #0000ff;">&gt;</span>
     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">class</span><span style="color: #0000ff;">="login"</span><span style="color: #0000ff;">&gt;</span>
       <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">label</span><span style="color: #0000ff;">&gt;</span>
         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>用户名: <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">span</span><span style="color: #0000ff;">&gt;</span>
         <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">input </span><span style="color: #ff0000;">v-model</span><span style="color: #0000ff;">="username"</span><span style="color: #ff0000;"> @change</span><span style="color: #0000ff;">="setUser"</span><span style="color: #0000ff;">&gt;</span>
       <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">label</span><span style="color: #0000ff;">&gt;</span>
     <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>
   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">section</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
   export </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;">{
     data(){
       </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> {
         username: </span><span style="background-color: #f5f5f5; color: #000000;">''</span><span style="background-color: #f5f5f5; color: #000000;">
       }
     },
     methods: {
       setUser: </span><span style="background-color: #f5f5f5; color: #0000ff;">function</span><span style="background-color: #f5f5f5; color: #000000;">(){
         </span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.$emit(</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">transferUser</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">,</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.username)
       }
     }
   }
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>父组件通过监听自定义事件，当子组件里的$emit(eventName)触发自定义事件的时候，父组件执行相应的操作</p>
<p>子级$emit 后会触发自己身上的某一个自定的方法，这个方法对应函数在父级的身上</p>
<div class="cnblogs_code">
<pre><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
   <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">div </span><span style="color: #ff0000;">id</span><span style="color: #0000ff;">="app"</span><span style="color: #0000ff;">&gt;</span>
     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">HeaderDiv </span><span style="color: #ff0000;">@transferUser</span><span style="color: #0000ff;">="getUser"</span><span style="color: #0000ff;">&gt;&lt;/</span><span style="color: #800000;">HeaderDiv</span><span style="color: #0000ff;">&gt;</span>
     <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>用户名: {{user}}<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">p</span><span style="color: #0000ff;">&gt;</span>
   <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">div</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
import HeaderDiv from </span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">@/components/header-nav</span><span style="background-color: #f5f5f5; color: #000000;">'</span><span style="background-color: #f5f5f5; color: #000000;">
export </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;"> {
  data(){
    </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> {
      user: </span><span style="background-color: #f5f5f5; color: #000000;">''</span><span style="background-color: #f5f5f5; color: #000000;">
    }
  },
  methods: {
    getUser(msg){
      </span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.user </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> msg
    }
  },
  components:{
    HeaderDiv
  }
}
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">style </span><span style="color: #ff0000;">scoped</span><span style="color: #0000ff;">&gt;</span>

<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">style</span><span style="color: #0000ff;">&gt;</span></pre>
</div>
<p>&nbsp;</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;">  1</span> <span style="color: #000000;">spring:</span>
<span style="color: #008080;">  5</span> <span style="color: #000000;">   datasource:
</span><span style="color: #008080;">  6</span> <span style="color: #000000;">      druid:
</span><span style="color: #008080;">  7</span> <span style="color: #000000;">        name: frame
</span><span style="color: #008080;">  8</span> <span style="color: #000000;">        # 连接数据库的url，不同数据库不一样。例如： 
</span><span style="color: #008080;">  9</span> <span style="color: #000000;">        # mysql : jdbc:mysql://ip:port/database
</span><span style="color: #008080;"> 10</span> <span style="color: #000000;">        # oracle : jdbc:oracle:thin:@ip:port:database
</span><span style="color: #008080;"> 11</span>         url: jdbc:mysql://localhost:3306/demo?characterEncoding=utf-8<span style="color: #ff0000;">&amp;useSSL</span>=false<span style="color: #ff0000;">&amp;allowMultiQueries</span><span style="color: #000000;">=true
</span><span style="color: #008080;"> 12</span> <span style="color: #000000;">        # 链接数据库的用户名
</span><span style="color: #008080;"> 13</span> <span style="color: #000000;">        username: root
</span><span style="color: #008080;"> 14</span> <span style="color: #000000;">        # 链接数据库的用户密码，如果你不希望密码直接写在配置文件中，可以使用ConfigFilter。
</span><span style="color: #008080;"> 15</span> <span style="color: #000000;">        password: 123456
</span><span style="color: #008080;"> 16</span> <span style="color: #000000;">        # 驱动（根据url自动识别）这一项可配可不配，如果不配置druid会根据url自动识别dbType，然后选择相应的driverClassName(建议配置下)
</span><span style="color: #008080;"> 17</span> <span style="color: #000000;">        driver-class-name: com.mysql.jdbc.Driver
</span><span style="color: #008080;"> 18</span> <span style="color: #000000;">        # 数据库类型
</span><span style="color: #008080;"> 19</span> <span style="color: #000000;">        db-type: com.alibaba.druid.pool.DruidDataSource
</span><span style="color: #008080;"> 20</span> <span style="color: #000000;">        # 初始化时建立物理连接的个数。初始化发生在显示调用init方法，或者第一次getConnection时（缺省值：0）
</span><span style="color: #008080;"> 21</span> <span style="color: #000000;">        initialSize: 1
</span><span style="color: #008080;"> 22</span> <span style="color: #000000;">        # 最大连接池数量（缺省值：8）
</span><span style="color: #008080;"> 23</span> <span style="color: #000000;">        maxActive: 20
</span><span style="color: #008080;"> 24</span> <span style="color: #000000;">        # 最小链接池数量
</span><span style="color: #008080;"> 25</span> <span style="color: #000000;">        minIdle: 1
</span><span style="color: #008080;"> 26</span> <span style="color: #000000;">        # 获取连接时最大等待时间，单位毫秒。配置了maxWait之后，缺省启用公平锁，并发效率会有所下降，如果需要可以通过配置useUnfairLock属性为true使用非公平锁。
</span><span style="color: #008080;"> 27</span> <span style="color: #000000;">        maxWait: 60000
</span><span style="color: #008080;"> 28</span> <span style="color: #000000;">        # 是否缓存preparedStatement，也就是PSCache。PSCache对支持游标的数据库性能提升巨大，比如说oracle。在mysql下建议关闭。(缺省值：false)
</span><span style="color: #008080;"> 29</span> <span style="color: #000000;">        pool-prepared-statements: false
</span><span style="color: #008080;"> 30</span> <span style="color: #000000;">        # 要启用PSCache，必须配置大于0，当大于0时，poolPreparedStatements自动触发修改为true。在Druid中，不会存在Oracle下PSCache占用内存过多的问题，可以把这个数值配置大一些，比如说100
</span><span style="color: #008080;"> 31</span> <span style="color: #000000;">        max-open-prepared-statements: -1
</span><span style="color: #008080;"> 32</span> <span style="color: #000000;">        # 用来检测连接是否有效的sql，要求是一个查询语句。如果validationQuery为null，testOnBorrow、testOnReturn、testWhileIdle都不会其作用。
</span><span style="color: #008080;"> 33</span> <span style="color: #000000;">        validationQuery: select 'x'
</span><span style="color: #008080;"> 34</span> <span style="color: #000000;">        # 申请连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能。
</span><span style="color: #008080;"> 35</span> <span style="color: #000000;">        testOnBorrow: false
</span><span style="color: #008080;"> 36</span> <span style="color: #000000;">        # 归还连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能
</span><span style="color: #008080;"> 37</span> <span style="color: #000000;">        testOnReturn: false
</span><span style="color: #008080;"> 38</span> <span style="color: #000000;">        # 建议配置为true，不影响性能，并且保证安全性。申请连接的时候检测，如果空闲时间大于timeBetweenEvictionRunsMillis，执行validationQuery检测连接是否有效。
</span><span style="color: #008080;"> 39</span> <span style="color: #000000;">        testWhileIdle: true
</span><span style="color: #008080;"> 40</span> <span style="color: #000000;">        # 1) Destroy线程会检测连接的间隔时间2) testWhileIdle的判断依据，详细看testWhileIdle属性的说明
</span><span style="color: #008080;"> 41</span> <span style="color: #000000;">        timeBetweenEvictionRunsMillis: 60000
</span><span style="color: #008080;"> 42</span> <span style="color: #000000;">        # 配置一个连接在池中最小生存的时间，单位是毫秒
</span><span style="color: #008080;"> 43</span> <span style="color: #000000;">        minEvictableIdleTimeMillis: 300000
</span><span style="color: #008080;"> 44</span> <span style="color: #000000;">        # 物理连接初始化的时候执行的sql
</span><span style="color: #008080;"> 45</span> <span style="color: #000000;">        connectionInitSqls: select 1 from dual
</span><span style="color: #008080;"> 46</span> <span style="color: #000000;">        # 属性类型是字符串，通过别名的方式配置扩展插件，常用的插件有： 监控统计用的filter:stat日志用的filter:log4j防御sql注入的filter:wall
</span><span style="color: #008080;"> 47</span> <span style="color: #000000;">        filters: stat, wall
</span><span style="color: #008080;"> 48</span> <span style="color: #000000;">        filter: 
</span><span style="color: #008080;"> 49</span> <span style="color: #000000;">          # 监控统计
</span><span style="color: #008080;"> 50</span> <span style="color: #000000;">          stat:
</span><span style="color: #008080;"> 51</span> <span style="color: #000000;">            # 数据库类型
</span><span style="color: #008080;"> 52</span> <span style="color: #000000;">            db-type: mysql
</span><span style="color: #008080;"> 53</span> <span style="color: #000000;">            # 慢SQL
</span><span style="color: #008080;"> 54</span> <span style="color: #000000;">            log-slow-sql: true
</span><span style="color: #008080;"> 55</span> <span style="color: #000000;">            # 慢SQL执行时间
</span><span style="color: #008080;"> 56</span> <span style="color: #000000;">            slow-sql-millis: 2000
</span><span style="color: #008080;"> 57</span> <span style="color: #000000;">          wall:
</span><span style="color: #008080;"> 58</span> <span style="color: #000000;">            enabled: true
</span><span style="color: #008080;"> 59</span> <span style="color: #000000;">            db-type: mysql
</span><span style="color: #008080;"> 60</span> <span style="color: #000000;">            config:
</span><span style="color: #008080;"> 61</span> <span style="color: #000000;">              delete-allow: false
</span><span style="color: #008080;"> 62</span> <span style="color: #000000;">              drop-table-allow: false
</span><span style="color: #008080;"> 63</span>             
<span style="color: #008080;"> 64</span> <span style="color: #000000;">        # statViewServlet配置，说明配置参考druid wiki
</span><span style="color: #008080;"> 65</span> <span style="color: #000000;">        stat-view-servlet:
</span><span style="color: #008080;"> 66</span> <span style="color: #000000;">          # 是否启用statViewServlet配置
</span><span style="color: #008080;"> 67</span> <span style="color: #000000;">          enabled: true
</span><span style="color: #008080;"> 68</span> <span style="color: #000000;">          # 访问监控页面
</span><span style="color: #008080;"> 69</span> <span style="color: #000000;">          url-pattern: "/druid/*"
</span><span style="color: #008080;"> 70</span> <span style="color: #000000;">          # 禁止手动重置监控数据
</span><span style="color: #008080;"> 71</span> <span style="color: #000000;">          reset-enable: false
</span><span style="color: #008080;"> 72</span> <span style="color: #000000;">          # 设置监控页面的登陆名
</span><span style="color: #008080;"> 73</span> <span style="color: #000000;">          login-username: admin
</span><span style="color: #008080;"> 74</span> <span style="color: #000000;">          # 设置监控页面的登陆密码
</span><span style="color: #008080;"> 75</span> <span style="color: #000000;">          login-password: admin
</span><span style="color: #008080;"> 76</span> 
<span style="color: #008080;"> 77</span> <span style="color: #000000;">        #WebStatFilter配置，说明请参考Druid Wiki，配置_配置WebStatFilter
</span><span style="color: #008080;"> 78</span> <span style="color: #000000;">        web-stat-filter:
</span><span style="color: #008080;"> 79</span> <span style="color: #000000;">          # 是否启用WebStatFilter
</span><span style="color: #008080;"> 80</span> <span style="color: #000000;">          enabled: true
</span><span style="color: #008080;"> 81</span> <span style="color: #000000;">          # 访问路径
</span><span style="color: #008080;"> 82</span> <span style="color: #000000;">          url-pattern: "/*"
</span><span style="color: #008080;"> 83</span> <span style="color: #000000;">          # 排除不必要的url
</span><span style="color: #008080;"> 84</span> <span style="color: #000000;">          exclusions: "*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*"
</span><span style="color: #008080;"> 85</span> <span style="color: #000000;">          # 监控最大session数，默认是1000
</span><span style="color: #008080;"> 86</span> <span style="color: #000000;">          session-stat-max-count: 1000
</span><span style="color: #008080;"> 87</span> <span style="color: #000000;">          # 是否启用session的统计功能
</span><span style="color: #008080;"> 88</span> <span style="color: #000000;">          session-stat-enable: true
</span><span style="color: #008080;"> 89</span> <span style="color: #000000;">          # 是否启用监控单个Url调用的sql列表
</span><span style="color: #008080;"> 90</span> <span style="color: #000000;">          profile-enable: true
</span><span style="color: #008080;"> 91</span> <span style="color: #000000;">          # 使druid当前session的用户是谁，session_user_key是你保存到session中的sessionName
</span><span style="color: #008080;"> 92</span> <span style="color: #000000;">          principalSessionName: session_user_key
</span><span style="color: #008080;"> 93</span> <span style="color: #000000;">          # 使druid只当当前的user是谁,cookie_user_key是你保存在cookie中的cookieName
</span><span style="color: #008080;"> 94</span> <span style="color: #000000;">          principalCookieName: cookie_user_key      
</span><span style="color: #008080;"> 95</span>  <span style="color: #008080;">108</span>   </pre>
</div>
<p>&nbsp;</p>
<p>spring:&nbsp; &nbsp;thymeleaf:&nbsp; &nbsp; &nbsp; prefix: classpath:/templates/&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;datasource:&nbsp; &nbsp; &nbsp; druid:&nbsp; &nbsp; &nbsp; &nbsp; name: frame&nbsp; &nbsp; &nbsp; &nbsp; # 连接数据库的url，不同数据库不一样。例如：&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; # mysql : jdbc:mysql://10.20.153.104:3306/druid2&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; # oracle : jdbc:oracle:thin:@10.20.149.85:1521:ocnauto&nbsp; &nbsp; &nbsp; &nbsp; url: jdbc:mysql://localhost:3306/demo?characterEncoding=utf-8&amp;useSSL=false&amp;allowMultiQueries=true&nbsp; &nbsp; &nbsp; &nbsp; # 链接数据库的用户名&nbsp; &nbsp; &nbsp; &nbsp; username: root&nbsp; &nbsp; &nbsp; &nbsp; # 链接数据库的用户密码，如果你不希望密码直接写在配置文件中，可以使用ConfigFilter。&nbsp; &nbsp; &nbsp; &nbsp; password: 123456&nbsp; &nbsp; &nbsp; &nbsp; # 驱动（根据url自动识别）这一项可配可不配，如果不配置druid会根据url自动识别dbType，然后选择相应的driverClassName(建议配置下)&nbsp; &nbsp; &nbsp; &nbsp; driver-class-name: com.mysql.jdbc.Driver&nbsp; &nbsp; &nbsp; &nbsp; #&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; db-type: com.alibaba.druid.pool.DruidDataSource&nbsp; &nbsp; &nbsp; &nbsp; # 初始化时建立物理连接的个数。初始化发生在显示调用init方法，或者第一次getConnection时（缺省值：0）&nbsp; &nbsp; &nbsp; &nbsp; initialSize: 1&nbsp; &nbsp; &nbsp; &nbsp; # 最大连接池数量（缺省值：8）&nbsp; &nbsp; &nbsp; &nbsp; maxActive: 20&nbsp; &nbsp; &nbsp; &nbsp; # 最小链接池数量&nbsp; &nbsp; &nbsp; &nbsp; minIdle: 1&nbsp; &nbsp; &nbsp; &nbsp; # 获取连接时最大等待时间，单位毫秒。配置了maxWait之后，缺省启用公平锁，并发效率会有所下降，如果需要可以通过配置useUnfairLock属性为true使用非公平锁。&nbsp; &nbsp; &nbsp; &nbsp; maxWait: 60000&nbsp; &nbsp; &nbsp; &nbsp; # 是否缓存preparedStatement，也就是PSCache。PSCache对支持游标的数据库性能提升巨大，比如说oracle。在mysql下建议关闭。(缺省值：false)&nbsp; &nbsp; &nbsp; &nbsp; pool-prepared-statements: false&nbsp; &nbsp; &nbsp; &nbsp; # 要启用PSCache，必须配置大于0，当大于0时，poolPreparedStatements自动触发修改为true。在Druid中，不会存在Oracle下PSCache占用内存过多的问题，可以把这个数值配置大一些，比如说100&nbsp; &nbsp; &nbsp; &nbsp; max-open-prepared-statements: -1&nbsp; &nbsp; &nbsp; &nbsp; # 用来检测连接是否有效的sql，要求是一个查询语句。如果validationQuery为null，testOnBorrow、testOnReturn、testWhileIdle都不会其作用。&nbsp; &nbsp; &nbsp; &nbsp; validationQuery: select 'x'&nbsp; &nbsp; &nbsp; &nbsp; # 申请连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能。&nbsp; &nbsp; &nbsp; &nbsp; testOnBorrow: false&nbsp; &nbsp; &nbsp; &nbsp; # 归还连接时执行validationQuery检测连接是否有效，做了这个配置会降低性能&nbsp; &nbsp; &nbsp; &nbsp; testOnReturn: false&nbsp; &nbsp; &nbsp; &nbsp; # 建议配置为true，不影响性能，并且保证安全性。申请连接的时候检测，如果空闲时间大于timeBetweenEvictionRunsMillis，执行validationQuery检测连接是否有效。&nbsp; &nbsp; &nbsp; &nbsp; testWhileIdle: true&nbsp; &nbsp; &nbsp; &nbsp; # 1) Destroy线程会检测连接的间隔时间2) testWhileIdle的判断依据，详细看testWhileIdle属性的说明&nbsp; &nbsp; &nbsp; &nbsp; timeBetweenEvictionRunsMillis: 60000&nbsp; &nbsp; &nbsp; &nbsp; # 配置一个连接在池中最小生存的时间，单位是毫秒&nbsp; &nbsp; &nbsp; &nbsp; minEvictableIdleTimeMillis: 300000&nbsp; &nbsp; &nbsp; &nbsp; # 物理连接初始化的时候执行的sql&nbsp; &nbsp; &nbsp; &nbsp; connectionInitSqls: select 1 from dual&nbsp; &nbsp; &nbsp; &nbsp; # 属性类型是字符串，通过别名的方式配置扩展插件，常用的插件有： 监控统计用的filter:stat日志用的filter:log4j防御sql注入的filter:wall&nbsp; &nbsp; &nbsp; &nbsp; filters: stat, wall&nbsp; &nbsp; &nbsp; &nbsp; filter:&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 监控统计&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; stat:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 数据库类型&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db-type: mysql&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 慢SQL&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; log-slow-sql: true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 慢SQL执行时间&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; slow-sql-millis: 2000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; wall:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enabled: true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; db-type: mysql&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; config:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; delete-allow: false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; drop-table-allow: false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; # statViewServlet配置，说明配置参考druid wiki&nbsp; &nbsp; &nbsp; &nbsp; stat-view-servlet:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 是否启用statViewServlet配置&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enabled: true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 访问监控页面&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; url-pattern: "/druid/*"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 禁止手动重置监控数据&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; reset-enable: false&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 设置监控页面的登陆名&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; login-username: admin&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 设置监控页面的登陆密码&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; login-password: admin<br />&nbsp; &nbsp; &nbsp; &nbsp; #WebStatFilter配置，说明请参考Druid Wiki，配置_配置WebStatFilter&nbsp; &nbsp; &nbsp; &nbsp; web-stat-filter:&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 是否启用WebStatFilter&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; enabled: true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 访问路径&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; url-pattern: "/*"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 排除不必要的url&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; exclusions: "*.js,*.gif,*.jpg,*.bmp,*.png,*.css,*.ico,/druid/*"&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 监控最大session数，默认是1000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; session-stat-max-count: 1000&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 是否启用session的统计功能&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; session-stat-enable: true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 是否启用监控单个Url调用的sql列表&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; profile-enable: true&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 使druid当前session的用户是谁，session_user_key是你保存到session中的sessionName&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; principalSessionName: session_user_key&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; # 使druid只当当前的user是谁,cookie_user_key是你保存在cookie中的cookieName&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; principalCookieName: cookie_user_key&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp; &nbsp;jpa:&nbsp; &nbsp; &nbsp; generate-ddl: false&nbsp; &nbsp; &nbsp; show-sql: true&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp; &nbsp;&nbsp;&nbsp; &nbsp;resources:&nbsp; &nbsp; static-locations:&nbsp; &nbsp; &nbsp; - classpath:/META-INF/resources/,classpath:/resources/,classpath:/static/,classpath:/public/<br />logging:&nbsp; config: classpath:logback-spring.xml&nbsp; path: D:/log&nbsp;&nbsp;</p>
经常会遇到这种需求，就是根据图片的最长边缘来等比自适应，通过纯css可以很简单的使图片不变形显示。
 
#### 应用场景
例如有长大于宽的 也有宽大于长的当然也有长等于宽的，但是需求是不知道图片的长和宽哪个长，那么就需要在不管图片的长和宽哪个长哪个短，在容器中都能自适应保持等比放大或缩小如图：
![](https://img2018.cnblogs.com/blog/1433614/201811/1433614-20181122150108776-1731590309.png)
长大于宽的图

![](https://img2018.cnblogs.com/blog/1433614/201811/1433614-20181122150124518-1556549891.png)
宽大于长的图
 
![](https://img2018.cnblogs.com/blog/1433614/201811/1433614-20181122150819779-679686807.png)
长等于宽的图

### 实现代码
可以看不管图片是什么比例的宽度，都可以自适应不变形的显示，代码很简单，只需要css就可以实现,将图片的max-width和max-height设置成100%
```
img {
    max-width: 100%;
    max-height: 100%;
}
```
很简单的两行css代码就实现了
<p align="center"><strong>2018</strong><strong>面向对象程序设计（</strong><strong>Java</strong><strong>）<strong>第</strong><strong>13</strong><strong>周学习指导及要求</strong></strong></p>
<p align="center"><strong><strong>（</strong><strong>2018.11.22-2018.11.25</strong><strong>）<strong>&nbsp;</strong></strong></strong></p>
<p align="left"><strong>学习目标</strong></p>
<p align="left">(1) 掌握事件处理的基本原理，理解其用途；</p>
<p align="left">(2) 掌握AWT事件模型的工作机制；</p>
<p align="left">(3) 掌握事件处理的基本编程模型；</p>
<p align="left">(4) 了解GUI界面组件观感设置方法；</p>
<p align="left">(5) 掌握WindowAdapter类、AbstractAction类的用法；</p>
<p align="left">(6) 掌握GUI程序中鼠标事件处理技术。</p>
<p align="left"><strong>学习资源</strong></p>
<p align="left">1.教材第11章</p>
<p align="left">2.第11章教学课件</p>
<p align="left">3. corejava.zip</p>
<p align="left">4. 实验十三任务书</p>
<p align="left"><strong>学习任务</strong></p>
<p style="text-align: left;">1.增补《面向对象程序设计课程学习进度条》第十三周数据；</p>
<p style="text-align: left;">2.完成实验十三；</p>
<p style="text-align: left;">3.将本周学习内容（包括实验内容）通过博客(随笔)发表，博客标题为&ldquo;本人姓名<strong>《面向对象程序设计（</strong><strong>java</strong><strong>）》第十三周学习总结&rdquo;</strong>。</p>
<p style="text-align: left;">4.结对编程实验总结需包含以下4部分：</p>
<p align="left">1)&nbsp;&nbsp;&nbsp; 程序设计思路简述；</p>
<p align="left">2)&nbsp;&nbsp;&nbsp; 符合编程规范的程序代码；</p>
<p align="left">3)&nbsp;&nbsp;&nbsp; 程序运行功能界面截图；</p>
<p align="left">4)&nbsp;&nbsp;&nbsp; 结对过程描述，提供两人在讨论、细化和编程时的结对照片(非摆拍)。</p>
<p align="left">&nbsp;</p>
<p align="left"><strong>Deadline</strong><strong>：</strong><strong>2018-11-25 17:00</strong><strong>，以博客发表日期为准</strong></p>
<p align="left"><strong>作业要求</strong></p>
<p align="left">1.按时交，未提交博客到班级博客，本次作业不得分；</p>
<p align="left">2.博文规范（行文清晰流畅,如果行文中涉及代码，请使用博客园自带的代码控件，或使用MarkDown的语法块）；</p>
<p align="left">3.抄袭 - 倒扣本次作业分数。</p>
<p align="left">&nbsp;</p>
<p><span style="font-size: 15px;">之前在新浪博客写了不少springmvc的相关技术，但新浪博客毕竟不是专业的技术博客，添加代码很不方便，就开始在博客园试试了。</span></p>
<p><span style="font-size: 15px;">使用java开发也不少年了，准备再次整理一些java基础知识，当然，这次不仅仅是了解一些概念，更希望能对基础知识进行更深入的原理分析。</span></p>
<p><span style="font-size: 15px;">&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</span></p>
<p><span style="font-size: 15px;">以上是题外话。</span></p>
<p><span style="font-size: 15px;">学习java都会接触3个常见的名称：JDK、JRE、JVM。</span></p>
<p><span style="font-size: 15px;">来看看它们都是什么：</span></p>
<div class="cnblogs_code" onclick="cnblogs_code_show('14f62cf9-3d47-458d-99e8-9a9e7de12d00')"><span style="font-size: 15px;"><img id="code_img_closed_14f62cf9-3d47-458d-99e8-9a9e7de12d00" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_14f62cf9-3d47-458d-99e8-9a9e7de12d00" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('14f62cf9-3d47-458d-99e8-9a9e7de12d00',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /></span>
<div id="cnblogs_code_open_14f62cf9-3d47-458d-99e8-9a9e7de12d00" class="cnblogs_code_hide">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yun.jvm;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * Base Knowledge
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> Mars
 *
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> BaseKnowledge {

    </span><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">final</span> String LINE_SEPARATOR = "line.separator"<span style="color: #000000;">;

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Java Development Kit
     * java的开发工具,包括jre+开发工具
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> String jdk = 
            "JDK:" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR) 
            </span>+ "Java Development Kit;" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR) 
            </span>+ "java的开发工具,包括jre+开发工具" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR);
    
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Java Runtime Environment
     * java的运行环境,包括jvm+java的核心类库
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> String jre = 
            "JRE:" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR) 
            </span>+ "Java Runtime Environment;" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR) 
            </span>+ "java的运行环境,包括jvm+java的核心类库" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR);
    
    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * Java Virtual Machine
     * java虚拟机，用于保证java的跨平台的特性
     * Java语言使用Java虚拟机屏蔽了与具体平台相关的信息，
     * 使得Java语言编译程序只需生成在Java虚拟机上运行的目标代码（字节码），
     * 就可以在多种平台上不加修改地运行。
     * Java虚拟机在执行字节码时，把字节码解释成具体平台上的机器指令执行
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">private</span> String jvm = 
            "JVM:" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR)
            </span>+ "Java Virtual Machine;" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR)
            </span>+ "java虚拟机，用于保证java的跨平台的特性;" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR)
            </span>+ "Java语言使用Java虚拟机屏蔽了与具体平台相关的信息，" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR)
            </span>+ "使得Java语言编译程序只需生成在Java虚拟机上运行的目标代码（字节码），" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR)
            </span>+ "就可以在多种平台上不加修改地运行。" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR)
            </span>+ "Java虚拟机在执行字节码时，把字节码解释成具体平台上的机器指令执行" +<span style="color: #000000;"> System.getProperty(LINE_SEPARATOR);

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String getJdk() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> jdk;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setJdk(String jdk) {
        </span><span style="color: #0000ff;">this</span>.jdk =<span style="color: #000000;"> jdk;
    }

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String getJre() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> jre;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setJre(String jre) {
        </span><span style="color: #0000ff;">this</span>.jre =<span style="color: #000000;"> jre;
    }

    </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> String getJvm() {
        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> jvm;
    }

    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> setJvm(String jvm) {
        </span><span style="color: #0000ff;">this</span>.jvm =<span style="color: #000000;"> jvm;
    }
}</span></span></pre>
</div>
<span class="cnblogs_code_collapse" style="font-size: 15px;">View Code</span></div>
<p><span style="font-size: 15px;">使用代码的方式来展示是因为程序员是需要在不断的写代码中来提升的，只看技术性的文字，就没有独属于程序员的亲切感，印象不深。</span></p>
<p><span style="font-size: 15px;">BaseKnowledge.java是一个标准的java式的面向对象写法，变量私有化，通过get、set方法来访问。</span></p>
<p><span style="font-size: 15px;">现在的java开发工具（eclipse等）都具有自动生成get、set方法的功能。想起自己刚毕业参加工作时，还不熟悉开发工具，全部手写get、set方法，当私有变量很多时，可以想象那个画面。</span></p>
<p><span style="font-size: 15px;">这段代码很简单，什么都没做，就是在代码里介绍了JDK、JRE、JVM是什么。在这里只分析一下其中一句代码：</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;">System.getProperty(LINE_SEPARATOR)</span></pre>
</div>
<p><span style="font-size: 15px;">这句代码是从系统中获取当前操作系统的换行符，不同操作系统的换行符是不一样的，比如windows系统是/r/n，linux系统是/n，苹果机系统是/r。</span></p>
<p><span style="font-size: 15px;">使用这句代码可以避免硬编码带来的不同操作系统可能产生的问题，也省去了手动进行不同操作系统的分支判断。</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> String getProperty(String key) {
        checkKey(key);
        SecurityManager sm </span>=<span style="color: #000000;"> getSecurityManager();
        </span><span style="color: #0000ff;">if</span> (sm != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            sm.checkPropertyAccess(key);
        }

        </span><span style="color: #0000ff;">return</span><span style="color: #000000;"> props.getProperty(key);
    }</span></span></pre>
</div>
<p><span style="font-size: 15px;">这个方法属于java.lang.System类。</span></p>
<p><span style="font-size: 15px;">1.checkKey方法，判断key是否为空值，如果是空值，直接抛出异常。</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> checkKey(String key) {
        </span><span style="color: #0000ff;">if</span> (key == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> NullPointerException("key can't be null"<span style="color: #000000;">);
        }
        </span><span style="color: #0000ff;">if</span> (key.equals(""<span style="color: #000000;">)) {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> IllegalArgumentException("key can't be empty"<span style="color: #000000;">);
        }
    }</span></span></pre>
</div>
<p><span style="font-size: 15px;">注意这里的逻辑处理方式，是通过抛异常的方式来处理key值为空的情况，而不是另外一种boolean判断方法：</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">boolean</span><span style="color: #000000;"> checkKey(String key) {
        </span><span style="color: #0000ff;">if</span> (key == <span style="color: #0000ff;">null</span> || key.equals(""<span style="color: #000000;">)) {
            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">false</span><span style="color: #000000;">;
        }
        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">true</span><span style="color: #000000;">;
    }
    
    </span><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span><span style="color: #000000;"> String getProperty(String key) {
        </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (checkKey(key)) {
            
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> do sth..</span>
<span style="color: #000000;">        }

        </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
    }</span></span></pre>
</div>
<p><span style="font-size: 15px;">个人觉得很多时候程序员写代码都对java的异常处理Exception关注不够，笔者参与的很多项目也没有对Exception有比较规范成体系的处理。</span></p>
<p><span style="font-size: 15px;">这两种写法在具体的项目开发中，值得去思考一下如何选择。</span></p>
<p><span style="font-size: 15px;">2.获取SecurityManager，校验当前的key在操作系统安全策略里是不是可访问的。</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;">SecurityManager sm =<span style="color: #000000;"> getSecurityManager();
        </span><span style="color: #0000ff;">if</span> (sm != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            sm.checkPropertyAccess(key);
        }</span></span></pre>
</div>
<p><span style="font-size: 15px;">一层层向下看：</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> checkPropertyAccess(String key) {
        checkPermission(</span><span style="color: #0000ff;">new</span><span style="color: #000000;"> PropertyPermission(key,
            SecurityConstants.PROPERTY_READ_ACTION));
    }</span></span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> checkPermission(Permission perm) {
        java.security.AccessController.checkPermission(perm);
    }</span></span></pre>
</div>
<div class="cnblogs_code" onclick="cnblogs_code_show('b6daddd9-569a-45a0-be55-ef671c946c43')"><span style="font-size: 15px;"><img id="code_img_closed_b6daddd9-569a-45a0-be55-ef671c946c43" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_b6daddd9-569a-45a0-be55-ef671c946c43" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('b6daddd9-569a-45a0-be55-ef671c946c43',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /></span>
<div id="cnblogs_code_open_b6daddd9-569a-45a0-be55-ef671c946c43" class="cnblogs_code_hide">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> checkPermission(Permission perm)
        </span><span style="color: #0000ff;">throws</span><span style="color: #000000;"> AccessControlException
    {
        </span><span style="color: #008000;">//</span><span style="color: #008000;">System.err.println("checkPermission "+perm);
        </span><span style="color: #008000;">//</span><span style="color: #008000;">Thread.currentThread().dumpStack();</span>

        <span style="color: #0000ff;">if</span> (perm == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> NullPointerException("permission can't be null"<span style="color: #000000;">);
        }

        AccessControlContext stack </span>=<span style="color: #000000;"> getStackAccessControlContext();
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> if context is null, we had privileged system code on the stack.</span>
        <span style="color: #0000ff;">if</span> (stack == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            Debug debug </span>=<span style="color: #000000;"> AccessControlContext.getDebug();
            </span><span style="color: #0000ff;">boolean</span> dumpDebug = <span style="color: #0000ff;">false</span><span style="color: #000000;">;
            </span><span style="color: #0000ff;">if</span> (debug != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                dumpDebug </span>= !Debug.isOn("codebase="<span style="color: #000000;">);
                dumpDebug </span>&amp;= !Debug.isOn("permission=") ||<span style="color: #000000;">
                    Debug.isOn(</span>"permission=" +<span style="color: #000000;"> perm.getClass().getCanonicalName());
            }

            </span><span style="color: #0000ff;">if</span> (dumpDebug &amp;&amp; Debug.isOn("stack"<span style="color: #000000;">)) {
                Thread.dumpStack();
            }

            </span><span style="color: #0000ff;">if</span> (dumpDebug &amp;&amp; Debug.isOn("domain"<span style="color: #000000;">)) {
                debug.println(</span>"domain (context is null)"<span style="color: #000000;">);
            }

            </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (dumpDebug) {
                debug.println(</span>"access allowed "+<span style="color: #000000;">perm);
            }
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
        }

        AccessControlContext acc </span>=<span style="color: #000000;"> stack.optimize();
        acc.checkPermission(perm);
    }</span></span></pre>
</div>
<span class="cnblogs_code_collapse" style="font-size: 15px;">View Code</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('36319fb4-8432-4fb1-a6ba-47ecfa9858c7')"><span style="font-size: 15px;"><img id="code_img_closed_36319fb4-8432-4fb1-a6ba-47ecfa9858c7" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_36319fb4-8432-4fb1-a6ba-47ecfa9858c7" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('36319fb4-8432-4fb1-a6ba-47ecfa9858c7',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /></span>
<div id="cnblogs_code_open_36319fb4-8432-4fb1-a6ba-47ecfa9858c7" class="cnblogs_code_hide">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">public</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> checkPermission(Permission perm)
        </span><span style="color: #0000ff;">throws</span><span style="color: #000000;"> AccessControlException
    {
        </span><span style="color: #0000ff;">boolean</span> dumpDebug = <span style="color: #0000ff;">false</span><span style="color: #000000;">;

        </span><span style="color: #0000ff;">if</span> (perm == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> NullPointerException("permission can't be null"<span style="color: #000000;">);
        }
        </span><span style="color: #0000ff;">if</span> (getDebug() != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            </span><span style="color: #008000;">//</span><span style="color: #008000;"> If "codebase" is not specified, we dump the info by default.</span>
            dumpDebug = !Debug.isOn("codebase="<span style="color: #000000;">);
            </span><span style="color: #0000ff;">if</span> (!<span style="color: #000000;">dumpDebug) {
                </span><span style="color: #008000;">//</span><span style="color: #008000;"> If "codebase" is specified, only dump if the specified code
                </span><span style="color: #008000;">//</span><span style="color: #008000;"> value is in the stack.</span>
                <span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i = 0; context != <span style="color: #0000ff;">null</span> &amp;&amp; i &lt; context.length; i++<span style="color: #000000;">) {
                    </span><span style="color: #0000ff;">if</span> (context[i].getCodeSource() != <span style="color: #0000ff;">null</span> &amp;&amp;<span style="color: #000000;">
                        context[i].getCodeSource().getLocation() </span>!= <span style="color: #0000ff;">null</span> &amp;&amp;<span style="color: #000000;">
                        Debug.isOn(</span>"codebase=" +<span style="color: #000000;"> context[i].getCodeSource().getLocation().toString())) {
                        dumpDebug </span>= <span style="color: #0000ff;">true</span><span style="color: #000000;">;
                        </span><span style="color: #0000ff;">break</span><span style="color: #000000;">;
                    }
                }
            }

            dumpDebug </span>&amp;= !Debug.isOn("permission=") ||<span style="color: #000000;">
                Debug.isOn(</span>"permission=" +<span style="color: #000000;"> perm.getClass().getCanonicalName());

            </span><span style="color: #0000ff;">if</span> (dumpDebug &amp;&amp; Debug.isOn("stack"<span style="color: #000000;">)) {
                Thread.dumpStack();
            }

            </span><span style="color: #0000ff;">if</span> (dumpDebug &amp;&amp; Debug.isOn("domain"<span style="color: #000000;">)) {
                </span><span style="color: #0000ff;">if</span> (context == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                    debug.println(</span>"domain (context is null)"<span style="color: #000000;">);
                } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                    </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i=0; i&lt; context.length; i++<span style="color: #000000;">) {
                        debug.println(</span>"domain "+i+" "+<span style="color: #000000;">context[i]);
                    }
                }
            }
        }

        </span><span style="color: #008000;">/*</span><span style="color: #008000;">
         * iterate through the ProtectionDomains in the context.
         * Stop at the first one that doesn't allow the
         * requested permission (throwing an exception).
         *
         </span><span style="color: #008000;">*/</span>

        <span style="color: #008000;">/*</span><span style="color: #008000;"> if ctxt is null, all we had on the stack were system domains,
           or the first domain was a Privileged system domain. This
           is to make the common case for system code very fast </span><span style="color: #008000;">*/</span>

        <span style="color: #0000ff;">if</span> (context == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            checkPermission2(perm);
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
        }

        </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i=0; i&lt; context.length; i++<span style="color: #000000;">) {
            </span><span style="color: #0000ff;">if</span> (context[i] != <span style="color: #0000ff;">null</span> &amp;&amp;  !<span style="color: #000000;">context[i].implies(perm)) {
                </span><span style="color: #0000ff;">if</span><span style="color: #000000;"> (dumpDebug) {
                    debug.println(</span>"access denied " +<span style="color: #000000;"> perm);
                }

                </span><span style="color: #0000ff;">if</span> (Debug.isOn("failure") &amp;&amp; debug != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                    </span><span style="color: #008000;">//</span><span style="color: #008000;"> Want to make sure this is always displayed for failure,
                    </span><span style="color: #008000;">//</span><span style="color: #008000;"> but do not want to display again if already displayed
                    </span><span style="color: #008000;">//</span><span style="color: #008000;"> above.</span>
                    <span style="color: #0000ff;">if</span> (!<span style="color: #000000;">dumpDebug) {
                        debug.println(</span>"access denied " +<span style="color: #000000;"> perm);
                    }
                    Thread.dumpStack();
                    </span><span style="color: #0000ff;">final</span> ProtectionDomain pd =<span style="color: #000000;"> context[i];
                    </span><span style="color: #0000ff;">final</span> Debug db =<span style="color: #000000;"> debug;
                    AccessController.doPrivileged (</span><span style="color: #0000ff;">new</span> PrivilegedAction&lt;Void&gt;<span style="color: #000000;">() {
                        </span><span style="color: #0000ff;">public</span><span style="color: #000000;"> Void run() {
                            db.println(</span>"domain that failed "+<span style="color: #000000;">pd);
                            </span><span style="color: #0000ff;">return</span> <span style="color: #0000ff;">null</span><span style="color: #000000;">;
                        }
                    });
                }
                </span><span style="color: #0000ff;">throw</span> <span style="color: #0000ff;">new</span> AccessControlException("access denied "+<span style="color: #000000;">perm, perm);
            }
        }

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> allow if all of them allowed access</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;"> (dumpDebug) {
            debug.println(</span>"access allowed "+<span style="color: #000000;">perm);
        }

        checkPermission2(perm);
    }</span></span></pre>
</div>
<span class="cnblogs_code_collapse" style="font-size: 15px;">View Code</span></div>
<div class="cnblogs_code" onclick="cnblogs_code_show('e6cc011a-29fa-4313-81bd-cf8381562954')"><span style="font-size: 15px;"><img id="code_img_closed_e6cc011a-29fa-4313-81bd-cf8381562954" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_e6cc011a-29fa-4313-81bd-cf8381562954" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('e6cc011a-29fa-4313-81bd-cf8381562954',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" /></span>
<div id="cnblogs_code_open_e6cc011a-29fa-4313-81bd-cf8381562954" class="cnblogs_code_hide">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> checkPermission2(Permission perm) {
        </span><span style="color: #0000ff;">if</span> (!<span style="color: #000000;">isLimited) {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
        }

        </span><span style="color: #008000;">/*</span><span style="color: #008000;">
         * Check the doPrivileged() context parameter, if present.
         </span><span style="color: #008000;">*/</span>
        <span style="color: #0000ff;">if</span> (privilegedContext != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            privilegedContext.checkPermission2(perm);
        }

        </span><span style="color: #008000;">/*</span><span style="color: #008000;">
         * Ignore the limited permissions and parent fields of a wrapper
         * context since they were already carried down into the unwrapped
         * context.
         </span><span style="color: #008000;">*/</span>
        <span style="color: #0000ff;">if</span><span style="color: #000000;"> (isWrapped) {
            </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
        }

        </span><span style="color: #008000;">/*</span><span style="color: #008000;">
         * Try to match any limited privilege scope.
         </span><span style="color: #008000;">*/</span>
        <span style="color: #0000ff;">if</span> (permissions != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            Class</span>&lt;?&gt; permClass =<span style="color: #000000;"> perm.getClass();
            </span><span style="color: #0000ff;">for</span> (<span style="color: #0000ff;">int</span> i=0; i &lt; permissions.length; i++<span style="color: #000000;">) {
                Permission limit </span>=<span style="color: #000000;"> permissions[i];
                </span><span style="color: #0000ff;">if</span> (limit.getClass().equals(permClass) &amp;&amp;<span style="color: #000000;"> limit.implies(perm)) {
                    </span><span style="color: #0000ff;">return</span><span style="color: #000000;">;
                }
            }
        }

        </span><span style="color: #008000;">/*</span><span style="color: #008000;">
         * Check the limited privilege scope up the call stack or the inherited
         * parent thread call stack of this ACC.
         </span><span style="color: #008000;">*/</span>
        <span style="color: #0000ff;">if</span> (parent != <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
            </span><span style="color: #008000;">/*</span><span style="color: #008000;">
             * As an optimization, if the parent context is the inherited call
             * stack context from a parent thread then checking the protection
             * domains of the parent context is redundant since they have
             * already been merged into the child thread's context by
             * optimize(). When parent is set to an inherited context this
             * context was not directly created by a limited scope
             * doPrivileged() and it does not have its own limited permissions.
             </span><span style="color: #008000;">*/</span>
            <span style="color: #0000ff;">if</span> (permissions == <span style="color: #0000ff;">null</span><span style="color: #000000;">) {
                parent.checkPermission2(perm);
            } </span><span style="color: #0000ff;">else</span><span style="color: #000000;"> {
                parent.checkPermission(perm);
            }
        }
    }</span></span></pre>
</div>
<span class="cnblogs_code_collapse" style="font-size: 15px;">View Code</span></div>
<p><span style="font-size: 15px;">这里不做更细致的分析，只是简单的贴出代码，有兴趣的可以细看。</span></p>
<p><span style="font-size: 15px;">有两点可以注意一下：</span></p>
<p><span style="font-size: 15px;">一是checkPermission方法里对于没有访问权限的key，同样是通过抛出异常的方式来处理，而不是返回true or false；</span></p>
<p><span style="font-size: 15px;">二是有个checkPermission2的方法，按理说这种命名方式是不可取的，不符合命名规范，不知道是不是因为代码是反编译出来的原因。</span></p>
<p><span style="font-size: 15px;">（注：贴出的代码属于java.security.AccessController和java.security.AccessControlContext类）</span></p>
<p><span style="font-size: 15px;">3.经过非空判断和访问权限校验后，从props里获取具体的key对应的value</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">return</span> props.getProperty(key);</span></pre>
</div>
<p><span style="font-size: 15px;">props是System类的成员变量，会在JVM启动时进行初始化：</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> initializeSystemClass() {

        </span><span style="color: #008000;">//</span><span style="color: #008000;"> VM might invoke JNU_NewStringPlatform() to set those encoding
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> sensitive properties (user.home, user.name, boot.class.path, etc.)
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> during "props" initialization, in which it may need access, via
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> System.getProperty(), to the related system encoding property that
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> have been initialized (put into "props") at early stage of the
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> initialization. So make sure the "props" is available at the
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> very beginning of the initialization and all system properties to
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> be put into it directly.</span>
        props = <span style="color: #0000ff;">new</span><span style="color: #000000;"> Properties();
        initProperties(props);  </span><span style="color: #008000;">//</span><span style="color: #008000;"> initialized by the VM</span></span></pre>
</div>
<div class="cnblogs_code">
<pre><span style="font-size: 15px;"><span style="color: #0000ff;">private</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">native</span> Properties initProperties(Properties props);</span></pre>
</div>
<pre><span style="font-size: 15px;">initProperties是一个本地（native）方法。</span><br /><br /><span style="font-size: 15px;">System.getProperty()方法就分析到这里了，可以看出，处处都是知识点啊，很简单的代码，它背后的东西往往不简单；当然，如果细细的分析清楚了，那么再复杂的代码，在程序员眼里，也会很简单。</span><br /><br /><span style="font-size: 15px;">&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</span><br /><span style="font-size: 15px;">分割线。</span><br /><br /><span style="font-size: 15px;">接下来准备对java程序运行的根本，JVM，进行比较详细的分析。弄清楚JVM的原理，对我们写代码和程序优化，都会有非常大的帮助。</span></pre>
<p>&nbsp;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;</p>
<div class="cnblogs_code" onclick="cnblogs_code_show('8d85ba95-0bc5-4b33-aab6-e3ff00b54173')"><img id="code_img_closed_8d85ba95-0bc5-4b33-aab6-e3ff00b54173" class="code_img_closed" src="http://images.cnblogs.com/OutliningIndicators/ContractedBlock.gif" alt="" /><img id="code_img_opened_8d85ba95-0bc5-4b33-aab6-e3ff00b54173" class="code_img_opened" style="display: none;" onclick="cnblogs_code_hide('8d85ba95-0bc5-4b33-aab6-e3ff00b54173',event)" src="http://images.cnblogs.com/OutliningIndicators/ExpandedBlockStart.gif" alt="" />
<div id="cnblogs_code_open_8d85ba95-0bc5-4b33-aab6-e3ff00b54173" class="cnblogs_code_hide">
<pre><span style="color: #0000ff;">package</span><span style="color: #000000;"> com.yun.jvm;

</span><span style="color: #008000;">/**</span><span style="color: #008000;">
 * Main
 * </span><span style="color: #808080;">@author</span><span style="color: #008000;"> Mars
 *
 </span><span style="color: #008000;">*/</span>
<span style="color: #0000ff;">public</span> <span style="color: #0000ff;">class</span><span style="color: #000000;"> Main {

    </span><span style="color: #008000;">/**</span><span style="color: #008000;">
     * main method
     * </span><span style="color: #808080;">@param</span><span style="color: #008000;"> args
     </span><span style="color: #008000;">*/</span>
    <span style="color: #0000ff;">public</span> <span style="color: #0000ff;">static</span> <span style="color: #0000ff;">void</span><span style="color: #000000;"> main(String[] args) {
        
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> baseKnowledge</span>
        BaseKnowledge baseKnowledge = <span style="color: #0000ff;">new</span><span style="color: #000000;"> BaseKnowledge();
        
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> jdk</span>
        String jdk =<span style="color: #000000;"> baseKnowledge.getJdk();
        
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> jre</span>
        String jre =<span style="color: #000000;"> baseKnowledge.getJre();
        
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> jvm</span>
        String jvm =<span style="color: #000000;"> baseKnowledge.getJvm();
        
        </span><span style="color: #008000;">//</span><span style="color: #008000;"> output</span>
        System.out.println("My dear, my wife, I love you !"<span style="color: #000000;">);
        System.out.println(jdk);
        System.out.println(jre);
        System.out.println(jvm);
    }
}</span></pre>
</div>
<span class="cnblogs_code_collapse">View Code</span></div>
<p>&nbsp;</p>
<div class="title">&nbsp;</div>
<p><strong>array_unique() 定义和用法 <br /></strong>array_unique() 函数移除数组中的重复的值，并返回结果数组。 <br /><br />当几个数组元素的值相等时，只保留第一个元素，其他的元素被删除。 <br /><br />返回的数组中键名不变。 <br /><br />语法 <br />array_unique(array) <br />参数 描述 <br />array 必需。规定输入的数组。 <br /><br />说明 <br />array_unique() 先将值作为字符串排序，然后对每个值只保留第一个遇到的键名，接着忽略所有后面的键名。这并不意味着在未排序的 array 中同一个值的第一个出现的键名会被保留。 <br /><br />提示和注释 <br />注释：被返回的数组将保持第一个数组元素的键类型。 <br /><br />例子 </p>
<div id="code10114" class="codebody"> <br />
<div class="cnblogs_code">
<pre><span style="color: #008080;">1</span> &lt;?<span style="color: #000000;">php
</span><span style="color: #008080;">2</span> <span style="color: #800080;">$a</span>=<span style="color: #0000ff;">array</span>("a"=&gt;"Cat","b"=&gt;"Dog","c"=&gt;"Cat"<span style="color: #000000;">);
</span><span style="color: #008080;">3</span> <span style="color: #008080;">print_r</span>(<span style="color: #008080;">array_unique</span>(<span style="color: #800080;">$a</span><span style="color: #000000;">));
</span><span style="color: #008080;">4</span> ?&gt; </pre>
</div>
<p>&nbsp;</p>
</div>
<p>
 <br />输出： <br /><br />Array ( [a] =&gt; Cat [b] =&gt; Dog )</p>
<h2 id="本篇文章主要介绍nosql的一些东西以及nosql中比较火的三个数据库redismemchachemongodb和他们之间的区别以下是本文章的阅读目录">本篇文章主要介绍Nosql的一些东西，以及Nosql中比较火的三个数据库Redis、Memchache、MongoDb和他们之间的区别。以下是本文章的阅读目录</h2>
<h3 id="一nosql介绍">一、Nosql介绍</h3>
<p>1.<a href="https://www.cnblogs.com/lina520/p/7919551.html#item1">Nosql简介</a><br />2.<a href="https://www.cnblogs.com/lina520/p/7919551.html#item2">Nosql的特点和关系型数据库的区别</a><br />3.<a href="https://www.cnblogs.com/lina520/p/7919551.html#item3">Redis，Memcache，MongoDb的特点与区别</a><br />4<a href="https://www.cnblogs.com/lina520/p/7919551.html#item4">.参考文章</a><br /><br /></p>
<h1 id="nosql介绍"><span id="item1">Nosql介绍</span></h1>
<h4 id="nosql的全称是not-only-sql这个概念早起就有人提出在09年的时候比较火nosql指的是非关系型数据库而我们常用的都是关系型数据库就像我们常用的mysqlsqlserver一样这些数据库一般用来存储重要信息应对普通的业务是没有问题的但是随着互联网的高速发展传统的关系型数据库在应付超大规模超大流量以及高并发的时候力不从心而就在这个时候nosql得到的告诉的发展">Nosql的全称是Not Only Sql，这个概念早起就有人提出，在09年的时候比较火。Nosql指的是非关系型数据库，而我们常用的都是关系型数据库。就像我们常用的mysql，sqlserver一样，这些数据库一般用来存储重要信息，应对普通的业务是没有问题的。但是，随着互联网的高速发展，传统的关系型数据库在应付超大规模，超大流量以及高并发的时候力不从心。而就在这个时候，Nosql得到的告诉的发展。</h4>
<p>&nbsp;</p>
<h1 id="nosql和关系型数据库的区别"><span id="item2">Nosql和关系型数据库的区别</span></h1>
<h3 id="存储方式">1.存储方式</h3>
<h4 id="关系型数据库是表格式的因此存储在表的行和列中他们之间很容易关联协作存储提取数据很方便而nosql数据库则与其相反他是大块的组合在一起通常存储在数据集中就像文档键值对或者图结构">　　关系型数据库是表格式的，因此存储在表的行和列中。他们之间很容易关联协作存储，提取数据很方便。而Nosql数据库则与其相反，他是大块的组合在一起。通常存储在数据集中，就像文档、键值对或者图结构。</h4>
<p>&nbsp;</p>
<h3 id="存储结构">2.存储结构</h3>
<h4 id="关系型数据库对应的是结构化数据数据表都预先定义了结构列的定义结构描述了数据的形式和内容这一点对数据建模至关重要虽然预定义结构带来了可靠性和稳定性但是修改这些数据比较困难而nosql数据库基于动态结构使用与非结构化数据因为nosql数据库是动态结构可以很容易适应数据类型和结构的变化">　　关系型数据库对应的是结构化数据，数据表都预先定义了结构（列的定义），结构描述了数据的形式和内容。这一点对数据建模至关重要，虽然预定义结构带来了可靠性和稳定性，但是修改这些数据比较困难。而Nosql数据库基于动态结构，使用与非结构化数据。因为Nosql数据库是动态结构，可以很容易适应数据类型和结构的变化。</h4>
<p>&nbsp;</p>
<h3 id="存储规范">3.存储规范</h3>
<h4 id="关系型数据库的数据存储为了更高的规范性把数据分割为最小的关系表以避免重复获得精简的空间利用虽然管理起来很清晰但是单个操作设计到多张表的时候数据管理就显得有点麻烦而nosql数据存储在平面数据集中数据经常可能会重复单个数据库很少被分隔开而是存储成了一个整体这样整块数据更加便于读写">　　关系型数据库的数据存储为了更高的规范性，把数据分割为最小的关系表以避免重复，获得精简的空间利用。虽然管理起来很清晰，但是单个操作设计到多张表的时候，数据管理就显得有点麻烦。而Nosql数据存储在平面数据集中，数据经常可能会重复。单个数据库很少被分隔开，而是存储成了一个整体，这样整块数据更加便于读写</h4>
<p>&nbsp;</p>
<h3 id="存储扩展">4.存储扩展</h3>
<h4 id="这可能是两者之间最大的区别关系型数据库是纵向扩展也就是说想要提高处理能力要使用速度更快的计算机因为数据存储在关系表中操作的性能瓶颈可能涉及到多个表需要通过提升计算机性能来克服虽然有很大的扩展空间但是最终会达到纵向扩展的上限而nosql数据库是横向扩展的它的存储天然就是分布式的可以通过给资源池添加更多的普通数据库服务器来分担负载">　　这可能是两者之间最大的区别，关系型数据库是纵向扩展，也就是说想要提高处理能力，要使用速度更快的计算机。因为数据存储在关系表中，操作的性能瓶颈可能涉及到多个表，需要通过提升计算机性能来克服。虽然有很大的扩展空间，但是最终会达到纵向扩展的上限。而Nosql数据库是横向扩展的，它的存储天然就是分布式的，可以通过给资源池添加更多的普通数据库服务器来分担负载。</h4>
<p>&nbsp;</p>
<h3 id="查询方式">5.查询方式</h3>
<h4 id="关系型数据库通过结构化查询语言来操作数据库就是我们通常说的sqlsql支持数据库curd操作的功能非常强大是业界的标准用法而nosql查询以块为单元操作数据使用的是非结构化查询语言unql它是没有标准的关系型数据库表中主键的概念对应nosql中存储文档的id关系型数据库使用预定义优化方式比如索引来加快查询操作而nosql更简单更精确的数据访问模式">　　关系型数据库通过结构化查询语言来操作数据库（就是我们通常说的SQL）。SQL支持数据库CURD操作的功能非常强大，是业界的标准用法。而Nosql查询以块为单元操作数据，使用的是非结构化查询语言（UnQl），它是没有标准的。关系型数据库表中主键的概念对应Nosql中存储文档的ID。关系型数据库使用预定义优化方式（比如索引）来加快查询操作，而Nosql更简单更精确的数据访问模式。</h4>
<p>&nbsp;</p>
<h3 id="事务">6.事务</h3>
<h4 id="关系型数据库遵循acid规则原子性atomicity一致性consistency隔离性isolation持久性durability而nosql数据库遵循base原则基本可用basically-availble软柔性事务soft-state-最终一致性eventual-consistency由于关系型数据库的数据强一致性所以对事务的支持很好关系型数据库支持对事务原子性细粒度控制并且易于回滚事务而nosql数据库是在cap一致性可用性分区容忍度中任选两项因为基于节点的分布式系统中很难全部满足所以对事务的支持不是很好虽然也可以使用事务但是并不是nosql的闪光点">　　关系型数据库遵循ACID规则（原子性(Atomicity)、一致性(Consistency)、隔离性(Isolation)、持久性(Durability)），而Nosql数据库遵循BASE原则（基本可用（Basically Availble）、软/柔性事务（Soft-state ）、最终一致性（Eventual Consistency））。由于关系型数据库的数据强一致性，所以对事务的支持很好。关系型数据库支持对事务原子性细粒度控制，并且易于回滚事务。而Nosql数据库是在CAP（一致性、可用性、分区容忍度）中任选两项，因为基于节点的分布式系统中，很难全部满足，所以对事务的支持不是很好，虽然也可以使用事务，但是并不是Nosql的闪光点。</h4>
<p>&nbsp;</p>
<h3 id="性能">7.性能</h3>
<h4 id="关系型数据库为了维护数据的一致性付出了巨大的代价读写性能比较差在面对高并发读写性能非常差面对海量数据的时候效率非常低而nosql存储的格式都是key-value类型的并且存储在内存中非常容易存储而且对于数据的-一致性是-弱要求nosql无需sql的解析提高了读写性能">　　关系型数据库为了维护数据的一致性付出了巨大的代价，读写性能比较差。在面对高并发读写性能非常差，面对海量数据的时候效率非常低。而Nosql存储的格式都是key-value类型的，并且存储在内存中，非常容易存储，而且对于数据的 一致性是 弱要求。Nosql无需sql的解析，提高了读写性能。</h4>
<p>&nbsp;</p>
<h3 id="授权方式">8.授权方式</h3>
<h4 id="关系型数据库通常有sql-servermysqloracle主流的nosql数据库有redismemcachemongodb大多数的关系型数据库都是付费的并且价格昂贵成本较大而nosql数据库通常都是开源的">　　关系型数据库通常有SQL Server，Mysql，Oracle。主流的Nosql数据库有redis，memcache，MongoDb。大多数的关系型数据库都是付费的并且价格昂贵，成本较大，而Nosql数据库通常都是开源的。</h4>
<p>&nbsp;</p>
<h1 id="redismemcachemongodb的特点与区别"><span id="item3">Redis，Memcache，MongoDb的特点与区别</span></h1>
<p>&nbsp;</p>
<h2 id="redis">Redis</h2>
<h3 id="优点">优点</h3>
<h4 id="支持多种数据结构如-string字符串-list双向链表dicthash表set集合zset排序sethyperloglog基数估算-2.支持持久化操作可以进行aof及rdb数据持久化到磁盘从而进行数据备份或数据恢复等操作较好的防止数据丢失的手段-3.支持通过replication进行数据复制通过master-slave机制可以实时进行数据的同步复制支持多级复制和增量复制master-slave机制是redis进行ha的重要手段-4.单线程请求所有命令串行执行并发情况下不需要考虑数据一致性问题-5.支持pubsub消息订阅机制可以用来进行消息订阅与通知-6.支持简单的事务需求但业界使用场景很少并不成熟">1.支持多种数据结构，如 string（字符串）、 list(双向链表)、dict(hash表)、set(集合）、zset(排序set)、hyperloglog（基数估算）<br />2.支持持久化操作，可以进行aof及rdb数据持久化到磁盘，从而进行数据备份或数据恢复等操作，较好的防止数据丢失　　的手段。<br />3.支持通过Replication进行数据复制，通过master-slave机制，可以实时进行数据的同步复制，支持多级复制和增量复制，master-slave机制是Redis进行HA的重要手段。<br />4.单线程请求，所有命令串行执行，并发情况下不需要考虑数据一致性问题。<br />5.支持pub/sub消息订阅机制，可以用来进行消息订阅与通知。<br />6.支持简单的事务需求，但业界使用场景很少，并不成熟。</h4>
<h3 id="缺点">缺点</h3>
<h4 id="redis只能使用单线程性能受限于cpu性能故单实例cpu最高才可能达到5-6wqps每秒取决于数据结构数据大小以及服务器硬件性能日常环境中qps高峰大约在1-2w左右-2.支持简单的事务需求但业界使用场景很少并不成熟既是优点也是缺点-3.redis在string类型上会消耗较多内存可以使用dicthash表压缩存储以降低内存耗用">1.Redis只能使用单线程，性能受限于CPU性能，故单实例CPU最高才可能达到5-6wQPS每秒（取决于数据结构，数据大小以及服务器硬件性能，日常环境中QPS高峰大约在1-2w左右）。<br />2.支持简单的事务需求，但业界使用场景很少，并不成熟，既是优点也是缺点。<br />3.Redis在string类型上会消耗较多内存，可以使用dict（hash表）压缩存储以降低内存耗用。</h4>
<p>&nbsp;</p>
<h2 id="memcache">Memcache</h2>
<h3 id="优点-1">优点</h3>
<h4 id="memcached可以利用多核优势单实例吞吐量极高可以达到几十万qps取决于keyvalue的字节大小以及服务器硬件性能日常环境中qps高峰大约在4-6w左右适用于最大程度扛量-2.支持直接配置为session-handle">1.Memcached可以利用多核优势，单实例吞吐量极高，可以达到几十万QPS（取决于key、value的字节大小以及服务器硬件性能，日常环境中QPS高峰大约在4-6w左右）。适用于最大程度扛量。<br />2.支持直接配置为session handle。</h4>
<h3 id="缺点-1">缺点</h3>
<h4 id="只支持简单的keyvalue数据结构不像redis可以支持丰富的数据类型-2.无法进行持久化数据不能备份只能用于缓存使用且重启后数据全部丢失-3.无法进行数据同步不能将mc中的数据迁移到其他mc实例中-4.memcached内存分配采用slab-allocation机制管理内存value大小分布差异较大时会造成内存利用率降低并引发低利用率时依然出现踢出等问题需要用户注重value设计">1只支持简单的key/value数据结构，不像Redis可以支持丰富的数据类型。<br />2.无法进行持久化，数据不能备份，只能用于缓存使用，且重启后数据全部丢失。<br />3.无法进行数据同步，不能将MC中的数据迁移到其他MC实例中。<br />4.Memcached内存分配采用Slab Allocation机制管理内存，value大小分布差异较大时会造成内存利用率降低，并引发低利用率时依然出现踢出等问题。需要用户注重value设计。</h4>
<p>&nbsp;</p>
<h2 id="mongodb">MongoDB</h2>
<h3 id="优点-2">优点</h3>
<h4 id="更高的写负载mongodb拥有更高的插入速度-2.处理很大的规模的单表当数据表太大的时候可以很容易的分割表-3.高可用性设置m-s不仅方便而且很快mongodb还可以快速安全及自动化的实现节点数据中心故障转移-4.快速的查询mongodb支持二维空间索引比如管道因此可以快速及精确的从指定位置获取数据mongodb在启动后会将数据库中的数据以文件映射的方式加载到内存中如果内存资源相当丰富的话这将极大地提高数据库的查询速度-5.非结构化数据的爆发增长增加列在有些情况下可能锁定整个数据库或者增加负载从而导致性能下降由于mongodb的弱数据结构模式添加1个新字段不会对旧表格有任何影响整个过程会非常快速">1.更高的写负载，MongoDB拥有更高的插入速度。<br />2.处理很大的规模的单表，当数据表太大的时候可以很容易的分割表。<br />3.高可用性，设置M-S不仅方便而且很快，MongoDB还可以快速、安全及自动化的实现节点（数据中心）故障转移。<br />4.快速的查询，MongoDB支持二维空间索引，比如管道，因此可以快速及精确的从指定位置获取数据。MongoDB在启动后会将数据库中的数据以文件映射的方式加载到内存中。如果内存资源相当丰富的话，这将极大地提高数据库的查询速度。<br />5.非结构化数据的爆发增长，增加列在有些情况下可能锁定整个数据库，或者增加负载从而导致性能下降，由于MongoDB的弱数据结构模式，添加1个新字段不会对旧表格有任何影响，整个过程会非常快速。</h4>
<h3 id="缺点-2">缺点</h3>
<h4 id="不支持事务-2.mongodb占用空间过大-3.mongodb没有成熟的维护工具">1.不支持事务。<br />2.MongoDB占用空间过大 。<br />3.MongoDB没有成熟的维护工具。</h4>
<p>&nbsp;</p>
<h2 id="redismemcache和mongodb的区别">Redis、Memcache和MongoDB的区别</h2>
<h3 id="性能-1">1.性能</h3>
<h4 id="三者的性能都比较高总的来讲memcache和redis差不多要高于mongodb">三者的性能都比较高，总的来讲：Memcache和Redis差不多，要高于MongoDB。</h4>
<h3 id="便利性">2.便利性</h3>
<h4 id="memcache数据结构单一-redis丰富一些数据操作方面redis更好一些较少的网络io次数-mongodb支持丰富的数据表达索引最类似关系型数据库支持的查询语言非常丰富">memcache数据结构单一。<br />redis丰富一些，数据操作方面，redis更好一些，较少的网络IO次数。<br />mongodb支持丰富的数据表达，索引，最类似关系型数据库，支持的查询语言非常丰富。</h4>
<h3 id="存储空间">3,存储空间</h3>
<h4 id="redis在2.0版本后增加了自己的vm特性突破物理内存的限制可以对key-value设置过期时间类似memcache-memcache可以修改最大可用内存采用lru算法-mongodb适合大数据量的存储依赖操作系统vm做内存管理吃内存也比较厉害服务不要和别的服务在一起">redis在2.0版本后增加了自己的VM特性，突破物理内存的限制；可以对key value设置过期时间（类似memcache）。<br />memcache可以修改最大可用内存,采用LRU算法。<br />mongoDB适合大数据量的存储，依赖操作系统VM做内存管理，吃内存也比较厉害，服务不要和别的服务在一起。</h4>
<h3 id="可用性">4.可用性</h3>
<h4 id="redis依赖客户端来实现分布式读写主从复制时每次从节点重新连接主节点都要依赖整个快照无增量复制因性能和效率问题所以单点问题比较复杂不支持自动sharding需要依赖程序设定一致hash-机制一种替代方案是不用redis本身的复制机制采用自己做主动复制多份存储或者改成增量复制的方式需要自己实现一致性问题和性能的权衡-memcache本身没有数据冗余机制也没必要对于故障预防采用依赖成熟的hash或者环状的算法解决单点故障引起的抖动问题-mongodb支持master-slavereplicaset内部采用paxos选举算法自动故障恢复auto-sharding机制对客户端屏蔽了故障转移和切分机制">redis，依赖客户端来实现分布式读写；主从复制时，每次从节点重新连接主节点都要依赖整个快照,无增量复制，因性能和效率问题，所以单点问题比较复杂；不支持自动sharding,需要依赖程序设定一致hash 机制。一种替代方案是，不用redis本身的复制机制，采用自己做主动复制（多份存储），或者改成增量复制的方式（需要自己实现），一致性问题和性能的权衡。<br />Memcache本身没有数据冗余机制，也没必要；对于故障预防，采用依赖成熟的hash或者环状的算法，解决单点故障引起的抖动问题。<br />mongoDB支持master-slave,replicaset（内部采用paxos选举算法，自动故障恢复）,auto sharding机制，对客户端屏蔽了故障转移和切分机制。</h4>
<h3 id="可靠性">5.可靠性</h3>
<h4 id="redis支持快照aof依赖快照进行持久化aof增强了可靠性的同时对性能有所影响-memcache不支持通常用在做缓存提升性能-mongodb从1.8版本开始采用binlog方式支持持久化的可靠性">redis支持（快照、AOF）：依赖快照进行持久化，aof增强了可靠性的同时，对性能有所影响。<br />memcache不支持，通常用在做缓存,提升性能。<br />MongoDB从1.8版本开始采用binlog方式支持持久化的可靠性。</h4>
<h3 id="一致性">6.一致性</h3>
<h4 id="memcache-在并发场景下用cas保证一致性-redis事务支持比较弱只能保证事务中的每个操作连续执行-mongodb不支持事务">Memcache 在并发场景下，用cas保证一致性。<br />redis事务支持比较弱，只能保证事务中的每个操作连续执行。<br />mongoDB不支持事务。</h4>
<h3 id="数据分析">7.数据分析</h3>
<h4 id="mongodb内置了数据分析的功能mapreduce其他两者不支持">mongoDB内置了数据分析的功能(mapreduce),其他两者不支持。</h4>
<h3 id="应用场景">8.应用场景</h3>
<h4 id="redis数据量较小的更性能操作和运算上-memcache用于在动态系统中减少数据库负载提升性能做缓存提高性能适合读多写少对于数据量比较大可以采用sharding-mongodb主要解决海量数据的访问效率问题">redis：数据量较小的更性能操作和运算上。<br />memcache：用于在动态系统中减少数据库负载，提升性能;做缓存，提高性能（适合读多写少，对于数据量比较大，可以采用sharding）。<br /><a class="uri">MongoDB:主要解决海量数据的访问效率问题。####</a></h4>
![](https://img2018.cnblogs.com/blog/1504647/201811/1504647-20181122145022742-1935434355.png)

[在线演示](https://www.jqhtml.com/yanshi?demourl=wp-content/uploads/2016/12/tx/tx20161201/&demotitle=3d%E6%97%8B%E8%BD%AC%E7%84%A6%E7%82%B9%E5%9B%BE)  [本地下载](https://www.jqhtml.com/538.html)
<h1>C++基本数据类型：</h1>
<p>&nbsp; &nbsp;在使用程序实现算法的过程中，需要各种类型的数据，如：计算圆的半径、周长、面积，描述&nbsp;物体运动过程中的速度、时间、距离，购物时的数量、单价和总价等。</p>
<p>&nbsp; &nbsp; &nbsp;C++语言中，基本的数据类型有：</p>
<ul>
<li>整型：int&nbsp; &nbsp; &nbsp;包括正整数，副整数，以及0。</li>
<li>实数float，double&nbsp; 带小数点的数</li>
<li>布尔型：bool&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 真假，实际上也是整型，0为假，非0为真</li>
<li>字符型：char&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 字符型，大小写字母，数字，标点符号，加减乘除等符号</li>
</ul>
<p>每种数据类型，都有一定的长度，可以用sizeof求出每种数据类型的长度，sizeof函数求出的数据类型长度，单位是字节。</p>
<div class="cnblogs_code">
<pre><span style="color: #008080;"> 1</span> #include &lt;iostream&gt;
<span style="color: #008080;"> 2</span> <span style="color: #0000ff;">using</span> <span style="color: #0000ff;">namespace</span><span style="color: #000000;"> std;
</span><span style="color: #008080;"> 3</span> <span style="color: #0000ff;">int</span><span style="color: #000000;"> main()
</span><span style="color: #008080;"> 4</span> <span style="color: #000000;">{
</span><span style="color: #008080;"> 5</span>    cout&lt;&lt;<span style="color: #0000ff;">sizeof</span>(<span style="color: #0000ff;">int</span>)&lt;&lt;<span style="color: #000000;">endl;
</span><span style="color: #008080;"> 6</span>    cout&lt;&lt;<span style="color: #0000ff;">sizeof</span>(<span style="color: #0000ff;">float</span>)&lt;&lt;<span style="color: #000000;">endl;
</span><span style="color: #008080;"> 7</span>    cout&lt;&lt;<span style="color: #0000ff;">sizeof</span>(<span style="color: #0000ff;">double</span>)&lt;&lt;<span style="color: #000000;">endl;
</span><span style="color: #008080;"> 8</span>    cout&lt;&lt;<span style="color: #0000ff;">sizeof</span>(<span style="color: #0000ff;">bool</span>)&lt;&lt;<span style="color: #000000;">endl;
</span><span style="color: #008080;"> 9</span>    cout&lt;&lt;<span style="color: #0000ff;">sizeof</span>(<span style="color: #0000ff;">char</span>)&lt;&lt;<span style="color: #000000;">endl;
</span><span style="color: #008080;">10</span>    <span style="color: #0000ff;">return</span> <span style="color: #800080;">0</span><span style="color: #000000;">;
</span><span style="color: #008080;">11</span> }</pre>
</div>
<p>初学时，只需要先大概明白各种数据类型长度不同，取值范围不同即可。</p>
<h1>常量、变量及定义：&nbsp;</h1>
<p>&nbsp; &nbsp; 常量：在程序中值保持不变的，就是常量。</p>
<p>&nbsp; &nbsp; &nbsp;变量：在程序中，值会改变的，就是变量。</p>
<p>&nbsp; &nbsp; &nbsp;定义：</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;const&nbsp; 数据类型&nbsp; &nbsp;常量名=值&nbsp; &nbsp; &nbsp;如可以将3.14定义成PI，&nbsp; const float PI =3.14</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 数据类型&nbsp; &nbsp;变量名&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 如double S,L;&nbsp; 定义圆的周长和面积。double S,L;</p>
<p>&nbsp; &nbsp; 区别：定义常量，必须给常量赋值，变量可以不赋值。</p>
<p>&nbsp; &nbsp; &nbsp;常量和变量名称命名规则：</p>
<ul>
<li>&nbsp;必须以字母、下划线开头 &nbsp;</li>
<li>&nbsp;变量名中，必须是字母，数字、下划线构成，</li>
<li>&nbsp;区分大小写 &nbsp; &nbsp; 如ABC和abc是不同的 &nbsp;</li>
<li>&nbsp;不能使用C++中的保留字</li>
<li>变量名尽量含有意义</li>
</ul>
<p><em id="__mceDel">&nbsp; 程序中使用常量和变量时，遵循先定义后使用的原则<br /><br /></em></p>
-------------------------------------
水题:
```
 给定字符串J 代表石头中宝石的类型，和字符串 S代表你拥有的石头。 S 中每个字符代表了一种你拥有的石头的类型，你想知道你拥有的石头中有多少是宝石。

J 中的字母不重复，J 和 S中的所有字符都是字母。字母区分大小写，因此"a"和"A"是不同类型的石头。

示例 1:

输入: J = "aA", S = "aAAbbbb"
输出: 3
示例 2:

输入: J = "z", S = "ZZ"
输出: 0
注意:

S 和 J 最多含有50个字母。
 J 中的字符不重复。
```


```python
class Solution(object):
    def numJewelsInStones(self, J, S):
        """
        :type J: str
        :type S: str
        :rtype: int
        """
        baoshi_dict = {}
        for j in J:
            if j not in baoshi_dict:
                baoshi_dict[j]=1
        count = 0
        for i in range(len(S)):
            if S[i] in baoshi_dict:
                count += 1
        return count
```
<p>在HTML中，表单是由&lt;form&gt;来表示的。取得&lt;form&gt;元素引用的方式有好几种，最常见的就是为其添加id特性，然后使用getElementById()方法获取它。其次，是通过document.forms可以取得页面中所有的表单。在这个集合中，可以通过数值索引或name值来取得特定的表单。</p>
<h2>提交表单</h2>
<p>用户单击提交按钮或图像按钮时，就会提交表单。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">&lt;!-- 通用提交按钮 --&gt;
&lt;input type="submit" value="Submit Form"&gt;
&lt;!-- 自定义提交按钮 --&gt;
&lt;button type="submit"&gt;Submit Form&lt;/button&gt;
&lt;!-- 图像按钮 --&gt;
&lt;input type="image" src="graphic.gif"&gt;
</pre>
</div>
<p>　以这种方式提交表单时，浏览器会在将请求发送给服务器之前触发submit事件。这样，就有机会验证表单数据，并决定是否允许表单提交。阻止这个事件的默认行为就可以取消表单提交。 （调用preventnDefault()方法可以阻止表单提交）</p>
<p>在JS中，调用submit()方法也可以提交表单。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var form = document.getElementById("myForm");
//提交表单
form.submit();
</pre>
</div>
<p>　在以调用submit()方法的形式提交表单时，不会触发submit 事件，因此要记得在调用此方法之前先验证表单数据。</p>
<p>提交表单时可能出现的最大问题，就是重复提交表单。解决这一问题的办法有两个：在第一次提交表单后就禁用提交按钮，或者利用onsubmit 事件处理程序取消后续的表单提交操作。</p>
<h2>重置表单</h2>
<p>当用户单击重置按钮时，表单会被重置。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">&lt;!-- 通用重置按钮 --&gt;
&lt;input type="reset" value="Reset Form"&gt;
&lt;!-- 自定义重置按钮 --&gt;
&lt;button type="reset"&gt;Reset Form&lt;/button&gt;
</pre>
</div>
<p>　在重置表单时，所有表单字段都会恢复到页面刚加载完毕时的初始值。用户单击重置按钮重置表单时，会触发reset 事件。</p>
<p>在JS中，调用reset()方法也可以重置表单。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var form = document.getElementById("myForm");
//重置表单
form.reset();
</pre>
</div>
<p>　与调用submit()方法不同，调用reset()方法会像单击重置按钮一样触发reset 事件。</p>
<h2>表单字段</h2>
<h3>共有的表单字段属性：</h3>
<p> disabled：布尔值，表示当前字段是否被禁用。<br /> form：指向当前字段所属表单的指针；只读。<br /> name：当前字段的名称。<br /> readOnly：布尔值，表示当前字段是否只读。<br /> tabIndex：表示当前字段的切换（tab）序号。<br /> type：当前字段的类型，如"checkbox"、"radio"，等等。<br /> value：当前字段将被提交给服务器的值。对文件字段来说，这个属性是只读的，包含着文件在计算机中的路径。</p>
<h3>共有的表单字段方法：</h3>
<p>每个表单字段都有两个方法：focus()和 blur()。</p>
<h3>共有的表单字段事件：</h3>
<p>除了支持鼠标、键盘、更改和HTML 事件之外，所有表单字段都支持下列3 个事件：<br /> blur：当前字段失去焦点时触发。<br /> change：对于&lt;input&gt;和&lt;textarea&gt;元素，在它们失去焦点且value 值改变时触发；对于&lt;select&gt;元素，在其选项改变时触发。<br /> focus：当前字段获得焦点时触发。</p>
<p>change 事件在不同表单控件中触发的次数会有所不同。对于&lt;input&gt;和&lt;textarea&gt;元素，当它们从获得焦点到失去焦点且value 值改变时，才会触发change 事件。对于&lt;select&gt;元素，只要用户选择了不同的选项，就会触发change 事件；换句话说，不失去焦点也会触发change 事件。</p>
<p>注意：关于blur 和change 事件的关系，并没有严格的规定。在某些浏览器中，blur事件会先于change 事件发生；而在其他浏览器中，则恰好相反。</p>
<h2>文本框脚本</h2>
<p>在HTML 中，有两种方式来表现文本框：一种是使用&lt;input&gt;元素的单行文本框，另一种是使用&lt;textarea&gt;的多行文本框。</p>
<h3>选择文本</h3>
<p>上述两种文本框都支持select()方法，这个方法用于选择文本框中的所有文本。（在文本框获得焦点时选择其所有文本）</p>
<h3>取得选择的文本</h3>
<p>HTML5添加了两个属性：selectionStart和seletionEnd。这两个属相中保存的是基于0的数值，表示所选择的的文本范围。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">function getSelectedText(textbox){
return textbox.value.substring(textbox.selectionStart, textbox.selectionEnd);
}
</pre>
</div>
<p>　</p>
<p>IE8 及更早的版本中有一个document.selection 对象，其中保存着用户在整个文档范围内选择的文本信息。要取得选择的文本，首先必须创建一个范围，然后再将文本从其中提取出来。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">function getSelectedText(textbox){
if (typeof textbox.selectionStart == "number"){
return textbox.value.substring(textbox.selectionStart,
textbox.selectionEnd);
} else if (document.selection){
return document.selection.createRange().text;
}
}
</pre>
</div>
<h3>选择部分文本</h3>
<p>HTML5添加了setSelectionRange()方法。这个方法接收两个参数：要选择的第一个字符的索引和要选择的最后一个字符之后的字符的索引。</p>
<h2>HTML5约束验证API</h2>
<p>为了在将表单提交到服务器之前验证数据，HTML5 新增了一些功能。</p>
<h3>1.必填字段</h3>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">&lt;input type="text" name="username" required&gt;
</pre>
</div>
<h3>2.其他输入类型</h3>
<p>HTML5 为&lt;input&gt;元素的type 属性又增加了几个值。这些新的类型不仅能反映数据类型的信息，而且还能提供一些默认的验证功能。其中，"email"和"url"是两个得到支持最多的类型。</p>
<p>"email"类型要求输入的文本必须符合电子邮件地址的模式，而"url"类型要求输入的文本必须符合URL 的模式。</p>
<h3>3.数值范围</h3>
<p>除了"email"和"url"，HTML5 还定义了另外几个输入元素。这几个元素都要求填写某种基于数字的值："number"、"range"、"datetime"、"datetime-local"、"date"、"month"、"week"，还有"time"。</p>
<p>对所有这些数值类型的输入元素，可以指定min 属性（最小的可能值）、max 属性（最大的可能值）和step 属性（从min 到max 的两个刻度间的差值）。</p>
<h3>4.输入模式</h3>
<p>HTML5 为文本字段新增了pattern 属性。这个属性的值是一个正则表达式，用于匹配文本框中的值。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">&lt;input type="text" pattern="\d+" name="count"&gt;
</pre>
</div>
<p>　注意，模式的开头和末尾不用加^和$符号。</p>
<h3>5.检测有效性</h3>
<p>使用checkValidity()方法可以检测表单中的某个字段是否有效。所有表单字段都有个方法，如果字段的值有效，这个方法返回true，否则返回false。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">if (document.forms[0].elements[0].checkValidity()){
//字段有效，继续
} else {
//字段无效
}　</pre>
</div>
<p>validity 属性则会告诉你为什么字段有效或无效。这个对象中包含一系列属性，每个属性会返回一个布尔值：</p>
<p> customError ：如果设置了setCustomValidity()，则为true，否则返回false。<br /> patternMismatch：如果值与指定的pattern 属性不匹配，返回true。<br /> rangeOverflow：如果值比max 值大，返回true。<br /> rangeUnderflow：如果值比min 值小，返回true。<br /> stepMisMatch：如果min 和max 之间的步长值不合理，返回true。<br /> tooLong：如果值的长度超过了maxlength 属性指定的长度，返回true。有的浏览器（如Firefox 4）会自动约束字符数量，因此这个值可能永远都返回false。<br /> typeMismatch：如果值不是"mail"或"url"要求的格式，返回true。<br /> valid：如果这里的其他属性都是false，返回true。checkValidity()也要求相同的值。<br /> valueMissing：如果标注为required 的字段中没有值，返回true。</p>
<h3>6.禁用验证</h3>
<p>通过设置novalidate 属性，可以告诉表单不进行验证。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">&lt;form method="post" action="signup.php" novalidate&gt;
&lt;!--这里插入表单元素--&gt;
&lt;/form&gt;
</pre>
</div>
<p>　</p>
<p>如果一个表单中有多个提交按钮，为了指定点击某个提交按钮不必验证表单，可以在相应的按钮上添加formnovalidate 属性。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">&lt;form method="post" action="foo.php"&gt;
&lt;!--这里插入表单元素--&gt;
&lt;input type="submit" value="Regular Submit"&gt;
&lt;input type="submit" formnovalidate name="btnNoValidate"
value="Non-validating Submit"&gt;
&lt;/form&gt;
</pre>
</div>
<h2>选择框脚本</h2>
<p>选择框是通过&lt;select&gt;和&lt;option&gt;元素创建的。</p>
<p>HTMLSelectElement 类型还提供了下列属性和方法：</p>
<p> add(newOption, relOption)：向控件中插入新&lt;option&gt;元素，其位置在相关项（relOption）之前。<br /> multiple：布尔值，表示是否允许多项选择；等价于HTML 中的multiple 特性。<br /> options：控件中所有&lt;option&gt;元素的HTMLCollection。<br /> remove(index)：移除给定位置的选项。<br /> selectedIndex：基于0 的选中项的索引，如果没有选中项，则值为-1。对于支持多选的控件，只保存选中项中第一项的索引。<br /> size：选择框中可见的行数；等价于HTML 中的size 特性。</p>
<p>HTMLOptionElement 对象添加了下列属性：</p>
<p> index：当前选项在options 集合中的索引。<br /> label：当前选项的标签；等价于HTML 中的label 特性。<br /> selected：布尔值，表示当前选项是否被选中。将这个属性设置为true 可以选中当前选项。<br /> text：选项的文本。<br /> value：选项的值（等价于HTML 中的value 特性）。</p>
<h3>选择选项</h3>
<p>对于只允许选择一项的选择框，访问选中项的最简单方式，就是使用选择框的selectedIndex 属性。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var selectedOption = selectbox.options[selectbox.selectedIndex];
</pre>
</div>
<p>另一种选择选项的方式，就是取得对某一项的引用，然后将其selected 属性设置为true。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">selectbox.options[0].selected = true;</pre>
</div>
<h3>添加选项</h3>
<p>添加选项的方式有很多，第一种方式就是使用如下所示的DOM 方法。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var newOption = document.createElement("option");
newOption.appendChild(document.createTextNode("Option text"));
newOption.setAttribute("value", "Option value");
selectbox.appendChild(newOption);
</pre>
</div>
<p>第二种方式是使用Option 构造函数来创建新选项。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var newOption = new Option("Option text", "Option value");
selectbox.appendChild(newOption); //在IE8 及之前版本中有问题</pre>
</div>
<p>第三种添加新选项的方式是使用选择框的add()方法。DOM 规定这个方法接受两个参数：要添加的新选项和将位于新选项之后的选项。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var newOption = new Option("Option text", "Option value");
selectbox.add(newOption, undefined); //最佳方案
</pre>
</div>
<h3>移除选项</h3>
<p>与添加选项类似，移除选项的方式也有很多种。首先，可以使用DOM 的removeChild()方法，为其传入要移除的选项。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">selectbox.removeChild(selectbox.options[0]); //移除第一个选项
</pre>
</div>
<p>其次，可以使用选择框的remove()方法。这个方法接受一个参数，即要移除选项的索引。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">selectbox.remove(0); //移除第一个选项
</pre>
</div>
<p>最后一种方式，就是将相应选项设置为null。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">selectbox.options[0] = null; //移除第一个选项　　</pre>
</div>
<h3>移动和重排选项</h3>
<p>使用DOM 的appendChild()方法，就可以将第一个选择框中的选项直接移动到第二个选择框中。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var selectbox1 = document.getElementById("selLocations1");
var selectbox2 = document.getElementById("selLocations2");
selectbox2.appendChild(selectbox1.options[0]);
</pre>
</div>
<p>移动选项与移除选项有一个共同之处，即会重置每一个选项的index 属性。</p>
<p>要将选择框中的某一项移动到特定位置，最合适的DOM 方法就是insertBefore()。</p>
<div class="cnblogs_Highlighter">
<pre class="brush:javascript;gutter:true;">var optionToMove = selectbox.options[1];
selectbox.insertBefore(optionToMove, selectbox.options[optionToMove.index-1]);  //在选择框中向前移动一个选项的位置
</pre>
</div>
<h2>表单序列化</h2>
<p>将表单内容序列化成一个字符串。这样在ajax提交表单数据时，就不用依一列举出每一个参数。</p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;">js中定时器有两种，一个是循环执行<strong>setInterval</strong>，另一个是定时执行<strong>setTimeout</strong></span></p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;"><strong><strong>一、循环执行（</strong></strong><strong><strong>setInterval）</strong></strong></span></p>
<p><span style="font-size: 14pt;">&nbsp;</span></p>
<p><span style="font-size: 14pt;">顾名思义，循环执行就是设置一个时间间隔，每过一段时间都会执行一次这个方法,直到这个定时器被销毁掉</span></p>
<p><span style="font-size: 14pt;">用法是<strong>setInterval</strong>（&ldquo;方法名或方法&rdquo;，&ldquo;延时&rdquo;）， 第一个参数为方法名或者方法，<span style="color: #ff0000;">注意为方法名的时候不要加括号</span>,第二个参数为时间间隔</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 14pt;"><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">section</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">h1</span><span style="color: #0000ff;">&gt;</span>hello world~<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">h1</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">section</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
  export </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;"> {
    data() {
      </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> {
        timer: </span><span style="background-color: #f5f5f5; color: #000000;">''</span><span style="background-color: #f5f5f5; color: #000000;">,
        value: </span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">
      };
    },
    methods: {
      get() {
        </span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.value </span><span style="background-color: #f5f5f5; color: #000000;">++</span><span style="background-color: #f5f5f5; color: #000000;">;
        console.log(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.value);
      }
    },
    mounted() {
      </span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.timer </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> setInterval(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.get, </span><span style="background-color: #f5f5f5; color: #000000;">1000</span><span style="background-color: #f5f5f5; color: #000000;">);
    },
    beforeDestroy() {
      clearInterval(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.timer);
    }
  };
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></span></pre>
</div>
<p><span style="font-size: 14pt;">&nbsp;</span></p>
<p><span style="font-size: 14pt;">&nbsp;</span></p>
<p><span style="font-size: 14pt;"><strong><strong><img src="https://img2018.cnblogs.com/blog/1312098/201811/1312098-20181122150340411-1158823513.png" alt="" /></strong></strong></span></p>
<p><span style="font-size: 14pt;">上面的例子就是页面初始化的时候创建了一个定时器<strong><strong>setInterval</strong></strong>，时间间隔为1秒，每一秒都会调用一次函数get，从而使value的值加一。</span></p>
<p><span style="font-size: 14pt;">&nbsp;</span></p>
<p><span style="font-size: 14pt;">&nbsp;</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;"><strong><strong><strong>二、定时执行 （setTimeout）</strong></strong></strong></span></p>
<p><span style="font-size: 14pt;">&nbsp;</span></p>
<p><span style="font-size: 14pt;">定时执行<strong><strong><strong>setTimeout</strong></strong></strong>是设置一个时间，等待时间到达的时候只执行一次，但是执行完以后定时器还在，只是没有运行</span></p>
<p><span style="font-size: 14pt;">用法是<strong>setTimeout</strong>(&ldquo;方法名或方法&rdquo;, &ldquo;延时&rdquo;);&nbsp;第一个参数为方法名或者方法，<span style="color: #ff0000;">注意为方法名的时候不要加括号</span>,第二个参数为时间间隔</span></p>
<div class="cnblogs_code">
<pre><span style="font-size: 14pt;"><span style="color: #0000ff;">&lt;</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">section</span><span style="color: #0000ff;">&gt;</span>
    <span style="color: #0000ff;">&lt;</span><span style="color: #800000;">h1</span><span style="color: #0000ff;">&gt;</span>hello world~<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">h1</span><span style="color: #0000ff;">&gt;</span>
  <span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">section</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">template</span><span style="color: #0000ff;">&gt;</span>
<span style="color: #0000ff;">&lt;</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span><span style="background-color: #f5f5f5; color: #000000;">
  export </span><span style="background-color: #f5f5f5; color: #0000ff;">default</span><span style="background-color: #f5f5f5; color: #000000;"> {
    data() {
      </span><span style="background-color: #f5f5f5; color: #0000ff;">return</span><span style="background-color: #f5f5f5; color: #000000;"> {
        timer: </span><span style="background-color: #f5f5f5; color: #000000;">''</span><span style="background-color: #f5f5f5; color: #000000;">,
        value: </span><span style="background-color: #f5f5f5; color: #000000;">0</span><span style="background-color: #f5f5f5; color: #000000;">
      };
    },
    methods: {
      get() {
        </span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.value </span><span style="background-color: #f5f5f5; color: #000000;">++</span><span style="background-color: #f5f5f5; color: #000000;">;
        console.log(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.value);
      }
    },
    mounted() {
      </span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.timer </span><span style="background-color: #f5f5f5; color: #000000;">=</span><span style="background-color: #f5f5f5; color: #000000;"> setTimeout(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.get, </span><span style="background-color: #f5f5f5; color: #000000;">1000</span><span style="background-color: #f5f5f5; color: #000000;">);
    },
    beforeDestroy() {
      clearTimeout(</span><span style="background-color: #f5f5f5; color: #0000ff;">this</span><span style="background-color: #f5f5f5; color: #000000;">.timer);
    }
  };
</span><span style="color: #0000ff;">&lt;/</span><span style="color: #800000;">script</span><span style="color: #0000ff;">&gt;</span></span></pre>
</div>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;"><img src="https://img2018.cnblogs.com/blog/1312098/201811/1312098-20181122151350362-660152730.png" alt="" /></span></p>
<p><span style="font-size: 14pt;">上面是页面初始化时候创建一个定时器<strong>setTimeout</strong>，只在1秒后执行一次方法。</span></p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p><span style="color: #ff0000; font-size: 14pt;">定时器需要在页面销毁的时候清除掉，不然会一直存在！！！</span></p>
<p>&nbsp;</p>
<p><span style="font-size: 14pt;">&nbsp;</span></p>
<p><span style="font-size: 14pt;">嗯,就酱~~</span></p>
<p>&nbsp;</p>
<p><img src="https://img2018.cnblogs.com/blog/1450924/201811/1450924-20181122151922445-1239852398.png" alt="" /><img src="https://img2018.cnblogs.com/blog/1450924/201811/1450924-20181122151713065-1649575520.png" alt="" /><img src="https://img2018.cnblogs.com/blog/1450924/201811/1450924-20181122151721142-1779443212.png" alt="" /></p>
<p>dayofweek在hive2.2.0开始支持 ，低版本的hive没有提供原生的dayofweek函数，有时需要用到的时候不甚方便。<br />其实低版本的sparksql和hive中可用以下方式实现dayofweek功能<br /><br /></p>
<div class="cnblogs_Highlighter">
<pre class="brush:sql;gutter:false;">select 7- datediff(next_day('2018-03-12',"Sunday"),'2018-03-12').  
select date_format('2018-03-12' ,'u').   
select date_format(from_unixtime(unix_timestamp('20180313','yyyyMMdd'),'yyyy-MM-dd'),'u')
</pre>
</div>
<p><br />参考 ：</p>
<p><a href="https://cwiki.apache.org/confluence/display/Hive/LanguageManual+UDF" rel="nofollow" target="_blank">Hive UDF</a><span class="Apple-converted-space">&nbsp;<br /><a href="https://spark.apache.org/docs/2.0.2/api/java/org/apache/spark/sql/functions.html" rel="nofollow" target="_blank">sparksql function</a></span></p>
<div class="cnblogs_code">
<pre><span style="color: #000000;">function initGrid() {
        localGrid </span>= jQuery(<span style="color: #800000;">"</span><span style="color: #800000;">#tbList</span><span style="color: #800000;">"</span><span style="color: #000000;">);
        localGrid.jqGrid({
            data: localData,
            datatype: </span><span style="color: #800000;">"</span><span style="color: #800000;">local</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            gridview: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            height: </span><span style="color: #800080;">300</span><span style="color: #000000;">,
            width: </span><span style="color: #800000;">'</span><span style="color: #800000;">90%</span><span style="color: #800000;">',</span><span style="color: #000000;">
            rowList: [</span><span style="color: #800080;">5</span>,<span style="color: #800080;">10</span><span style="color: #000000;">],
            colNames: innerColumns,
            autowidth: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            hoverrows: </span><span style="color: #0000ff;">false</span><span style="color: #000000;">,
            multiselect: </span><span style="color: #0000ff;">false</span><span style="color: #000000;">,
            colModel: [
             { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">Id</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">Id</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">100</span>, hidden: <span style="color: #0000ff;">true</span><span style="color: #000000;"> },
             { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">Status</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">Status</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">100</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">GroupName</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">GroupName</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">200</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">LetterNumber</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">LetterNumber</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">ApplyUnitName</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">ApplyUnitName</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">StayDays</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">StayDays</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> },
            { name: </span><span style="color: #800000;">'</span><span style="color: #800000;">LeaderName</span><span style="color: #800000;">'</span>, index: <span style="color: #800000;">'</span><span style="color: #800000;">LeaderName</span><span style="color: #800000;">'</span>, width: <span style="color: #800080;">80</span>, align: <span style="color: #800000;">"</span><span style="color: #800000;">center</span><span style="color: #800000;">"</span><span style="color: #000000;"> }
            
            ],
            emptyrecords: </span><span style="color: #800000;">"</span><span style="color: #800000;">没有任何数据</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            pager: </span><span style="color: #800000;">"</span><span style="color: #800000;">#pager</span><span style="color: #800000;">"</span><span style="color: #000000;">,
            viewrecords: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            rownumbers: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            loadonce: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            grouping: </span><span style="color: #0000ff;">true</span><span style="color: #000000;">,
            rowNum:</span><span style="color: #800080;">5</span><span style="color: #000000;">,
            groupingView : {  
                groupField: [</span><span style="color: #800000;">'</span><span style="color: #800000;">Status</span><span style="color: #800000;">'</span><span style="color: #000000;">]
            },
            ondblClickRow: function (id) {
                </span><span style="color: #008000;">//</span><span style="color: #008000;">editInfo(id);</span>
<span style="color: #000000;">            },
            caption: </span><span style="color: #800000;">"</span><span style="color: #800000;">团组信息</span><span style="color: #800000;">"</span><span style="color: #000000;">
            
        }).navGrid(</span><span style="color: #800000;">'</span><span style="color: #800000;">#pager</span><span style="color: #800000;">'</span>, { edit: <span style="color: #0000ff;">false</span>, add: <span style="color: #0000ff;">false</span>, del: <span style="color: #0000ff;">false</span>, searchtext: <span style="color: #800000;">"</span><span style="color: #800000;">搜索</span><span style="color: #800000;">"</span> }, {}, {}, {}, { search: <span style="color: #0000ff;">true</span>, sopt: [<span style="color: #800000;">'</span><span style="color: #800000;">cn</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">eq</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">ge</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">gt</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">le</span><span style="color: #800000;">'</span>, <span style="color: #800000;">'</span><span style="color: #800000;">lt</span><span style="color: #800000;">'</span><span style="color: #000000;">] });

    }</span></pre>
</div>
<p>&nbsp; 加载时只显示5条数据，&nbsp;就是通过 rowNum:5 这一属性实现的，当然此时你最好也将 rowList 的最少值设为 5&nbsp;&nbsp; 我这里是rowList :[5,10]</p>
